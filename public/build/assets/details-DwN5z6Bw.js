import{r as m,u as R,a as u,j as e}from"./app-BYek28t3.js";import{B as l}from"./button-CFU6UcKA.js";import"./input-B0M3oF_m.js";import{C as i,a as d,b as n,c as a,e as S}from"./card-DC3m0m2Q.js";import{B as x}from"./badge-zbI-jXEX.js";import"./select-C5_NUKah.js";import"./moment-C5S46NFB.js";import{T as B,a as I,b as f,c as p}from"./tabs-BF_GULHR.js";import H from"./edit-patient-form-BFjMb8rc.js";import V from"./add-medical-record-form-DP75PlXC.js";import"./label-CDKTbEDO.js";import"./textarea-BYzEf3mT.js";import q from"./AddPrescriptionForm-CE8m4KlU.js";import{A as U}from"./AdminLayout-Dyu_a3Tf.js";import{m as z}from"./proxy-ZNVcD8-b.js";import{A as G}from"./arrow-left-YQvGqRxb.js";import{P as y}from"./plus-gxag1FSO.js";import{S as _}from"./square-pen-sR7dtdHg.js";import{P as O}from"./phone-DYxuQXh-.js";import{M as Y}from"./mail-DZyPHXoh.js";import{M as $}from"./map-pin-CK_FjD0y.js";import{H as K}from"./heart-CLtm4S8L.js";import{C as M}from"./calendar-BrZsuCFt.js";import{P as Q}from"./pill-COPI9s1H.js";import{T as J}from"./triangle-alert-D-giMksT.js";import"./Subservices-hmtw6ece.js";import"./utils-RNxviqOY.js";import"./index-Cq2dcEjx.js";import"./index-OLHtNq9T.js";import"./index-B8mBpvNl.js";import"./Combination-2tzW629K.js";import"./index-Bgv3a4mK.js";import"./index-DsxiASPK.js";import"./index-oebGMNB2.js";import"./index-DZIW3V9d.js";import"./index-DOR0Hs6C.js";import"./index-C_AcOWpb.js";import"./dialog-B8nFG98e.js";import"./x-DPKTEG6E.js";import"./createLucideIcon-Iodx7ABU.js";import"./save-Dt_DrhAI.js";import"./PrintErrors-BgGDserB.js";import"./file-text-B0tnsgmg.js";import"./refresh-cw-n5BNCQKk.js";import"./trash-2-DhHB7lAu.js";import"./printer-B6zykAlQ.js";import"./avatar-C_4TQ5Yo.js";import"./separator-Dea6m5MS.js";import"./popover-DhIjPLo6.js";import"./format-Dp3w_Y3x.js";import"./isBefore-COsor6RJ.js";import"./isSameMonth-BOwz-_mK.js";import"./TextInput-CNHhKKz2.js";import"./settings-D3DbHyWx.js";import"./house-BDFhcRnP.js";import"./users-DsTP5XtR.js";import"./pusher-D6WSJpxN.js";import"./package-Cp0Bf08w.js";import"./circle-check-big-Ou30A1K0.js";import"./bell-CCnrKINf.js";import"./index-DU8KxlJ_.js";import"./autoprefixer-CqoIqzrW.js";import"./Toaster-WULlhlN-.js";import"./toast-pmq-0a25.js";import"./layers-BoC40BlJ.js";import"./chart-column-WDIuOrtD.js";function js({patients_:W,doctors:h,patient:s,medicines:g,isAdminView:N=!1}){const[E,v]=m.useState(!1),[F,b]=m.useState(!1),[T,j]=m.useState(!1);console.log("PatientRecords props:",{patient:s,medicines:g,doctors:h});const L=r=>{const t=new Date,o=new Date(r);let C=t.getFullYear()-o.getFullYear();const A=t.getMonth()-o.getMonth();return(A<0||A===0&&t.getDate()<o.getDate())&&C--,C},{data:c,setData:w,post:D,processing:X,recentlySuccessful:Z,errors:P,clearErrors:ee,reset:se}=R({});m.useEffect(()=>{c&&Object.keys(c).length>0&&(c.medicines&&c.doctor_id?D(route("patients.prescription.store",{patientid:s?.id}),{onSuccess:()=>{j(!1)},onFinish:()=>{u.reload({only:["patient","doctors","medicines","flash"]})}}):D(route("patients.medicalrec.store",{patientid:s?.id}),{onSuccess:()=>{b(!1)},onFinish:()=>{u.reload({only:["patients_","doctors","flash"]})}}))},[c]),m.useEffect(()=>{if(window.Echo)return window.Echo.channel("inventory-updates").listen("InventoryUpdated",r=>{console.log("Inventory updated, refreshing patient data...",r),u.reload({only:["patient","medicines"]})}),()=>{window.Echo.leaveChannel("inventory-updates")}},[]);const k=()=>E?e.jsx(H,{patient:s,onSubmit:r=>{onUpdate(r),v(!1)},onCancel:()=>v(!1)}):F?e.jsx(V,{patientName:`${s.firstname} ${s.lastname}`,onSubmit:r=>w(r),onCancel:()=>b(!1),doctors:h,errors:P}):T&&!N?(console.log("Passing props to AddPrescriptionForm:",{patient:s,doctors:h,medicines:g}),e.jsx(q,{patient:s,doctors:h,medicines:g,onSubmit:r=>w(r),onCancel:()=>j(!1),errors:P})):e.jsx("div",{className:"bg-gray-50",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(l,{variant:"outline",onClick:r=>{u.visit(route("patients.index"))},children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Back to List"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:[s.firstName," ",s.lastName]}),e.jsxs("p",{className:"text-muted-foreground",children:["Patient ID: ",s.id," • Age:"," ",L(s.birth)," • Name:"," ",s?.firstname," ",s?.lastname]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:()=>b(!0),children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add Medical Record"]}),e.jsxs(l,{variant:"outline",onClick:()=>v(!0),children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Edit Patient"]})]})]}),e.jsxs(B,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(I,{children:[e.jsx(f,{value:"overview",children:"Overview"}),e.jsx(f,{value:"medical-history",children:"Medical Records"}),!N&&e.jsx(f,{value:"prescriptions",children:"Prescriptions"}),e.jsx(f,{value:"medications",children:"Medications & Allergies"})]}),e.jsxs(p,{value:"overview",className:"space-y-6",children:[e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(n,{children:"Basic Information"})}),e.jsxs(a,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsxs("p",{className:"text-lg",children:[s.firstname," ",s.lastname]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date of Birth"}),e.jsx("p",{children:new Date(s.birth).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),e.jsx("p",{children:s.gender=="M"?"Male":s.gender=="F"?"Female":""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mr-2",children:"Status"}),e.jsx(x,{variant:s.status==="active"?"default":"secondary",children:s.status})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{children:s.contactno})]})]}),s.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{children:s.email})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground mt-1"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Address"}),e.jsx("p",{children:s.address??"Not Set"})]})]}),s.bloodtype&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Blood Type"}),e.jsx("p",{children:s.bloodtype})]})]})]})]})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(n,{children:"Emergency Contact"})}),e.jsx(a,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Contact Person"}),s?.emercont?.map(r=>e.jsx("p",{children:r.name}))]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone Number"}),s?.emercont?.map(r=>e.jsx("p",{children:r.contactno}))]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-center font-medium text-muted-foreground",children:"Action"}),s?.emercont?.map(r=>e.jsxs("p",{children:[e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(_,{className:"h-4 w-4 text-primary"})}),e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(Trash2,{className:"h-4 w-4 text-red-500"})})]},r?.id))]})]})})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(n,{children:"Visit Information"})}),e.jsx(a,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Registration Date"}),e.jsx("p",{children:new Date(s.created_at).toLocaleDateString()})]})]}),s.lastVisit&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Visit"}),e.jsx("p",{children:new Date(s.lastVisit).toLocaleDateString()})]})]})]})})]})]}),e.jsx(p,{value:"medical-history",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsx(n,{children:"Medical History"}),e.jsx(S,{children:"Complete medical record history for this patient"})]}),e.jsx(a,{children:s.medical_histories&&s.medical_histories.length>0?e.jsx("div",{className:"space-y-4",children:s.medical_histories.map(r=>e.jsx(i,{children:e.jsx(a,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),e.jsx("p",{children:new Date(r.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Doctor"}),e.jsxs("p",{children:[r?.doctor?.user?.firstname," ",r?.doctor?.user?.lastname]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Diagnosis"}),e.jsx("p",{children:r.diagnosis})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Treatment"}),e.jsx("p",{children:r.treatment})]}),r.clinic_notes&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),e.jsx("p",{children:r.clinic_notes})]}),r.followUp&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Follow-up"}),e.jsx("p",{children:r.followup_inst})]})]})})},r.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No medical records found for this patient."})})]})}),!N&&e.jsx(p,{value:"prescriptions",className:"space-y-6",children:e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Prescriptions"}),e.jsx(S,{children:"Prescription history and management for this patient"})]}),e.jsxs(l,{onClick:()=>j(!0),children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add Prescription"]})]})}),e.jsx(a,{children:s.prescriptions&&s.prescriptions.length>0?e.jsx("div",{className:"space-y-4",children:s.prescriptions.map(r=>e.jsx(i,{children:e.jsxs(a,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:r.prescription_number}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(r.prescription_date).toLocaleDateString()})]}),e.jsx(x,{variant:r.status==="pending"?"warning":r.status==="dispensed"?"success":"secondary",children:r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Doctor"}),e.jsx("p",{children:r.doctor_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Case ID"}),e.jsx("p",{children:r.case_id||"N/A"})]})]}),r.medicines&&r.medicines.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Medicines"}),e.jsx("div",{className:"space-y-2",children:r.medicines.map((t,o)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.medicine_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.dosage," - ",t.frequency," - ",t.duration]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Qty: ",t.quantity]}),t.is_dispensed&&e.jsx(x,{variant:"success",className:"text-xs",children:"Dispensed"})]})]},o))})]}),r.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),e.jsx("p",{className:"text-sm",children:r.notes})]})]})},r.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No prescriptions found for this patient."}),e.jsxs(l,{onClick:()=>j(!0),children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add First Prescription"]})]})})]})}),e.jsx(p,{value:"medications",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Current Medications"]})}),e.jsx(a,{children:s.medications&&s.medications.length>0?e.jsx("div",{className:"space-y-2",children:s.medications.map((r,t)=>e.jsx(x,{variant:"outline",className:"mr-2 mb-2",children:r},t))}):e.jsx("p",{className:"text-muted-foreground",children:"No current medications recorded."})})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Known Allergies"]})}),e.jsx(a,{children:s.allergies&&s.allergies.length>0?e.jsx("div",{className:"space-y-2",children:s.allergies.map((r,t)=>e.jsx(x,{variant:"destructive",className:"mr-2 mb-2",children:r},t))}):e.jsx("p",{className:"text-muted-foreground",children:"No known allergies recorded."})})]})]})})]})]})});return e.jsx(U,{header:"Patients",children:e.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsx(k,{})})})}export{js as default};
