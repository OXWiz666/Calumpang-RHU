import{r as i,P as V,j as s,b as _}from"./app-dOxLF04F.js";import{c as W,d as q,a as H,e as Q,C as R}from"./card-CYcp7jJ_.js";import{B as m}from"./badge-CJbEyv-q.js";import{B as t}from"./button-AgyiIwL-.js";import{C as S}from"./CustomModal-46AZKI4U.js";import{I as G}from"./InputLabel-vvmzJ4mK.js";import"./label-BcN8Gpyq.js";import{I as J}from"./input-DT4eHb3q.js";import{f as E}from"./dialog-B2f0B6U5.js";import{T as K}from"./triangle-alert-8a4DkhLi.js";import{C as X}from"./clock-uNacND8z.js";import{C as Y}from"./chevron-up-B_DpZzBr.js";import{C as Z}from"./chevron-down-BGd_ne4h.js";import{f as M}from"./format-BtYX0kVO.js";import"./select-l0dFdoh2.js";import"./react-icons.esm-BorQdFth.js";import"./index-Deno71kd.js";import"./index-CNZ2Dx4u.js";import"./index-CWpNLmxq.js";import"./Combination-CoHc-Nci.js";import"./index-BCB7khfw.js";import"./index-uR-2BYu3.js";import"./index-DykSkOEa.js";import"./index-Bvp2oBEW.js";import"./createLucideIcon-BVlFUOuY.js";const we=({item:e,onUpdateClick:U})=>{var x,u,h,g,j,f,v,y,N,b,C,k,w,D,I;const[n,L]=i.useState(!1),o=((x=e==null?void 0:e.stock[0])==null?void 0:x.stocks)<=5,l=((g=(h=e==null?void 0:e.stocks_movement)==null?void 0:h[((u=e==null?void 0:e.stocks_movement)==null?void 0:u.length)-1])==null?void 0:g.expiry_date)&&new Date((v=(f=e==null?void 0:e.stocks_movement)==null?void 0:f[((j=e==null?void 0:e.stocks_movement)==null?void 0:j.length)-1])==null?void 0:v.expiry_date).getTime()-new Date().getTime()<30*24*60*60*1e3,B=a=>{switch(a){case"Medicine":return"bg-blue-100 text-blue-800";case"Vaccine":return"bg-green-100 text-green-800";case"Supply":return"bg-purple-100 text-purple-800";case"Equipment":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},{data:c,setData:F,processing:p,put:T,delete:$}=V({itemname:e==null?void 0:e.name,categoryid:e==null?void 0:e.category_id}),[z,d]=i.useState(!1),[A,r]=i.useState(!1),O=a=>{a.preventDefault(),T(route("admin.inventory.item.update",{inventory:e.id}),{onFinish:()=>{_.reload({only:["flash","inventory"]})},onSuccess:()=>{r(!1)}})},P=a=>{a.preventDefault(),$(route("admin.inventory.item.delete",{inventory:e.id}),{onFinish:()=>{_.reload({only:["flash","inventory"]})},onSuccess:()=>{r(!1)}})};return s.jsxs(W,{className:`mb-4 ${o?"border-red-300":l?"border-amber-300":"border-gray-200"}`,children:[s.jsx(q,{className:"pb-2",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx(H,{className:"text-lg font-medium",children:e.name}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[s.jsx(m,{className:B(e.category.name),children:e.category.name}),o&&s.jsxs(m,{variant:"destructive",className:"flex items-center gap-1",children:[s.jsx(K,{className:"h-3 w-3"}),"Low Stock"]}),l&&e.expirationDate&&s.jsxs(m,{variant:"outline",className:"bg-amber-100 text-amber-800 flex items-center gap-1",children:[s.jsx(X,{className:"h-3 w-3"}),"Expiring Soon"]})]})]}),s.jsx(t,{variant:"ghost",size:"sm",onClick:()=>L(!n),className:"h-8 w-8 p-0",children:n?s.jsx(Y,{className:"h-4 w-4"}):s.jsx(Z,{className:"h-4 w-4"})})]})}),s.jsxs(Q,{className:"pb-3",children:[s.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Quantity"}),s.jsxs("p",{className:`font-medium ${o?"text-red-600":""}`,children:[(y=e.stock[0])==null?void 0:y.stocks," ",(N=e.stock[0])==null?void 0:N.stockname,"s"]})]})}),s.jsxs("div",{children:[s.jsx(t,{variant:"outline",size:"sm",className:"w-1/2 mt-2 hover:bg-secondary/80 transition-colors font-medium",onClick:()=>{r(!0)},children:"Edit Item"}),s.jsxs(S,{isOpen:A,onClose:a=>{r(!1)},title:"Updating an Item",description:`Update ${e==null?void 0:e.name} item here.`,maxWidth:"md",children:[s.jsxs("div",{children:[s.jsx(G,{value:"Item Name*"}),s.jsx(J,{value:c==null?void 0:c.itemname,onChange:a=>F("itemname",a.target.value)})]}),s.jsxs(E,{className:"pt-4",children:[s.jsx(t,{type:"button",variant:"outline",onClick:a=>{r(!1)},children:"Cancel"}),s.jsx(t,{className:"bg-primary hover:bg-primary/90",disabled:p,onClick:O,children:"Update Item"})]})]}),s.jsx(t,{variant:"outline",size:"sm",className:"w-1/2",onClick:a=>{d(!0)},children:"Delete Item"}),s.jsx(S,{isOpen:z,onClose:a=>{d(!1)},title:"Deleting an Item.",description:`Are you sure you want to delete this item ${e==null?void 0:e.name}?`,maxWidth:"md",children:s.jsxs(E,{className:"pt-4",children:[s.jsx(t,{type:"button",variant:"outline",onClick:a=>{d(!1)},children:"Cancel"}),s.jsx(t,{type:"submit",className:"bg-primary hover:bg-primary/90",disabled:p,onClick:P,children:"Delete Item"})]})})]}),n&&s.jsx("div",{className:"mt-4 border-t pt-3",children:s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[((C=(b=e==null?void 0:e.stocks_movement)==null?void 0:b[0])==null?void 0:C.expiry_date)&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Expiration Date"}),s.jsx("p",{className:`font-medium ${l?"text-amber-600":""}`,children:M(new Date((D=(w=e==null?void 0:e.stocks_movement)==null?void 0:w[((k=e==null?void 0:e.stocks_movement)==null?void 0:k.length)-1])==null?void 0:D.expiry_date),"MMM dd, yyyy")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Last Updated"}),s.jsx("p",{className:"font-medium",children:M(new Date((I=e.stocks_movement[0])==null?void 0:I.updated_at),"MMM dd, yyyy")})]}),e.isVaccine&&s.jsxs(s.Fragment,{children:[e.lotNumber&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Lot Number"}),s.jsx("p",{className:"font-medium",children:e.lotNumber})]}),e.location&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Storage Location"}),s.jsx("p",{className:"font-medium",children:e.location})]})]})]})})]}),n&&s.jsx(R,{className:"pt-0",children:s.jsx(t,{variant:"outline",size:"sm",className:"w-full hover:bg-secondary/80 transition-colors font-medium",onClick:()=>U(e),children:"Update Stock"})})]})};export{we as default};
