import{r as i,P as z,j as e,a as Y,R as Oe}from"./app-Dv1l9kWC.js";import{C as Z}from"./react-icons.esm-DAXyCvzT.js";import{B as n}from"./button-QoOdmPDh.js";import{I as F}from"./input-DkLzmgxz.js";import"./avatar-DO0CFQ7Z.js";import{B as h}from"./badge-C4vUuwf6.js";import{S as Ie,T as ee,a as se,b as j,c as o,d as re,e as d}from"./table2-Cjki-V5E.js";import{S as He,a as Le,b as ze,c as Fe,d as P}from"./select-BJwc-KIN.js";import{D as w,b as C,c as D,d as A,e as T,f as k,a as _}from"./dialog-Dhxj4tUC.js";import{L as v}from"./label-BZVChWAa.js";import"./textarea-CHAZdFHk.js";import Pe from"./Sidebar-cXLoOQi2.js";import _e from"./ServicesLayout-CO5Nedrd.js";import{h as ae}from"./moment-C5S46NFB.js";import{F as Be}from"./filter-fHN_7E8Z.js";import{C as Re}from"./chevron-up-C4hZ6S8m.js";import{C as Ve}from"./chevron-down-Da-THbDs.js";import{S as ie}from"./square-pen-F0E400O2.js";import{T as te}from"./trash-2-Dddd_BsQ.js";import"./utils-CHBYMQHL.js";import"./index-C9vQlTib.js";import"./index-nZeaUIKu.js";import"./createLucideIcon-CM1OX3wL.js";import"./arrow-up-BbQo2DhC.js";import"./index-B9T5haDV.js";import"./index-BqgYiBZ4.js";import"./Combination-fJ1si5Ps.js";import"./index-CjMUfMTQ.js";import"./index-CvCXpfpM.js";import"./index-BuDhz_bL.js";import"./card-DegBJ_i3.js";import"./alert-DohF2ZOj.js";import"./separator-BkFew5yv.js";import"./square-kanban-BmhEkNd5.js";import"./layers-BvVBYUNy.js";import"./CustomModal-BUxV7RvH.js";import"./AdminLayout-BHNiRRCX.js";import"./popover-D3fKYnZ9.js";import"./format-BtYX0kVO.js";import"./isBefore-CNJkrGzj.js";import"./isSameMonth-CLqEvLGB.js";import"./TextInput-NVKQ5UzY.js";import"./x-D3jR3T67.js";import"./settings-BhQZgbr3.js";import"./calendar-Dzh9fk7w.js";import"./users-99RRO94a.js";import"./bell-C2MHeLLa.js";import"./pusher-Aj037vmu.js";import"./autoprefixer-DLqmnUyt.js";import"./mail-lERVsJyD.js";import"./search-DHuFl9Pc.js";import"./chart-column-CrZrmNph.js";import"./InputLabel-BSX7_vrS.js";import"./circle-plus-ByBRAJbl.js";const Xs=({services_:g})=>{const[B,M]=i.useState(g),[ce,Ue]=i.useState(""),[E,le]=i.useState("all"),[O,S]=i.useState(!1),[x,Ke]=i.useState({key:"servicename",direction:"ascending"}),[We,ne]=i.useState(!1),de=(r=!1)=>{ne(r)};i.useEffect(()=>{M(g),console.log("services: ",g)},[g]);const[R,b]=i.useState(!1),[$e,qe]=i.useState(null),[I,V]=i.useState(!1),[f,U]=i.useState({servicename:"",status:"Active"}),[oe,Ge]=i.useState({name:"",description:"",duration:30,price:0,recurrenceDates:[]});[...B.filter(r=>{const s=r.servicename.toLowerCase().includes(ce.toLowerCase()),t=E==="all"||r.status===E;return s&&t})].sort((r,s)=>r[x.key]<s[x.key]?x.direction==="ascending"?-1:1:r[x.key]>s[x.key]?x.direction==="ascending"?1:-1:0);const[me,K]=i.useState(null),he=r=>{I===r?(V(null),K(null)):(V(r),K(r))},xe=r=>{L(s=>({...s,days:s.days.includes(r)?s.days.filter(t=>t!==r):[...s.days,r]}))},ue=()=>{ve(route("admin.services.subservice.create"),{preserveScroll:!0,preserveState:!0,only:["services_"],onSuccess:()=>{b(!1),alert_toast("Success","Sub-Service added successfully!")}})},W=async(r,s)=>{var t,p;S(!0);try{const a=s?"/admin/services/unarchive":"/admin/services/archive",c=await Y.post(a,{service_id:r});c.data.services&&(M(c.data.services),alert_toast("Success",c.data.message))}catch(a){console.error("Error archiving/unarchiving service:",a),alert_toast("Error",((p=(t=a.response)==null?void 0:t.data)==null?void 0:p.message)||"An error occurred while updating the service")}finally{S(!1)}},pe=r=>{switch(r){case 1:return e.jsx(h,{className:"bg-green-500",children:"Active"});case 0:return e.jsx(h,{className:"bg-gray-500",children:"Inactive"});default:return e.jsx(h,{children:r})}},{data:$,setData:H,processing:je,post:ve}=z({serviceid:"",subservicename:""}),[ge,q]=i.useState(!1),{data:Se,setData:L,post:be,processing:fe,errors:G}=z({days:oe.recurrenceDates,serviceid:me}),ye=()=>{be(route("admin.services.days.update"),{preserveScroll:!0,preserveState:!0,replace:!0,only:["services_"],onSuccess:()=>{q(!1),alert_toast("Success!","Successfully Updated!","success")}})},Ne=["09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","01:00 PM","01:30 PM","02:00 PM","02:30 PM","03:00 PM","03:30 PM","04:00 PM"],[we,Qe]=i.useState([]),[J,Ce]=i.useState({}),[De,Q]=i.useState(!1),{data:y,setData:u,processing:Ae,post:Te,errors:X}=z({times:we,subservice_id:J,subservicename:""}),ke=r=>{u(s=>({...s,times:s.times.includes(r)?s.times.filter(t=>t!==r):[...s.times,r]}))},Me=r=>{Te(route("admin.services.time.update"),{preserveScroll:!0,onSuccess:()=>{Q(!1),alert_toast("Success!","Successfully Updated!","success")}})},Ee=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return i.useEffect(()=>{console.log("datatime; ",y)},[y]),e.jsxs(_e,{children:[e.jsxs("div",{className:" mb-5",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Services"}),e.jsx("p",{className:"text-gray-600",children:"These are the services to be used in the Appointment Schedules."}),e.jsx("p",{className:"text-muted-foreground"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx(Pe,{activeTab:"services"}),e.jsxs("div",{className:"bg-accent/20 rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-primary",children:"All Services"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{open:R,onOpenChange:r=>{b(r),r||U({servicename:"",status:"Active"})},children:e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(A,{children:"Add New Service"}),e.jsx(T,{children:"Create a new service for appointments."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{htmlFor:"servicename",className:"text-right",children:"Service Name"}),e.jsx(F,{id:"servicename",name:"servicename",className:"col-span-3",value:f.servicename,onChange:r=>U({...f,servicename:r.target.value})})]})}),e.jsx(k,{children:e.jsx(n,{type:"submit",onClick:async()=>{var r,s;try{S(!0);const t=await Y.post("/admin/services/create",f);t.data.services&&(M(t.data.services),b(!1),alert_toast("Success","Service added successfully!"))}catch(t){console.error("Error creating service:",t),alert_toast("Error",((s=(r=t.response)==null?void 0:r.data)==null?void 0:s.message)||"An error occurred while creating the service")}finally{S(!1)}},disabled:!f.servicename||O,children:"Save Service"})})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Filter by:"})]}),e.jsxs(He,{value:E,onValueChange:le,children:[e.jsx(Le,{className:"w-[180px]",children:e.jsx(ze,{placeholder:"Status"})}),e.jsxs(Fe,{children:[e.jsx(P,{value:"all",children:"All Statuses"}),e.jsx(P,{value:"Active",children:"Active"}),e.jsx(P,{value:"Inactive",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsx(Ie,{data:B,defaultSort:{key:"servicename",direction:"asc"},children:({sortedData:r})=>e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(j,{children:[e.jsx(o,{}),e.jsx(o,{sortKey:"servicename",sortable:!0,children:"Service Name"}),e.jsx(o,{sortKey:"status",sortable:!0,children:"Status"}),e.jsx(o,{children:"Available Days"}),e.jsx(o,{sortKey:"servicename",sortable:!0,children:"Sub Services"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(re,{children:r.map((s,t)=>{var p;return e.jsxs(Oe.Fragment,{children:[e.jsxs(j,{children:[e.jsx(d,{children:e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>he(s.id),children:I===s.id?e.jsx(Re,{className:"h-4 w-4"}):e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsx(d,{children:s.servicename}),e.jsx(d,{children:pe(s.status)}),e.jsx(d,{className:" grid gap-1",children:(p=s==null?void 0:s.servicedays)==null?void 0:p.map((a,c)=>e.jsx(h,{className:"bg-primary",children:a.day},c))}),e.jsx(d,{children:(s==null?void 0:s.subservices.length)<=0?e.jsx("div",{children:"No Sub Services"}):e.jsxs("div",{children:[s==null?void 0:s.subservices.length," ","Service",(s==null?void 0:s.subservices.length)>1?"s":""]})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[s.status===0?e.jsxs(n,{variant:"outline",size:"sm",className:"text-green-600 hover:text-green-700 hover:bg-green-50 flex items-center gap-1",onClick:()=>W(s.id,!0),disabled:O,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M12 12v7"}),e.jsx("path",{d:"M8 12l4-4 4 4"})]}),"Unarchive"]}):e.jsxs(n,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-1",onClick:()=>W(s.id,!1),disabled:O,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M12 19V12"}),e.jsx("path",{d:"M8 15l4 4 4-4"})]}),"Archive"]}),e.jsxs(w,{open:R,onOpenChange:a=>{b(a),a&&H("serviceid",s.id)},children:[e.jsx(_,{asChild:!0,children:e.jsx(n,{variant:"outline",size:"sm",children:"Add Sub-service"})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Add Sub-service to"," ",s.servicename]}),e.jsx(T,{children:"Create a new sub-service for this service category."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{htmlFor:"subName",className:"text-right",children:"Sub Service"}),e.jsx(F,{id:"subName",name:"name",value:$.subservicename,onChange:a=>{H("subservicename",a.target.value)},className:"col-span-3"})]})}),e.jsx(k,{children:e.jsx(n,{type:"submit",onClick:ue,disabled:!$.subservicename||je,children:"Save Sub-service"})})]})]}),e.jsxs(w,{open:ge,onOpenChange:a=>{var c;q(a),a&&(L("days",((c=s==null?void 0:s.servicedays)==null?void 0:c.map(N=>N.day))||[]),L("serviceid",s.id))},children:[e.jsx(_,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Edit Days to"," ",s.servicename]}),e.jsx(T,{children:"Edit days for this service category."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{className:"text-right",children:"Available Days"}),Ee.map(a=>e.jsx(h,{className:`cursor-pointer ${Se.days.includes(a)?"bg-primary":"bg-muted text-red-500"}`,onClick:()=>xe(a),children:a},a))]}),Object.keys(G).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("ul",{className:"text-sm text-red-600",children:Object.entries(G).map(([a,c])=>e.jsx("li",{children:c},a))})})]})})]}),e.jsx(k,{children:e.jsx(n,{onClick:a=>{ye()},disabled:fe,children:"Save Days"})})]})]}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>{de(!0),H("subservicename",s.servicename)},children:e.jsx(te,{className:"h-4 w-4 text-red-500"})})]})})]}),I===s.id&&e.jsx(j,{children:e.jsx(d,{colSpan:6,className:"p-0",children:e.jsxs("div",{className:"bg-muted/20 p-4",children:[e.jsxs("h3",{className:"font-medium mb-2",children:["Sub-services for"," ",s.servicename]}),s.subservices.length>0?e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(j,{children:[e.jsx(o,{children:"Sub Service"}),e.jsx(o,{children:"Available Time"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(re,{children:s==null?void 0:s.subservices.map((a,c)=>{var N;return e.jsxs(j,{children:[e.jsx(d,{children:a.subservicename}),e.jsx(d,{children:(N=a==null?void 0:a.times)==null?void 0:N.map((l,m)=>e.jsx(h,{className:"cursor-pointer bg-primary",children:ae(l.time,"HH:mm:ss").format("hh:mm A")},m))}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsxs(w,{open:De,onOpenChange:l=>{Q(l),l&&(console.log("selected: ",a.subservicename),u("subservice_id",a.id),Ce(a),u("subservicename",a.subservicename),u("times",a==null?void 0:a.times.map(m=>ae(m.time,"HH:mm:ss").format("hh:mm A"))))},children:[e.jsx(_,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Edit Time to"," ",J.subservicename]}),e.jsx(T,{children:"Edit days for this sub service category."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx(v,{children:"Sub-Service:"}),e.jsx(F,{className:" w-full",value:y.subservicename,onChange:l=>{u("subservicename",l.target.value)}}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{className:" text-right",children:"Available Time:"}),Ne.map((l,m)=>e.jsx(h,{className:`cursor-pointer ${y.times.includes(l)?"bg-primary":"bg-muted text-red-500"}`,onClick:()=>ke(l),children:l},m))]})]}),e.jsxs(k,{children:[Object.keys(X).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("ul",{className:"text-sm text-red-600",children:Object.entries(X).map(([l,m])=>e.jsx("li",{children:m},l))})})]})}),e.jsx(n,{onClick:Me,disabled:Ae,children:"Save Time"})]})]})]}),e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(te,{className:"h-4 w-4 text-red-500"})})]})})]},c)})})]}):e.jsx("p",{className:"text-muted-foreground",children:"No sub-services found for this service."})]})})})]},t)})})]})})})]})]})]})};export{Xs as default};
