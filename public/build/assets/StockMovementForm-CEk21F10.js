import{r as i,j as e,u as z,b as W,a as Q}from"./app-BYek28t3.js";import{D as X,a as Y,b as J,c as Z,d as ee}from"./dialog-B8nFG98e.js";import{B as E}from"./button-CFU6UcKA.js";import{I as N}from"./input-B0M3oF_m.js";import{L as y}from"./label-CDKTbEDO.js";import{b as re,c as _,P as b,a as k,h as se}from"./index-Cq2dcEjx.js";import{u as w,c as P}from"./utils-RNxviqOY.js";import{c as S,R as ae,I as te}from"./index-DOR0Hs6C.js";import{u as oe}from"./index-B8mBpvNl.js";import{u as ne}from"./index-DsxiASPK.js";import{u as ie}from"./index-oebGMNB2.js";import{P as ce}from"./index-C_AcOWpb.js";import{T as de}from"./textarea-BYzEf3mT.js";import{P as le}from"./PrintErrors-BgGDserB.js";import{T as R}from"./trending-up-B7iWfh5r.js";import{m as me}from"./proxy-ZNVcD8-b.js";import{P as ue}from"./package-Cp0Bf08w.js";import{T as pe}from"./trending-down-CKDYnFhE.js";import{C as xe}from"./calendar-BrZsuCFt.js";import{H as fe}from"./hash-DwPNS_rR.js";import{F as ge}from"./file-text-B0tnsgmg.js";import{U as ye}from"./user-jpraIQK4.js";import"./Subservices-hmtw6ece.js";import"./Combination-2tzW629K.js";import"./index-OLHtNq9T.js";import"./createLucideIcon-Iodx7ABU.js";var I="Radio",[he,D]=_(I),[ve,be]=he(I),G=i.forwardRef((o,n)=>{const{__scopeRadio:r,name:l,checked:s=!1,required:t,disabled:d,value:u="on",onCheck:f,form:p,...x}=o,[m,g]=i.useState(null),c=w(n,v=>g(v)),a=i.useRef(!1),h=m?p||!!m.closest("form"):!0;return e.jsxs(ve,{scope:r,checked:s,disabled:d,children:[e.jsx(b.button,{type:"button",role:"radio","aria-checked":s,"data-state":A(s),"data-disabled":d?"":void 0,disabled:d,value:u,...x,ref:c,onClick:k(o.onClick,v=>{s||f?.(),h&&(a.current=v.isPropagationStopped(),a.current||v.stopPropagation())})}),h&&e.jsx(F,{control:m,bubbles:!a.current,name:l,value:u,checked:s,required:t,disabled:d,form:p,style:{transform:"translateX(-100%)"}})]})});G.displayName=I;var O="RadioIndicator",q=i.forwardRef((o,n)=>{const{__scopeRadio:r,forceMount:l,...s}=o,t=be(O,r);return e.jsx(ce,{present:l||t.checked,children:e.jsx(b.span,{"data-state":A(t.checked),"data-disabled":t.disabled?"":void 0,...s,ref:n})})});q.displayName=O;var je="RadioBubbleInput",F=i.forwardRef(({__scopeRadio:o,control:n,checked:r,bubbles:l=!0,...s},t)=>{const d=i.useRef(null),u=w(d,t),f=ie(r),p=ne(n);return i.useEffect(()=>{const x=d.current;if(!x)return;const m=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(m,"checked").set;if(f!==r&&c){const a=new Event("click",{bubbles:l});c.call(x,r),x.dispatchEvent(a)}},[f,r,l]),e.jsx(b.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:u,style:{...s.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});F.displayName=je;function A(o){return o?"checked":"unchecked"}var Ne=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],j="RadioGroup",[Re]=_(j,[S,D]),M=S(),T=D(),[ke,Ce]=Re(j),B=i.forwardRef((o,n)=>{const{__scopeRadioGroup:r,name:l,defaultValue:s,value:t,required:d=!1,disabled:u=!1,orientation:f,dir:p,loop:x=!0,onValueChange:m,...g}=o,c=M(r),a=oe(p),[h,v]=re({prop:t,defaultProp:s??null,onChange:m,caller:j});return e.jsx(ke,{scope:r,name:l,required:d,disabled:u,value:h,onValueChange:v,children:e.jsx(ae,{asChild:!0,...c,orientation:f,dir:a,loop:x,children:e.jsx(b.div,{role:"radiogroup","aria-required":d,"aria-orientation":f,"data-disabled":u?"":void 0,dir:a,...g,ref:n})})})});B.displayName=j;var L="RadioGroupItem",U=i.forwardRef((o,n)=>{const{__scopeRadioGroup:r,disabled:l,...s}=o,t=Ce(L,r),d=t.disabled||l,u=M(r),f=T(r),p=i.useRef(null),x=w(n,p),m=t.value===s.value,g=i.useRef(!1);return i.useEffect(()=>{const c=h=>{Ne.includes(h.key)&&(g.current=!0)},a=()=>g.current=!1;return document.addEventListener("keydown",c),document.addEventListener("keyup",a),()=>{document.removeEventListener("keydown",c),document.removeEventListener("keyup",a)}},[]),e.jsx(te,{asChild:!0,...u,focusable:!d,active:m,children:e.jsx(G,{disabled:d,required:t.required,checked:m,...f,...s,name:t.name,ref:x,onCheck:()=>t.onValueChange(s.value),onKeyDown:k(c=>{c.key==="Enter"&&c.preventDefault()}),onFocus:k(s.onFocus,()=>{g.current&&p.current?.click()})})})});U.displayName=L;var we="RadioGroupIndicator",V=i.forwardRef((o,n)=>{const{__scopeRadioGroup:r,...l}=o,s=T(r);return e.jsx(q,{...s,...l,ref:n})});V.displayName=we;var H=B,K=U,Ie=V;const $=i.forwardRef(({className:o,...n},r)=>e.jsx(H,{className:P("grid gap-2",o),...n,ref:r}));$.displayName=H.displayName;const C=i.forwardRef(({className:o,...n},r)=>e.jsx(K,{ref:r,className:P("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",o),...n,children:e.jsx(Ie,{className:"flex items-center justify-center",children:e.jsx(se,{className:"h-3.5 w-3.5 fill-primary"})})}));C.displayName=K.displayName;const er=({open:o,onClose:n,item:r,onSave:l})=>{const{data:s,setData:t,post:d,processing:u,recentlySuccessful:f,errors:p,put:x}=z({type:"",batchNumber:"",quantity:"",reason:"",expiry:""});i.useEffect(()=>{r&&(t({type:r?.stocks_movement[0]?.type,quantity:0,reason:r?.stocks_movement[0]?.reason,expiry:r?.stocks_movement?.[r?.stocks_movement?.length-1]?.expiry_date,batchNumber:r?.stocks_movement[0]?.batch_number||""}),console.log("item:",r,r?.stocks_movement[0]?.type))},[r]);const m=a=>{t(a.target.name,a.target.value)},g=a=>{if(a.preventDefault(),s.type==="Outgoing"&&parseInt(s.quantity)>r?.stock[0]?.stocks){alert("Cannot remove more items than current stock");return}x(route("admin.inventory.item.stockmovement.update",{movement:r?.stocks_movement[0]?.id}),{onFinish:()=>{Q.reload({only:["flash","inventory","movements_"]})},onSuccess:()=>{n()}})},{user:c}=W().props.auth;return e.jsx(X,{open:o,onOpenChange:n,children:e.jsxs(Y,{className:"sm:max-w-[500px]",children:[e.jsx(J,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:e.jsx(R,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(Z,{className:"text-xl font-semibold",children:"Record Stock Movement"}),e.jsx("p",{className:"text-sm mt-1 text-gray-600",children:"Update inventory stock levels"})]})]})}),e.jsx(le,{errors:p}),e.jsxs(me.form,{onSubmit:g,className:"space-y-6 pt-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ue,{className:"h-5 w-5 text-gray-600"}),e.jsx(y,{className:"text-sm font-medium text-gray-700",children:"Item Details"})]}),e.jsx("p",{className:"font-semibold text-gray-900",children:r?.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Current stock: ",e.jsxs("span",{className:"font-medium text-gray-900",children:[r?.stock[0]?.stocks," ",r?.stock[0]?.stockname,"s"]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{className:"text-sm font-medium flex items-center gap-2 text-gray-700",children:[e.jsx(R,{className:"h-4 w-4 text-gray-500"}),"Movement Type"]}),e.jsxs($,{value:s.type,onValueChange:a=>t("type",a),className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg transition-colors border-gray-200 hover:bg-green-50 hover:border-green-300",children:[e.jsx(C,{value:"Incoming",id:"Incoming"}),e.jsxs(y,{htmlFor:"Incoming",className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Incoming"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg transition-colors border-gray-200 hover:bg-red-50 hover:border-red-300",children:[e.jsx(C,{value:"Outgoing",id:"Outgoing"}),e.jsxs(y,{htmlFor:"Outgoing",className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(pe,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Outgoing"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-gray-500"}),"Expiry Date"]}),e.jsx(N,{id:"expirationDate",type:"date",name:"expirydate",value:s.expiry,onChange:a=>t("expiry",a.target.value),className:"h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{htmlFor:"quantity",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-gray-500"}),"Quantity"]}),e.jsx(N,{id:"quantity",type:"number",min:"1",max:s.type==="Outgoing"?r?.stock[0]?.stocks:void 0,name:"quantity",value:s.quantity,onChange:m,placeholder:"Enter quantity",className:"h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),s.type==="Outgoing"&&e.jsxs("p",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded-md",children:["Maximum quantity that can be removed: ",r?.stock[0]?.stocks]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{htmlFor:"reason",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-500"}),"Reason ",s.type==="Outgoing"&&"(Required)"]}),e.jsx(de,{id:"reason",name:"reason",value:s.reason,onChange:m,placeholder:s.type==="Incoming"?"Optional - Enter reason for adding stock":"Why is this item being removed from inventory?",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:s.type==="Outgoing"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{htmlFor:"performedBy",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-gray-500"}),"Performed By"]}),e.jsx(N,{id:"performedBy",value:`${c?.firstname} ${c?.lastname}`,className:"h-11 border-gray-300 bg-gray-50",disabled:!0})]}),e.jsx(ee,{className:"pt-6 border-t border-gray-100",children:e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx(E,{type:"button",variant:"outline",onClick:n,className:"flex-1 h-11 border-gray-300 hover:bg-gray-50",children:"Cancel"}),e.jsx(E,{type:"submit",className:"flex-1 h-11 text-white",style:{backgroundColor:"#2C3E50"},onMouseEnter:a=>a.target.style.backgroundColor="#34495E",onMouseLeave:a=>a.target.style.backgroundColor="#2C3E50",disabled:u,children:u?"Saving...":"Save Changes"})]})})]})]})})};export{er as default};
