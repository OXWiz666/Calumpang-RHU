import{r as l,q as ke,b,P as Ie,j as e}from"./app-G8iqleJv.js";import{T as G,a as J,b as o,c as Ae}from"./tabs-Be5KyqaB.js";import{c as x,d as p,a as h,e as u}from"./card-cIg_B_IG.js";import{B as f}from"./badge-BLwlscqv.js";import{B as c}from"./button-B_LnOuxf.js";import Te from"./SearchBar-xJQnTNjo.js";import K from"./InventoryItemCard-BjuQVX7W.js";import Me from"./StockMovementForm-yg-yMExZ.js";import De from"./ReportsPanel-8pJy87Jx.js";import Fe from"./AddItemForm-Cdp3Hd3Y.js";import{A as Pe}from"./AdminLayout-C4X4y_vD.js";import{C as L}from"./CustomModal-B9j4gIjG.js";import{I as Q}from"./input-DFrqRW5G.js";import{I as X}from"./InputLabel-BKeIIhOb.js";import{P as Y}from"./PrimaryButton-Cyy6hg6I.js";import{P as _e}from"./PrintErrors-BUwW9Orq.js";import{f as ee}from"./dialog-D79V5GE4.js";import{F as Le}from"./filter-CM2PSqQo.js";import{P as se}from"./plus-B9Cp7Wai.js";import{c as E}from"./createLucideIcon-CtVvwcl8.js";import{T as Ee}from"./triangle-alert-Cp-EFFMw.js";import{C as Be}from"./clock--denLSlA.js";import{P as qe}from"./pill-CV03VfuG.js";import{S as Ue}from"./syringe-C97RPm-Q.js";import{S as Oe}from"./stethoscope-C1oHpyfb.js";import{P as Re}from"./pen-CQ4Y4Xsx.js";import{T as Ve}from"./trash-2-CG2jRtsF.js";import"./index-3LKL4iwc.js";import"./index-DdMWTZ3t.js";import"./index-CLsf0Sf4.js";import"./index-CE5llJVL.js";import"./index-DHagqIMV.js";import"./index-BHXf0KTI.js";import"./utils-k0UhslF6.js";import"./search-DqXpTf7V.js";import"./label-tl9XpKj-.js";import"./chevron-up-DhNhWxCa.js";import"./chevron-down-m_6d1Po1.js";import"./format-BtYX0kVO.js";import"./select-BtrVkcdI.js";import"./react-icons.esm-BGTDVcWI.js";import"./index-B2jg9BR7.js";import"./floating-ui.react-dom-B6MwqTU1.js";import"./index-nEL1Ci1r.js";import"./Combination-BkR281CS.js";import"./textarea-C3QGngH-.js";import"./popover-CkyzJ440.js";import"./isBefore-CNJkrGzj.js";import"./isSameMonth-CLqEvLGB.js";import"./calendar-CpLaM_M8.js";import"./file-text-BJjfZ-_5.js";import"./chart-column-BT4j9c0o.js";import"./download-xgHv_bqS.js";import"./avatar-BI-JSTSG.js";import"./separator-DEyoKzwW.js";import"./moment-C5S46NFB.js";import"./TextInput-BVgWFEty.js";import"./x-yhBls2Ii.js";import"./settings-DF6TMztZ.js";import"./users-D055v8MD.js";import"./bell-COWyhG_0.js";import"./pusher-Bov-XCiP.js";import"./autoprefixer-DaV7nXpj.js";import"./layers-DYzwe8gK.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],We=E("Box",$e);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],te=E("Package",ze);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Ze=E("RefreshCcw",He),lt=({categories:T=[],inventory:n,movements_:ae})=>{const[j,B]=l.useState([]),[g,le]=l.useState(n),[q,re]=l.useState([]),[d,r]=l.useState(n);l.useEffect(()=>{n&&(le(n),r(n),console.log("inventory:",n))},[n]);const{flash:ie}=ke().props;l.useEffect(()=>{b.reload({only:["inventory"]})},[ie]);const[ne,ce]=l.useState(null),[oe,U]=l.useState(!1),[de,O]=l.useState(!1),[v,C]=l.useState(null),[N,R]=l.useState("all"),[M,V]=l.useState("All"),w=n.filter(s=>s.stock[0].stocks<=5),S=g.filter(s=>{var i,t,m,A,H,Z;return((m=(t=s==null?void 0:s.stocks_movement)==null?void 0:t[((i=s==null?void 0:s.stocks_movement)==null?void 0:i.length)-1])==null?void 0:m.expiry_date)&&new Date((Z=(H=s==null?void 0:s.stocks_movement)==null?void 0:H[((A=s==null?void 0:s.stocks_movement)==null?void 0:A.length)-1])==null?void 0:Z.expiry_date).getTime()-new Date().getTime()<30*24*60*60*1e3}),me=s=>{r(s),C(null),R("all")},xe=s=>{C(s),r(g.filter(i=>i.category.id==s))};l.useEffect(()=>{d&&console.log(d)},[d]);const pe=s=>{R(s),C(null),s==="all"?r(g):s==="low"?r(w):s==="expiring"?r(S):s==="master"&&(r(j),V("All"))},he=s=>{V(s),r(s==="All"?j:j.filter(i=>i.category===s))},$=s=>{ce(s),U(!0)},ue=s=>{re([...q,s]),B(updatedItems),r(i=>N==="all"&&!v?updatedItems:N==="low"?updatedItems.filter(t=>t.quantity<=t.reorderThreshold):N==="expiring"?updatedItems.filter(t=>t.expirationDate&&new Date(t.expirationDate).getTime()-new Date().getTime()<30*24*60*60*1e3):N==="master"?M==="All"?updatedItems:updatedItems.filter(t=>t.category===M):v?updatedItems.filter(t=>t.category===v):i.map(t=>updatedItems.find(A=>A.id===t.id)||t))},y=s=>0,[W,D]=l.useState(!1),{data:z,setData:F,post:fe,processing:P,errors:je,clearErrors:ge,put:Ne,delete:ve}=Ie({categoryname:""});l.useEffect(()=>{ge()},[W]);const ye=s=>{s.preventDefault(),fe(route("admin.inventory.category"),{onSuccess:()=>{D(!1)},onFinish:()=>{b.reload({only:["flash","categories"]})}})},[be,k]=l.useState(!1),[Ce,I]=l.useState(!1),[a,_]=l.useState(null);l.useEffect(()=>{a&&F("categoryname",a.name)},[a]);const we=s=>{s.preventDefault(),ve(route("admin.inventory.category.delete",{category:a==null?void 0:a.id}),{onFinish:()=>{b.reload({only:["categories"]})},onSuccess:()=>{k(!1),_(null)}})},Se=s=>{s.preventDefault(),Ne(route("admin.inventory.category.update",{category:a==null?void 0:a.id}),{onFinish:()=>{b.reload({only:["flash","categories"]})},onSuccess:()=>{I(!1)}})};return e.jsxs(Pe,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[e.jsxs("div",{className:" mb-5",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Inventory"}),e.jsx("p",{className:"text-muted-foreground"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4 md:mt-0",children:[e.jsxs(c,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),"Advanced Filters"]}),e.jsxs(c,{className:"flex items-center gap-2",onClick:()=>O(!0),children:[e.jsx(se,{className:"h-4 w-4"}),"Add New Item"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsxs(x,{children:[e.jsx(p,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium",children:"Total Items"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"h-5 w-5 text-muted-foreground mr-2"}),e.jsx("div",{className:"text-2xl font-bold",children:n.length})]})})]}),e.jsxs(x,{children:[e.jsx(p,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium",children:"Categories"})}),e.jsx(u,{children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-2xl font-bold",children:T.length})})})]}),e.jsxs(x,{children:[e.jsx(p,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium",children:"Low Stock Items"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ee,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("div",{className:"text-2xl font-bold",children:w.length})]})})]}),e.jsxs(x,{children:[e.jsx(p,{className:"pb-2",children:e.jsx(h,{className:"text-sm font-medium",children:"Expiring Soon"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"h-5 w-5 text-amber-500 mr-2"}),e.jsx("div",{className:"text-2xl font-bold",children:S.length})]})})]})]}),e.jsx(Te,{items:g,onSearch:me}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[e.jsxs(G,{value:N,onValueChange:pe,className:"mb-6",children:[e.jsxs(J,{children:[e.jsx(o,{value:"all",children:"Master List"}),e.jsxs(o,{value:"low",children:["Low Stock",w.length>0&&e.jsx(f,{variant:"destructive",className:"ml-2",children:w.length})]}),e.jsxs(o,{value:"expiring",children:["Expiring Soon",S.length>0&&e.jsx(f,{variant:"outline",className:"ml-2 bg-amber-100 text-amber-800",children:S.length})]})]}),e.jsx(Ae,{value:"master",className:"mt-6",children:e.jsxs(x,{children:[e.jsx(p,{children:e.jsx(h,{className:"text-xl",children:"Master List"})}),e.jsx(u,{children:e.jsxs(G,{value:M,onValueChange:he,className:"mb-6",children:[e.jsxs(J,{className:"grid md:grid-cols-2 lg:grid-cols-5 lg w-full",children:[e.jsxs(o,{value:"All",className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"All",e.jsx(f,{variant:"secondary",className:"ml-1",children:y()})]}),e.jsxs(o,{value:"Medicine",className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"Medicines",e.jsx(f,{variant:"secondary",className:"ml-1",children:y()})]}),e.jsxs(o,{value:"Vaccine",className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Vaccines",e.jsx(f,{variant:"secondary",className:"ml-1",children:y()})]}),e.jsxs(o,{value:"Equipment",className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Equipment",e.jsx(f,{variant:"secondary",className:"ml-1",children:y()})]}),e.jsxs(o,{value:"Supply",className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"Supplies",e.jsx(f,{variant:"secondary",className:"ml-1",children:y()})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.map(s=>e.jsx(K,{item:s,onUpdateClick:$},s.id)),d.length===0&&e.jsx("div",{className:"col-span-2 text-center py-12 border rounded-lg bg-muted/20",children:e.jsx("p",{className:"text-muted-foreground",children:"No items match your search criteria"})})]})})]})})]})})]}),e.jsxs(Y,{className:"flex items-center gap-2",onClick:()=>{b.reload({only:["inventory"]})},children:[e.jsx(Ze,{className:"h-4 w-4"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs(x,{children:[e.jsx(p,{children:e.jsxs(h,{className:"text-lg",children:[e.jsxs("div",{className:"flex justify-between space-x-2 mt-4 md:mt-0",children:[e.jsx("div",{children:"Categories"}),e.jsxs(c,{className:"flex items-center gap-2",onClick:()=>D(!0),children:[e.jsx(se,{className:"h-4 w-4"}),"Add"]})]}),e.jsx(L,{isOpen:W,onClose:()=>{D(!1)},title:"Add Category",description:"Add Category for Inventory.",maxWidth:"sm",children:e.jsxs("form",{onSubmit:ye,children:[e.jsx(_e,{errors:je}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsxs("div",{className:" w-full",children:[e.jsx(X,{value:"Category Name:"}),e.jsx(Q,{value:z.categoryname,onChange:s=>F("categoryname",s.target.value)})]}),e.jsx(Y,{disabled:P,className:" self-end mt-2",type:"submit",children:"Save"})]})]})})]})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{variant:v===null?"default":"outline",className:"w-full justify-start",onClick:()=>{C(null),r(g)},children:"All Categories"}),T.map((s,i)=>e.jsx(c,{variant:v===s.id?"default":"outline",className:"w-full justify-start",onClick:()=>xe(s.id),children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:"flex-1 truncate text-left",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:t=>{t.preventDefault(),_(s),I(!0)},className:"p-1 text-gray-500 hover:text-blue-500 transition-colors",children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsx("button",{onClick:t=>{t.preventDefault(),_(s),k(!0)},className:"p-1 text-gray-500 hover:text-red-500 transition-colors",children:e.jsx(Ve,{className:"h-4 w-4"})})]})]})},i)),e.jsx(L,{isOpen:be,onClose:s=>{k(!1)},title:`Deleting category ${a==null?void 0:a.name}`,description:`Are you sure you want to delete ${a==null?void 0:a.name} Category?`,maxWidth:"md",children:e.jsxs(ee,{className:"pt-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:s=>{k(!1)},children:"Cancel"}),e.jsx(c,{type:"submit",className:"bg-primary hover:bg-primary/90",disabled:P,onClick:we,children:"Delete Category"})]})}),e.jsxs(L,{isOpen:Ce,onClose:s=>{I(!1)},title:`Updating category ${a==null?void 0:a.name}`,description:`Update ${a==null?void 0:a.name} Category here.`,maxWidth:"md",children:[e.jsxs("div",{className:" w-full",children:[e.jsx(X,{value:"Category Name:"}),e.jsx(Q,{value:z.categoryname,onChange:s=>F("categoryname",s.target.value)})]}),e.jsxs(ee,{className:"pt-4",children:[e.jsx(c,{variant:"outline",onClick:s=>{I(!1)},children:"Cancel"}),e.jsx(c,{className:"bg-primary hover:bg-primary/90",disabled:P,onClick:Se,children:"Update Category"})]})]})]})})]}),e.jsxs(x,{className:"mt-6",children:[e.jsx(p,{children:e.jsx(h,{className:"text-lg",children:"Recent Activity"})}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:q.slice(0,5).map((s,i)=>{const t=j.find(m=>(m==null?void 0:m.id)===(s==null?void 0:s.itemId));return e.jsxs("div",{className:"border-b pb-2 last:border-0 last:pb-0",children:[e.jsxs("p",{className:"font-medium",children:[s.type==="incoming"?"Added":"Removed"," ",s.quantity," ",t==null?void 0:t.unit,"s of"," ",t==null?void 0:t.name]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["By ",s.performedBy," on"," ",new Date(s.date).toLocaleDateString()]})]},i)})})})]})]}),e.jsx("div",{className:"lg:col-span-3",children:N!=="master"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.map(s=>e.jsx(K,{item:s,onUpdateClick:$},s.id)),d.length===0&&e.jsx("div",{className:"col-span-2 text-center py-12 border rounded-lg bg-muted/20",children:e.jsx("p",{className:"text-muted-foreground",children:"No items match your search criteria"})})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsx(De,{items:g,movements:ae})}),e.jsx(Me,{open:oe,onClose:()=>U(!1),item:ne,onSave:ue}),e.jsx(Fe,{open:de,onClose:()=>O(!1),onSave:s=>{B([...j,s]),r([...j,s])},categories:T})]})};export{lt as default};
