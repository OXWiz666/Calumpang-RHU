import{r as l,j as e,P as U,q as z,b as W}from"./app-BhLcihj1.js";import{D as Q,b as X,c as Y,d as J,f as Z}from"./dialog--jmQziZh.js";import{u as w,c as S,B as P}from"./button-Be9dxzc2.js";import{I as R}from"./input-CMQ1mg5c.js";import{L as g}from"./label-DpZTm_7D.js";import{a as ee}from"./react-icons.esm-BsfKKiVe.js";import{a as oe,c as j,P as re}from"./index-D2OfW34y.js";import{c as E}from"./index-JUtOyzXj.js";import{P as k}from"./index-ToWLRMEW.js";import{c as _,R as ae,I as se}from"./index-BkLCJ2Ru.js";import{u as te}from"./index-Dew07psT.js";import{a as ne}from"./Combination-IXk0dSDV.js";import{u as ie}from"./index-CpfHRqbg.js";import{T as ce}from"./textarea-ChjTaUbW.js";import{P as de}from"./PrintErrors-7kHHmjFz.js";var N="Radio",[le,D]=E(N),[ue,pe]=le(N),G=l.forwardRef((a,n)=>{const{__scopeRadio:o,name:u,checked:r=!1,required:s,disabled:c,value:h="on",onCheck:p,form:m,...y}=a,[i,f]=l.useState(null),d=w(n,x=>f(x)),t=l.useRef(!1),v=i?m||!!i.closest("form"):!0;return e.jsxs(ue,{scope:o,checked:r,disabled:c,children:[e.jsx(k.button,{type:"button",role:"radio","aria-checked":r,"data-state":F(r),"data-disabled":c?"":void 0,disabled:c,value:h,...y,ref:d,onClick:j(a.onClick,x=>{r||p==null||p(),v&&(t.current=x.isPropagationStopped(),t.current||x.stopPropagation())})}),v&&e.jsx(me,{control:i,bubbles:!t.current,name:u,value:h,checked:r,required:s,disabled:c,form:m,style:{transform:"translateX(-100%)"}})]})});G.displayName=N;var q="RadioIndicator",A=l.forwardRef((a,n)=>{const{__scopeRadio:o,forceMount:u,...r}=a,s=pe(q,o);return e.jsx(re,{present:u||s.checked,children:e.jsx(k.span,{"data-state":F(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:n})})});A.displayName=q;var me=a=>{const{control:n,checked:o,bubbles:u=!0,...r}=a,s=l.useRef(null),c=ie(o),h=ne(n);return l.useEffect(()=>{const p=s.current,m=window.HTMLInputElement.prototype,i=Object.getOwnPropertyDescriptor(m,"checked").set;if(c!==o&&i){const f=new Event("click",{bubbles:u});i.call(p,o),p.dispatchEvent(f)}},[c,o,u]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:o,...r,tabIndex:-1,ref:s,style:{...a.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function F(a){return a?"checked":"unchecked"}var fe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],C="RadioGroup",[ve,Ae]=E(C,[_,D]),O=_(),M=D(),[he,xe]=ve(C),L=l.forwardRef((a,n)=>{const{__scopeRadioGroup:o,name:u,defaultValue:r,value:s,required:c=!1,disabled:h=!1,orientation:p,dir:m,loop:y=!0,onValueChange:i,...f}=a,d=O(o),t=te(m),[v,x]=oe({prop:s,defaultProp:r,onChange:i});return e.jsx(he,{scope:o,name:u,required:c,disabled:h,value:v,onValueChange:x,children:e.jsx(ae,{asChild:!0,...d,orientation:p,dir:t,loop:y,children:e.jsx(k.div,{role:"radiogroup","aria-required":c,"aria-orientation":p,"data-disabled":h?"":void 0,dir:t,...f,ref:n})})})});L.displayName=C;var T="RadioGroupItem",B=l.forwardRef((a,n)=>{const{__scopeRadioGroup:o,disabled:u,...r}=a,s=xe(T,o),c=s.disabled||u,h=O(o),p=M(o),m=l.useRef(null),y=w(n,m),i=s.value===r.value,f=l.useRef(!1);return l.useEffect(()=>{const d=v=>{fe.includes(v.key)&&(f.current=!0)},t=()=>f.current=!1;return document.addEventListener("keydown",d),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",d),document.removeEventListener("keyup",t)}},[]),e.jsx(se,{asChild:!0,...h,focusable:!c,active:i,children:e.jsx(G,{disabled:c,required:s.required,checked:i,...p,...r,name:s.name,ref:y,onCheck:()=>s.onValueChange(r.value),onKeyDown:j(d=>{d.key==="Enter"&&d.preventDefault()}),onFocus:j(r.onFocus,()=>{var d;f.current&&((d=m.current)==null||d.click())})})})});B.displayName=T;var ye="RadioGroupIndicator",V=l.forwardRef((a,n)=>{const{__scopeRadioGroup:o,...u}=a,r=M(o);return e.jsx(A,{...r,...u,ref:n})});V.displayName=ye;var K=L,$=B,ge=V;const H=l.forwardRef(({className:a,...n},o)=>e.jsx(K,{className:S("grid gap-2",a),...n,ref:o}));H.displayName=K.displayName;const b=l.forwardRef(({className:a,...n},o)=>e.jsx($,{ref:o,className:S("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),...n,children:e.jsx(ge,{className:"flex items-center justify-center",children:e.jsx(ee,{className:"h-3.5 w-3.5 fill-primary"})})}));b.displayName=$.displayName;const Fe=({open:a,onClose:n,item:o,onSave:u})=>{var f,d;const{data:r,setData:s,processing:c,errors:h,put:p}=U({type:"",quantity:"",reason:"",expiry:""});l.useEffect(()=>{var t,v,x,I;o&&(s({type:(t=o==null?void 0:o.stocks_movement[0])==null?void 0:t.type,quantity:0,reason:(v=o==null?void 0:o.stocks_movement[0])==null?void 0:v.reason,expiry:(x=o==null?void 0:o.stocks_movement[0])==null?void 0:x.expiry_date}),console.log("item:",o,(I=o==null?void 0:o.stocks_movement[0])==null?void 0:I.type))},[o]);const m=t=>{s(t.target.name,t.target.value)},y=t=>{var v;t.preventDefault(),p(route("admin.inventory.item.stockmovement.update",{movement:(v=o==null?void 0:o.stocks_movement[0])==null?void 0:v.id}),{onFinish:()=>{W.reload({only:["flash","inventory","movements_"]})},onSuccess:()=>{n()}})},{user:i}=z().props.auth;return e.jsx(Q,{open:a,onOpenChange:n,children:e.jsxs(X,{className:"sm:max-w-[425px]",children:[e.jsx(Y,{children:e.jsx(J,{children:"Record Stock Movement"})}),e.jsx(de,{errors:h}),e.jsxs("form",{onSubmit:y,className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Item"}),e.jsx("p",{className:"font-medium",children:o==null?void 0:o.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Current stock: ",(f=o==null?void 0:o.stock[0])==null?void 0:f.stocks," ",(d=o==null?void 0:o.stock[0])==null?void 0:d.stockname,"s"]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Movement Type"}),e.jsxs(H,{value:r.type,onValueChange:t=>s("type",t),className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(b,{value:"Incoming",id:"Incoming"}),e.jsx(g,{htmlFor:"Incoming",children:"Incoming"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(b,{value:"Outgoing",id:"Outgoing"}),e.jsx(g,{htmlFor:"outgoing",children:"Outgoing"})]})]})]}),e.jsxs("div",{children:[e.jsx(g,{children:"Expiry Date"}),e.jsx(R,{id:"expirationDate",type:"date",name:"expirydate",value:r.expiry,onChange:t=>s("expiry",t.target.value)})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"quantity",children:"Quantity"}),e.jsx(R,{id:"quantity",type:"number",min:"1",name:"quantity",value:r.quantity,onChange:m,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{htmlFor:"reason",children:["Reason ",r.type==="Outgoing"&&"(Required)"]}),e.jsx(ce,{id:"reason",name:"reason",value:r.reason,onChange:m,placeholder:r.type==="Incoming"?"Optional":"Why is this item being removed from inventory?",required:r.type==="Outgoing"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"performedBy",children:"Performed By"}),e.jsx(R,{id:"performedBy",value:`${i==null?void 0:i.firstname} ${i==null?void 0:i.lastname}`,placeholder:"Name of staff member",required:!0})]}),e.jsxs(Z,{className:"pt-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsx(P,{type:"submit",className:"bg-primary hover:bg-primary/90",disabled:c,children:"Save Changes"})]})]})]})})};export{Fe as default};
