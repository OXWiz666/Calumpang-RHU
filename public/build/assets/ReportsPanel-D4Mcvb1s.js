import{r as i,j as e}from"./app-BwNhzenK.js";import{c as L,d as T,a as I,e as E}from"./card-BtxyBDtj.js";import{B as x}from"./button-DV8L1Bm9.js";import{S as N,a as g,b as y,c as k,d as n}from"./select-DGzLCw32.js";import{P as R,a as A,b as M,C as P}from"./popover-BDL1e_MA.js";import{c as S}from"./utils-D12Ag4v_.js";import{C as F}from"./calendar-Cvug6FQu.js";import{a as V}from"./isBefore-CNJkrGzj.js";import{f as o}from"./format-BtYX0kVO.js";import{T as B,a as G,b as w,c as b}from"./tabs-BWUUMize.js";import{F as O}from"./file-text-BViMWuBd.js";import{C as Q}from"./chart-column-B1iyMtAB.js";import{D as $}from"./download-Cg3FfSbh.js";import"./react-icons.esm-Dj3q5OqY.js";import"./index-CnZ-kBHx.js";import"./index-BE2z3MmW.js";import"./index-JAEOqb1t.js";import"./index-CwwrmvlD.js";import"./floating-ui.react-dom-zkrAxQ44.js";import"./Combination-CU5Nek_p.js";import"./isSameMonth-CLqEvLGB.js";import"./createLucideIcon-z8qUd7h6.js";import"./index-DQ6VfPPg.js";import"./index-_W4oScUx.js";function q({className:d}){const[t,a]=i.useState({from:V(new Date,-20),to:new Date});return e.jsx("div",{className:S("grid gap-2",d),children:e.jsxs(R,{children:[e.jsx(A,{asChild:!0,children:e.jsxs(x,{id:"date",variant:"outline",className:S("w-[300px] justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[o(t.from,"LLL dd, y")," -"," ",o(t.to,"LLL dd, y")]}):o(t.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(M,{className:"w-auto p-0",align:"start",children:e.jsx(P,{autoFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:a,numberOfMonths:2})})]})})}const je=({items:d,movements:t})=>{i.useEffect(()=>{t&&console.log("movements: ",t)},[t]);const[a,v]=i.useState({category:"All",stockStatus:"All"}),[m,C]=i.useState(),D=["All",...Array.from(new Set(d.map(s=>s.category.name)))],h=d.filter(s=>{var r;if(a.category&&a.category!=="All"&&s.category.id!==a.category)return!1;if(a.stockStatus){const l=((r=s.stock[0])==null?void 0:r.stocks)<=5,c=s.stocks_movement[0].expiry_date&&new Date(s.stocks_movement[0].expiry_date).getTime()-new Date().getTime()<30*24*60*60*1e3;if(a.stockStatus==="Low"&&!l||a.stockStatus==="Expiring"&&!c||a.stockStatus==="Normal"&&(l||c))return!1}return!0}),_=()=>{console.log("Generating report with filters:",a,m),alert("Report generated! In a real application, this would download a PDF or CSV file.")};return e.jsxs(L,{className:"w-full",children:[e.jsx(T,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Inventory Reports"]})}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Category"}),e.jsxs(N,{children:[e.jsx(g,{children:e.jsx(y,{placeholder:"Select category"})}),e.jsx(k,{children:D.map(s=>e.jsx(n,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Stock Status"}),e.jsxs(N,{value:a.stockStatus,onValueChange:s=>v({...a,stockStatus:s}),children:[e.jsx(g,{children:e.jsx(y,{placeholder:"Select status"})}),e.jsxs(k,{children:[e.jsx(n,{value:"All",children:"All Items"}),e.jsx(n,{value:"Low",children:"Low Stock"}),e.jsx(n,{value:"Expiring",children:"Expiring Soon"}),e.jsx(n,{value:"Normal",children:"Normal"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Date Range"}),e.jsx(q,{selected:m,onSelect:C})]})]}),e.jsxs(B,{defaultValue:"inventory",children:[e.jsxs(G,{className:"grid w-full md:grid-cols-2 grid-cols-1",children:[e.jsx(w,{value:"inventory",children:"Inventory Status"}),e.jsx(w,{value:"movements",children:"Stock Movements"})]}),e.jsx(b,{value:"inventory",className:"pt-4",children:e.jsx("div",{className:"border rounded-md overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2",children:"Item Name"}),e.jsx("th",{className:"text-left p-2",children:"Category"}),e.jsx("th",{className:"text-left p-2",children:"Quantity"}),e.jsx("th",{className:"text-left p-2",children:"Status"}),e.jsx("th",{className:"text-left p-2",children:"Expiration"})]})}),e.jsx("tbody",{children:h.length>0?h.map(s=>{var c,p,j,f,u;const r=((c=s.stock[0])==null?void 0:c.stocks)<=5,l=s.stocks_movement[0].expiry_date&&new Date(s.stocks_movement[0].expiry_date).getTime()-new Date().getTime()<30*24*60*60*1e3;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:s.stocks_movement[0].inventory_name}),e.jsx("td",{className:"p-2",children:s.category.name}),e.jsxs("td",{className:"p-2",children:[s.stock[0].stocks??0," ",(p=s==null?void 0:s.stock[0])==null?void 0:p.stockname,"s"]}),e.jsxs("td",{className:"p-2",children:[r&&e.jsx("span",{className:"text-red-600 font-medium",children:"Low Stock"}),l&&e.jsxs("span",{className:"text-amber-600 font-medium",children:[r?", ":"","Expiring Soon"]}),!r&&!l&&e.jsx("span",{className:"text-green-600 font-medium",children:"Normal"})]}),e.jsx("td",{className:"p-2",children:s.stocks_movement[0].expiry_date?o(new Date((u=(f=s==null?void 0:s.stocks_movement)==null?void 0:f[((j=s==null?void 0:s.stocks_movement)==null?void 0:j.length)-1])==null?void 0:u.expiry_date),"MMM dd, yyyy"):"N/A"})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No items match the selected filters"})})})]})})}),e.jsx(b,{value:"movements",className:"pt-4",children:e.jsx("div",{className:"border rounded-md overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2",children:"Date"}),e.jsx("th",{className:"text-left p-2",children:"Item"}),e.jsx("th",{className:"text-left p-2",children:"Type"}),e.jsx("th",{className:"text-left p-2",children:"Quantity"}),e.jsx("th",{className:"text-left p-2",children:"Reason"}),e.jsx("th",{className:"text-left p-2",children:"Staff"})]})}),e.jsx("tbody",{children:t.length>0?t.map(s=>{var r;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:o(new Date(s.created_at),"MMM dd, yyyy")}),e.jsx("td",{className:"p-2",children:(s==null?void 0:s.inventory_name)||"Unknown Item"}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`font-medium ${s.type==="Incoming"?"text-green-600":"text-red-600"}`,children:s.type==="Incoming"?"Incoming":"Outgoing"})}),e.jsxs("td",{className:"p-2",children:[s.quantity," ",(r=s==null?void 0:s.stocks)==null?void 0:r.stockname]}),e.jsx("td",{className:"p-2",children:(s==null?void 0:s.reason)??"(No reason)"}),e.jsxs("td",{className:"p-2",children:[s.staff.firstname," ",s.staff.lastname]})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-4 text-center text-muted-foreground",children:"No movements match the selected filters"})})})]})})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsxs(x,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"View Analytics"]}),e.jsxs(x,{onClick:_,className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Generate Report"]})]})]})})]})};export{je as default};
