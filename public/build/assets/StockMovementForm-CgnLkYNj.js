import{r as i,j as r,e as re,P as oe,q as te,b as se}from"./app-9IFjvyjq.js";import{D as ne,a as ae,b as ce,c as ie,d as le}from"./dialog-BlSttdnZ.js";import{B as A}from"./button-BWLYpXz0.js";import{I as C}from"./input-fLU5VnAr.js";import{L as b}from"./label-C2QZitaL.js";import{a as de}from"./react-icons.esm-CBUbwQJY.js";import{P as N}from"./index-DMLVHKle.js";import{c as q,R as ue,I as pe}from"./index-B9uMoLSe.js";import{u as me}from"./index-Bhu2lbiL.js";import{P as fe}from"./index-iJsz53jB.js";import{c as F}from"./utils-Dqxj4mrw.js";import{T as xe}from"./textarea-COBWyWer.js";import{P as ge}from"./PrintErrors-XsOiaV-u.js";import{T as k}from"./trending-up-_LM6MF-k.js";import{m as he}from"./proxy-D62Q3uN7.js";import{P as ye}from"./package-CHcp06gv.js";import{T as ve}from"./trending-down-Df83Rv-z.js";import{C as be}from"./calendar-DQr9f7aC.js";import{H as je}from"./hash-C86GkOge.js";import{F as Ne}from"./file-text-2oyp6bUV.js";import{U as Re}from"./user-D9cpmg_I.js";import"./index-ZSsit5F4.js";import"./Combination-BD7y2hDp.js";import"./index-C6jRhQFj.js";import"./index-5FqUdhJW.js";import"./createLucideIcon-DsPw26Nq.js";function w(o,n,{checkForDefaultPrevented:e=!0}={}){return function(t){if(o==null||o(t),e===!1||!t.defaultPrevented)return n==null?void 0:n(t)}}function G(o,n){if(typeof o=="function")return o(n);o!=null&&(o.current=n)}function Ce(...o){return n=>{let e=!1;const l=o.map(t=>{const s=G(t,n);return!e&&typeof s=="function"&&(e=!0),s});if(e)return()=>{for(let t=0;t<l.length;t++){const s=l[t];typeof s=="function"?s():G(o[t],null)}}}}function P(...o){return i.useCallback(Ce(...o),o)}function M(o,n=[]){let e=[];function l(s,a){const c=i.createContext(a),u=e.length;e=[...e,a];const x=d=>{var v;const{scope:m,children:f,...h}=d,y=((v=m==null?void 0:m[o])==null?void 0:v[u])||c,p=i.useMemo(()=>h,Object.values(h));return r.jsx(y.Provider,{value:p,children:f})};x.displayName=s+"Provider";function g(d,m){var y;const f=((y=m==null?void 0:m[o])==null?void 0:y[u])||c,h=i.useContext(f);if(h)return h;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[x,g]}const t=()=>{const s=e.map(a=>i.createContext(a));return function(c){const u=(c==null?void 0:c[o])||s;return i.useMemo(()=>({[`__scope${o}`]:{...c,[o]:u}}),[c,u])}};return t.scopeName=o,[l,ke(t,...n)]}function ke(...o){const n=o[0];if(o.length===1)return n;const e=()=>{const l=o.map(t=>({useScope:t(),scopeName:t.scopeName}));return function(s){const a=l.reduce((c,{useScope:u,scopeName:x})=>{const d=u(s)[`__scope${x}`];return{...c,...d}},{});return i.useMemo(()=>({[`__scope${n.scopeName}`]:a}),[a])}};return e.scopeName=n.scopeName,e}var T=globalThis!=null&&globalThis.document?i.useLayoutEffect:()=>{},we=re[" useInsertionEffect ".trim().toString()]||T;function Se({prop:o,defaultProp:n,onChange:e=()=>{},caller:l}){const[t,s,a]=Pe({defaultProp:n,onChange:e}),c=o!==void 0,u=c?o:t;{const g=i.useRef(o!==void 0);i.useEffect(()=>{const d=g.current;d!==c&&console.warn(`${l} is changing from ${d?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=c},[c,l])}const x=i.useCallback(g=>{var d;if(c){const m=_e(g)?g(o):g;m!==o&&((d=a.current)==null||d.call(a,m))}else s(g)},[c,o,s,a]);return[u,x]}function Pe({defaultProp:o,onChange:n}){const[e,l]=i.useState(o),t=i.useRef(e),s=i.useRef(n);return we(()=>{s.current=n},[n]),i.useEffect(()=>{var a;t.current!==e&&((a=s.current)==null||a.call(s,e),t.current=e)},[e,t]),[e,l,s]}function _e(o){return typeof o=="function"}var Ie=i.createContext(void 0);function Ee(o){const n=i.useContext(Ie);return o||n||"ltr"}function De(o){const[n,e]=i.useState(void 0);return T(()=>{if(o){e({width:o.offsetWidth,height:o.offsetHeight});const l=new ResizeObserver(t=>{if(!Array.isArray(t)||!t.length)return;const s=t[0];let a,c;if("borderBoxSize"in s){const u=s.borderBoxSize,x=Array.isArray(u)?u[0]:u;a=x.inlineSize,c=x.blockSize}else a=o.offsetWidth,c=o.offsetHeight;e({width:a,height:c})});return l.observe(o,{box:"border-box"}),()=>l.unobserve(o)}else e(void 0)},[o]),n}var _="Radio",[Oe,B]=M(_),[Ae,Ge]=Oe(_),z=i.forwardRef((o,n)=>{const{__scopeRadio:e,name:l,checked:t=!1,required:s,disabled:a,value:c="on",onCheck:u,form:x,...g}=o,[d,m]=i.useState(null),f=P(n,p=>m(p)),h=i.useRef(!1),y=d?x||!!d.closest("form"):!0;return r.jsxs(Ae,{scope:e,checked:t,disabled:a,children:[r.jsx(N.button,{type:"button",role:"radio","aria-checked":t,"data-state":V(t),"data-disabled":a?"":void 0,disabled:a,value:c,...g,ref:f,onClick:w(o.onClick,p=>{t||u==null||u(),y&&(h.current=p.isPropagationStopped(),h.current||p.stopPropagation())})}),y&&r.jsx(U,{control:d,bubbles:!h.current,name:l,value:c,checked:t,required:s,disabled:a,form:x,style:{transform:"translateX(-100%)"}})]})});z.displayName=_;var L="RadioIndicator",$=i.forwardRef((o,n)=>{const{__scopeRadio:e,forceMount:l,...t}=o,s=Ge(L,e);return r.jsx(fe,{present:l||s.checked,children:r.jsx(N.span,{"data-state":V(s.checked),"data-disabled":s.disabled?"":void 0,...t,ref:n})})});$.displayName=L;var qe="RadioBubbleInput",U=i.forwardRef(({__scopeRadio:o,control:n,checked:e,bubbles:l=!0,...t},s)=>{const a=i.useRef(null),c=P(a,s),u=me(e),x=De(n);return i.useEffect(()=>{const g=a.current;if(!g)return;const d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"checked").set;if(u!==e&&f){const h=new Event("click",{bubbles:l});f.call(g,e),g.dispatchEvent(h)}},[u,e,l]),r.jsx(N.input,{type:"radio","aria-hidden":!0,defaultChecked:e,...t,tabIndex:-1,ref:c,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});U.displayName=qe;function V(o){return o?"checked":"unchecked"}var Fe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],R="RadioGroup",[Me,xr]=M(R,[q,B]),K=q(),W=B(),[Te,Be]=Me(R),Q=i.forwardRef((o,n)=>{const{__scopeRadioGroup:e,name:l,defaultValue:t,value:s,required:a=!1,disabled:c=!1,orientation:u,dir:x,loop:g=!0,onValueChange:d,...m}=o,f=K(e),h=Ee(x),[y,p]=Se({prop:s,defaultProp:t??null,onChange:d,caller:R});return r.jsx(Te,{scope:e,name:l,required:a,disabled:c,value:y,onValueChange:p,children:r.jsx(ue,{asChild:!0,...f,orientation:u,dir:h,loop:g,children:r.jsx(N.div,{role:"radiogroup","aria-required":a,"aria-orientation":u,"data-disabled":c?"":void 0,dir:h,...m,ref:n})})})});Q.displayName=R;var X="RadioGroupItem",Y=i.forwardRef((o,n)=>{const{__scopeRadioGroup:e,disabled:l,...t}=o,s=Be(X,e),a=s.disabled||l,c=K(e),u=W(e),x=i.useRef(null),g=P(n,x),d=s.value===t.value,m=i.useRef(!1);return i.useEffect(()=>{const f=y=>{Fe.includes(y.key)&&(m.current=!0)},h=()=>m.current=!1;return document.addEventListener("keydown",f),document.addEventListener("keyup",h),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",h)}},[]),r.jsx(pe,{asChild:!0,...c,focusable:!a,active:d,children:r.jsx(z,{disabled:a,required:s.required,checked:d,...u,...t,name:s.name,ref:g,onCheck:()=>s.onValueChange(t.value),onKeyDown:w(f=>{f.key==="Enter"&&f.preventDefault()}),onFocus:w(t.onFocus,()=>{var f;m.current&&((f=x.current)==null||f.click())})})})});Y.displayName=X;var ze="RadioGroupIndicator",H=i.forwardRef((o,n)=>{const{__scopeRadioGroup:e,...l}=o,t=W(e);return r.jsx($,{...t,...l,ref:n})});H.displayName=ze;var J=Q,Z=Y,Le=H;const ee=i.forwardRef(({className:o,...n},e)=>r.jsx(J,{className:F("grid gap-2",o),...n,ref:e}));ee.displayName=J.displayName;const S=i.forwardRef(({className:o,...n},e)=>r.jsx(Z,{ref:e,className:F("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",o),...n,children:r.jsx(Le,{className:"flex items-center justify-center",children:r.jsx(de,{className:"h-3.5 w-3.5 fill-primary"})})}));S.displayName=Z.displayName;const gr=({open:o,onClose:n,item:e,onSave:l})=>{var m,f,h,y;const{data:t,setData:s,processing:a,errors:c,put:u}=oe({type:"",batchNumber:"",quantity:"",reason:"",expiry:""});i.useEffect(()=>{var p,v,j,I,E,D,O;e&&(s({type:(p=e==null?void 0:e.stocks_movement[0])==null?void 0:p.type,quantity:0,reason:(v=e==null?void 0:e.stocks_movement[0])==null?void 0:v.reason,expiry:(E=(I=e==null?void 0:e.stocks_movement)==null?void 0:I[((j=e==null?void 0:e.stocks_movement)==null?void 0:j.length)-1])==null?void 0:E.expiry_date,batchNumber:((D=e==null?void 0:e.stocks_movement[0])==null?void 0:D.batch_number)||""}),console.log("item:",e,(O=e==null?void 0:e.stocks_movement[0])==null?void 0:O.type))},[e]);const x=p=>{s(p.target.name,p.target.value)},g=p=>{var v,j;if(p.preventDefault(),t.type==="Outgoing"&&parseInt(t.quantity)>((v=e==null?void 0:e.stock[0])==null?void 0:v.stocks)){alert("Cannot remove more items than current stock");return}u(route("admin.inventory.item.stockmovement.update",{movement:(j=e==null?void 0:e.stocks_movement[0])==null?void 0:j.id}),{onFinish:()=>{se.reload({only:["flash","inventory","movements_"]})},onSuccess:()=>{n()}})},{user:d}=te().props.auth;return r.jsx(ne,{open:o,onOpenChange:n,children:r.jsxs(ae,{className:"sm:max-w-[500px]",children:[r.jsx(ce,{className:"pb-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:r.jsx(k,{className:"h-5 w-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx(ie,{className:"text-xl font-semibold",children:"Record Stock Movement"}),r.jsx("p",{className:"text-sm mt-1 text-gray-600",children:"Update inventory stock levels"})]})]})}),r.jsx(ge,{errors:c}),r.jsxs(he.form,{onSubmit:g,className:"space-y-6 pt-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[r.jsxs("div",{className:"rounded-lg p-4 bg-gray-50",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(ye,{className:"h-5 w-5 text-gray-600"}),r.jsx(b,{className:"text-sm font-medium text-gray-700",children:"Item Details"})]}),r.jsx("p",{className:"font-semibold text-gray-900",children:e==null?void 0:e.name}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Current stock: ",r.jsxs("span",{className:"font-medium text-gray-900",children:[(m=e==null?void 0:e.stock[0])==null?void 0:m.stocks," ",(f=e==null?void 0:e.stock[0])==null?void 0:f.stockname,"s"]})]})]}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs(b,{className:"text-sm font-medium flex items-center gap-2 text-gray-700",children:[r.jsx(k,{className:"h-4 w-4 text-gray-500"}),"Movement Type"]}),r.jsxs(ee,{value:t.type,onValueChange:p=>s("type",p),className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg transition-colors border-gray-200 hover:bg-green-50 hover:border-green-300",children:[r.jsx(S,{value:"Incoming",id:"Incoming"}),r.jsxs(b,{htmlFor:"Incoming",className:"flex items-center gap-2 cursor-pointer",children:[r.jsx(k,{className:"h-4 w-4 text-green-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Incoming"})]})]}),r.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg transition-colors border-gray-200 hover:bg-red-50 hover:border-red-300",children:[r.jsx(S,{value:"Outgoing",id:"Outgoing"}),r.jsxs(b,{htmlFor:"Outgoing",className:"flex items-center gap-2 cursor-pointer",children:[r.jsx(ve,{className:"h-4 w-4 text-red-600"}),r.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Outgoing"})]})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(b,{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[r.jsx(be,{className:"h-4 w-4 text-gray-500"}),"Expiry Date"]}),r.jsx(C,{id:"expirationDate",type:"date",name:"expirydate",value:t.expiry,onChange:p=>s("expiry",p.target.value),className:"h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]})]})}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(b,{htmlFor:"quantity",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[r.jsx(je,{className:"h-4 w-4 text-gray-500"}),"Quantity"]}),r.jsx(C,{id:"quantity",type:"number",min:"1",max:t.type==="Outgoing"?(h=e==null?void 0:e.stock[0])==null?void 0:h.stocks:void 0,name:"quantity",value:t.quantity,onChange:x,placeholder:"Enter quantity",className:"h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),t.type==="Outgoing"&&r.jsxs("p",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded-md",children:["Maximum quantity that can be removed: ",(y=e==null?void 0:e.stock[0])==null?void 0:y.stocks]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(b,{htmlFor:"reason",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[r.jsx(Ne,{className:"h-4 w-4 text-gray-500"}),"Reason ",t.type==="Outgoing"&&"(Required)"]}),r.jsx(xe,{id:"reason",name:"reason",value:t.reason,onChange:x,placeholder:t.type==="Incoming"?"Optional - Enter reason for adding stock":"Why is this item being removed from inventory?",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:t.type==="Outgoing"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(b,{htmlFor:"performedBy",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[r.jsx(Re,{className:"h-4 w-4 text-gray-500"}),"Performed By"]}),r.jsx(C,{id:"performedBy",value:`${d==null?void 0:d.firstname} ${d==null?void 0:d.lastname}`,className:"h-11 border-gray-300 bg-gray-50",disabled:!0})]}),r.jsx(le,{className:"pt-6 border-t border-gray-100",children:r.jsxs("div",{className:"flex gap-3 w-full",children:[r.jsx(A,{type:"button",variant:"outline",onClick:n,className:"flex-1 h-11 border-gray-300 hover:bg-gray-50",children:"Cancel"}),r.jsx(A,{type:"submit",className:"flex-1 h-11 text-white",style:{backgroundColor:"#2C3E50"},onMouseEnter:p=>p.target.style.backgroundColor="#34495E",onMouseLeave:p=>p.target.style.backgroundColor="#2C3E50",disabled:a,children:a?"Saving...":"Save Changes"})]})})]})]})})};export{gr as default};
