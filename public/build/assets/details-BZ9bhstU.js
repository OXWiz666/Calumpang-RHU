import{u as R,r as u,j as e}from"./app-Ci6FsPEI.js";import{r as m}from"./vendor-DkBadjUr.js";import{B as l}from"./button-CNgURIMK.js";import"./input-CCqrrlXQ.js";import{C as i,a as d,b as n,c as a,e as S}from"./card-aZhT47Dl.js";import{B as x}from"./badge-B0i2gCu5.js";import"./select-Bs3uVyOJ.js";import"./moment-C5S46NFB.js";import{T as B,a as I,b as f,c as p}from"./tabs-Bse0qkPJ.js";import H from"./edit-patient-form-DiAYtauU.js";import V from"./add-medical-record-form-DrQWGrKk.js";import"./label-Bsu9V-2p.js";import"./textarea-CmmM-UAe.js";import q from"./AddPrescriptionForm-CwL1C4zB.js";import{A as U}from"./AdminLayout-DvrTmQBr.js";import{m as z}from"./proxy-bGmOedB6.js";import{A as G}from"./arrow-left-DcYYnBRL.js";import{P as y}from"./plus-MavOGQlj.js";import{S as _}from"./square-pen-Bb1JtfBr.js";import{P as O}from"./phone-BScbSfjU.js";import{M as Y}from"./mail-BoTx8fKY.js";import{M as $}from"./map-pin-Dkn0BYKY.js";import{H as K}from"./heart-CDAohmX9.js";import{C as M}from"./calendar-D9APQM2e.js";import{P as Q}from"./pill-DIGxtF-3.js";import{T as J}from"./triangle-alert-BslwqqvL.js";import"./pusher-DVtoYAOu.js";import"./index-BpVWxWkG.js";import"./react-icons.esm-Cg1Z9ZGK.js";import"./index-B6i_t9H1.js";import"./index-D0_reY7q.js";import"./index-BYyo8n0W.js";import"./tslib.es6-M_FJ09fS.js";import"./index-DbZPFhJ9.js";import"./index-CuaviD7G.js";import"./index-DqxisvwK.js";import"./index-MVKj6Ku2.js";import"./index-D4ivUix3.js";import"./index-PUx0SOs8.js";import"./dialog-NMjAdLkI.js";import"./x-b8JahagL.js";import"./createLucideIcon-BKWaAi2G.js";import"./save-CAdd64LS.js";import"./PrintErrors-D486I6sd.js";import"./file-text-YZXa1D2L.js";import"./refresh-cw-D3hZ7e_O.js";import"./trash-2-DJ5zXW8D.js";import"./printer-CfgcPaUh.js";import"./avatar-CDwiAaCj.js";import"./separator-XmNd4rCi.js";import"./calendar-C_O0gbX6.js";import"./format-Dp3w_Y3x.js";import"./isBefore-COsor6RJ.js";import"./isSameMonth-BOwz-_mK.js";import"./TextInput-ZPi1BB0P.js";import"./settings-D_MeB5oN.js";import"./house-CSq-WFst.js";import"./users-D4PhO1-D.js";import"./pusher-AxtNKRPu.js";import"./package-L7rgkkVO.js";import"./circle-check-big-BQVCuGNJ.js";import"./bell-HhCf5F9O.js";import"./index-BAO1aZYw.js";import"./autoprefixer-uFe7yxdA.js";import"./unit-CopbpOEH.js";import"./Toaster-DfG7JimY.js";import"./toast-CfLCVPii.js";import"./layers-OK8ayVTK.js";import"./chart-column-yMaSKbSU.js";function ps({patients_:W,doctors:h,patient:s,medicines:g,isAdminView:N=!1}){const[E,v]=m.useState(!1),[F,b]=m.useState(!1),[T,j]=m.useState(!1);console.log("PatientRecords props:",{patient:s,medicines:g,doctors:h});const L=r=>{const t=new Date,o=new Date(r);let C=t.getFullYear()-o.getFullYear();const A=t.getMonth()-o.getMonth();return(A<0||A===0&&t.getDate()<o.getDate())&&C--,C},{data:c,setData:w,post:D,processing:X,recentlySuccessful:Z,errors:P,clearErrors:ee,reset:se}=R({});m.useEffect(()=>{c&&Object.keys(c).length>0&&(c.medicines&&c.doctor_id?D(route("patients.prescription.store",{patientid:s?.id}),{onSuccess:()=>{j(!1)},onFinish:()=>{u.reload({only:["patient","doctors","medicines","flash"]})}}):D(route("patients.medicalrec.store",{patientid:s?.id}),{onSuccess:()=>{b(!1)},onFinish:()=>{u.reload({only:["patients_","doctors","flash"]})}}))},[c]),m.useEffect(()=>{if(window.Echo)return window.Echo.channel("inventory-updates").listen("InventoryUpdated",r=>{console.log("Inventory updated, refreshing patient data...",r),u.reload({only:["patient","medicines"]})}),()=>{window.Echo.leaveChannel("inventory-updates")}},[]);const k=()=>E?e.jsx(H,{patient:s,onSubmit:r=>{onUpdate(r),v(!1)},onCancel:()=>v(!1)}):F?e.jsx(V,{patientName:`${s.firstname} ${s.lastname}`,onSubmit:r=>w(r),onCancel:()=>b(!1),doctors:h,errors:P}):T&&!N?(console.log("Passing props to AddPrescriptionForm:",{patient:s,doctors:h,medicines:g}),e.jsx(q,{patient:s,doctors:h,medicines:g,onSubmit:r=>w(r),onCancel:()=>j(!1),errors:P})):e.jsx("div",{className:"bg-gray-50",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(l,{variant:"outline",onClick:r=>{u.visit(route("patients.index"))},children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Back to List"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:[s.firstName," ",s.lastName]}),e.jsxs("p",{className:"text-muted-foreground",children:["Patient ID: ",s.id," • Age:"," ",L(s.birth)," • Name:"," ",s?.firstname," ",s?.lastname]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:()=>b(!0),children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add Medical Record"]}),e.jsxs(l,{variant:"outline",onClick:()=>v(!0),children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Edit Patient"]})]})]}),e.jsxs(B,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(I,{children:[e.jsx(f,{value:"overview",children:"Overview"}),e.jsx(f,{value:"medical-history",children:"Medical Records"}),!N&&e.jsx(f,{value:"prescriptions",children:"Prescriptions"}),e.jsx(f,{value:"medications",children:"Medications & Allergies"})]}),e.jsxs(p,{value:"overview",className:"space-y-6",children:[e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(n,{children:"Basic Information"})}),e.jsxs(a,{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsxs("p",{className:"text-lg",children:[s.firstname," ",s.lastname]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date of Birth"}),e.jsx("p",{children:new Date(s.birth).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),e.jsx("p",{children:s.gender=="M"?"Male":s.gender=="F"?"Female":""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mr-2",children:"Status"}),e.jsx(x,{variant:s.status==="active"?"default":"secondary",children:s.status})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{children:s.contactno})]})]}),s.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{children:s.email})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground mt-1"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Address"}),e.jsx("p",{children:s.address??"Not Set"})]})]}),s.bloodtype&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Blood Type"}),e.jsx("p",{children:s.bloodtype})]})]})]})]})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(n,{children:"Emergency Contact"})}),e.jsx(a,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Contact Person"}),s?.emercont?.map(r=>e.jsx("p",{children:r.name}))]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone Number"}),s?.emercont?.map(r=>e.jsx("p",{children:r.contactno}))]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-center font-medium text-muted-foreground",children:"Action"}),s?.emercont?.map(r=>e.jsxs("p",{children:[e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(_,{className:"h-4 w-4 text-primary"})}),e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(Trash2,{className:"h-4 w-4 text-red-500"})})]},r?.id))]})]})})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(n,{children:"Visit Information"})}),e.jsx(a,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Registration Date"}),e.jsx("p",{children:new Date(s.created_at).toLocaleDateString()})]})]}),s.lastVisit&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Visit"}),e.jsx("p",{children:new Date(s.lastVisit).toLocaleDateString()})]})]})]})})]})]}),e.jsx(p,{value:"medical-history",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(d,{children:[e.jsx(n,{children:"Medical History"}),e.jsx(S,{children:"Complete medical record history for this patient"})]}),e.jsx(a,{children:s.medical_histories&&s.medical_histories.length>0?e.jsx("div",{className:"space-y-4",children:s.medical_histories.map(r=>e.jsx(i,{children:e.jsx(a,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),e.jsx("p",{children:new Date(r.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Doctor"}),e.jsxs("p",{children:[r?.doctor?.user?.firstname," ",r?.doctor?.user?.lastname]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Diagnosis"}),e.jsx("p",{children:r.diagnosis})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Treatment"}),e.jsx("p",{children:r.treatment})]}),r.clinic_notes&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),e.jsx("p",{children:r.clinic_notes})]}),r.followUp&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Follow-up"}),e.jsx("p",{children:r.followup_inst})]})]})})},r.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No medical records found for this patient."})})]})}),!N&&e.jsx(p,{value:"prescriptions",className:"space-y-6",children:e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Prescriptions"}),e.jsx(S,{children:"Prescription history and management for this patient"})]}),e.jsxs(l,{onClick:()=>j(!0),children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add Prescription"]})]})}),e.jsx(a,{children:s.prescriptions&&s.prescriptions.length>0?e.jsx("div",{className:"space-y-4",children:s.prescriptions.map(r=>e.jsx(i,{children:e.jsxs(a,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:r.prescription_number}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(r.prescription_date).toLocaleDateString()})]}),e.jsx(x,{variant:r.status==="pending"?"warning":r.status==="dispensed"?"success":"secondary",children:r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Doctor"}),e.jsx("p",{children:r.doctor_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Case ID"}),e.jsx("p",{children:r.case_id||"N/A"})]})]}),r.medicines&&r.medicines.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Medicines"}),e.jsx("div",{className:"space-y-2",children:r.medicines.map((t,o)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.medicine_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.dosage," - ",t.frequency," - ",t.duration]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Qty: ",t.quantity]}),t.is_dispensed&&e.jsx(x,{variant:"success",className:"text-xs",children:"Dispensed"})]})]},o))})]}),r.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),e.jsx("p",{className:"text-sm",children:r.notes})]})]})},r.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No prescriptions found for this patient."}),e.jsxs(l,{onClick:()=>j(!0),children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Add First Prescription"]})]})})]})}),e.jsx(p,{value:"medications",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Current Medications"]})}),e.jsx(a,{children:s.medications&&s.medications.length>0?e.jsx("div",{className:"space-y-2",children:s.medications.map((r,t)=>e.jsx(x,{variant:"outline",className:"mr-2 mb-2",children:r},t))}):e.jsx("p",{className:"text-muted-foreground",children:"No current medications recorded."})})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Known Allergies"]})}),e.jsx(a,{children:s.allergies&&s.allergies.length>0?e.jsx("div",{className:"space-y-2",children:s.allergies.map((r,t)=>e.jsx(x,{variant:"destructive",className:"mr-2 mb-2",children:r},t))}):e.jsx("p",{className:"text-muted-foreground",children:"No known allergies recorded."})})]})]})})]})]})});return e.jsx(U,{header:"Patients",children:e.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsx(k,{})})})}export{ps as default};
