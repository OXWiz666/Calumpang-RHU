import{r as c,j as e,d as Q,P as X,q as Y,b as J}from"./app-B9imbgwF.js";import{D as Z,a as ee,b as te,c as oe,d as re}from"./dialog-DPtsGNkJ.js";import{B as E}from"./button-Cp6C2OJZ.js";import{I as N}from"./input-DrzP4N1f.js";import{L as y}from"./label-1pz5fh5X.js";import{P as b,b as se}from"./index-CPfQda0F.js";import{c as _,R as ne,I as ae}from"./index-BbMT55hN.js";import{u as ce}from"./index-Dm9R2YI4.js";import{P as ie}from"./index-DXqKCwml.js";import{c as I}from"./utils-D5ZoOHm5.js";import{T as le}from"./textarea-D1CoOFw3.js";import{P as de}from"./PrintErrors-DllpYu9O.js";import{T as R}from"./trending-up-5T0PZmzE.js";import{m as ue}from"./proxy-YO7Y0R0s.js";import{P as me}from"./package-mXWpMwaL.js";import{T as pe}from"./trending-down-CpWCxYsu.js";import{C as fe}from"./calendar-BRhaHUHQ.js";import{H as xe}from"./hash-wGhHJ59p.js";import{F as ge}from"./file-text-DMqEqKtg.js";import{U as he}from"./user-Jl4VUyJc.js";import"./Combination-BvFtu0HL.js";import"./index-CPs_XpmV.js";import"./createLucideIcon-CiaC_9KA.js";function C(t,n,{checkForDefaultPrevented:o=!0}={}){return function(r){if(t?.(r),o===!1||!r.defaultPrevented)return n?.(r)}}function P(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function ve(...t){return n=>{let o=!1;const l=t.map(r=>{const s=P(r,n);return!o&&typeof s=="function"&&(o=!0),s});if(o)return()=>{for(let r=0;r<l.length;r++){const s=l[r];typeof s=="function"?s():P(t[r],null)}}}}function w(...t){return c.useCallback(ve(...t),t)}function D(t,n=[]){let o=[];function l(s,a){const i=c.createContext(a),u=o.length;o=[...o,a];const p=m=>{const{scope:d,children:x,...g}=m,h=d?.[t]?.[u]||i,v=c.useMemo(()=>g,Object.values(g));return e.jsx(h.Provider,{value:v,children:x})};p.displayName=s+"Provider";function f(m,d){const x=d?.[t]?.[u]||i,g=c.useContext(x);if(g)return g;if(a!==void 0)return a;throw new Error(`\`${m}\` must be used within \`${s}\``)}return[p,f]}const r=()=>{const s=o.map(a=>c.createContext(a));return function(i){const u=i?.[t]||s;return c.useMemo(()=>({[`__scope${t}`]:{...i,[t]:u}}),[i,u])}};return r.scopeName=t,[l,ye(r,...n)]}function ye(...t){const n=t[0];if(t.length===1)return n;const o=()=>{const l=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const a=l.reduce((i,{useScope:u,scopeName:p})=>{const m=u(s)[`__scope${p}`];return{...i,...m}},{});return c.useMemo(()=>({[`__scope${n.scopeName}`]:a}),[a])}};return o.scopeName=n.scopeName,o}var O=globalThis?.document?c.useLayoutEffect:()=>{},be=Q[" useInsertionEffect ".trim().toString()]||O;function je({prop:t,defaultProp:n,onChange:o=()=>{},caller:l}){const[r,s,a]=Ne({defaultProp:n,onChange:o}),i=t!==void 0,u=i?t:r;{const f=c.useRef(t!==void 0);c.useEffect(()=>{const m=f.current;m!==i&&console.warn(`${l} is changing from ${m?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=i},[i,l])}const p=c.useCallback(f=>{if(i){const m=Re(f)?f(t):f;m!==t&&a.current?.(m)}else s(f)},[i,t,s,a]);return[u,p]}function Ne({defaultProp:t,onChange:n}){const[o,l]=c.useState(t),r=c.useRef(o),s=c.useRef(n);return be(()=>{s.current=n},[n]),c.useEffect(()=>{r.current!==o&&(s.current?.(o),r.current=o)},[o,r]),[o,l,s]}function Re(t){return typeof t=="function"}var Ce=c.createContext(void 0);function ke(t){const n=c.useContext(Ce);return t||n||"ltr"}function we(t){const[n,o]=c.useState(void 0);return O(()=>{if(t){o({width:t.offsetWidth,height:t.offsetHeight});const l=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const s=r[0];let a,i;if("borderBoxSize"in s){const u=s.borderBoxSize,p=Array.isArray(u)?u[0]:u;a=p.inlineSize,i=p.blockSize}else a=t.offsetWidth,i=t.offsetHeight;o({width:a,height:i})});return l.observe(t,{box:"border-box"}),()=>l.unobserve(t)}else o(void 0)},[t]),n}var S="Radio",[Se,A]=D(S),[Ee,Pe]=Se(S),G=c.forwardRef((t,n)=>{const{__scopeRadio:o,name:l,checked:r=!1,required:s,disabled:a,value:i="on",onCheck:u,form:p,...f}=t,[m,d]=c.useState(null),x=w(n,v=>d(v)),g=c.useRef(!1),h=m?p||!!m.closest("form"):!0;return e.jsxs(Ee,{scope:o,checked:r,disabled:a,children:[e.jsx(b.button,{type:"button",role:"radio","aria-checked":r,"data-state":T(r),"data-disabled":a?"":void 0,disabled:a,value:i,...f,ref:x,onClick:C(t.onClick,v=>{r||u?.(),h&&(g.current=v.isPropagationStopped(),g.current||v.stopPropagation())})}),h&&e.jsx(M,{control:m,bubbles:!g.current,name:l,value:i,checked:r,required:s,disabled:a,form:p,style:{transform:"translateX(-100%)"}})]})});G.displayName=S;var q="RadioIndicator",F=c.forwardRef((t,n)=>{const{__scopeRadio:o,forceMount:l,...r}=t,s=Pe(q,o);return e.jsx(ie,{present:l||s.checked,children:e.jsx(b.span,{"data-state":T(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:n})})});F.displayName=q;var _e="RadioBubbleInput",M=c.forwardRef(({__scopeRadio:t,control:n,checked:o,bubbles:l=!0,...r},s)=>{const a=c.useRef(null),i=w(a,s),u=ce(o),p=we(n);return c.useEffect(()=>{const f=a.current;if(!f)return;const m=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(m,"checked").set;if(u!==o&&x){const g=new Event("click",{bubbles:l});x.call(f,o),f.dispatchEvent(g)}},[u,o,l]),e.jsx(b.input,{type:"radio","aria-hidden":!0,defaultChecked:o,...r,tabIndex:-1,ref:i,style:{...r.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});M.displayName=_e;function T(t){return t?"checked":"unchecked"}var Ie=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],j="RadioGroup",[De,at]=D(j,[_,A]),B=_(),z=A(),[Oe,Ae]=De(j),L=c.forwardRef((t,n)=>{const{__scopeRadioGroup:o,name:l,defaultValue:r,value:s,required:a=!1,disabled:i=!1,orientation:u,dir:p,loop:f=!0,onValueChange:m,...d}=t,x=B(o),g=ke(p),[h,v]=je({prop:s,defaultProp:r??null,onChange:m,caller:j});return e.jsx(Oe,{scope:o,name:l,required:a,disabled:i,value:h,onValueChange:v,children:e.jsx(ne,{asChild:!0,...x,orientation:u,dir:g,loop:f,children:e.jsx(b.div,{role:"radiogroup","aria-required":a,"aria-orientation":u,"data-disabled":i?"":void 0,dir:g,...d,ref:n})})})});L.displayName=j;var $="RadioGroupItem",U=c.forwardRef((t,n)=>{const{__scopeRadioGroup:o,disabled:l,...r}=t,s=Ae($,o),a=s.disabled||l,i=B(o),u=z(o),p=c.useRef(null),f=w(n,p),m=s.value===r.value,d=c.useRef(!1);return c.useEffect(()=>{const x=h=>{Ie.includes(h.key)&&(d.current=!0)},g=()=>d.current=!1;return document.addEventListener("keydown",x),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",x),document.removeEventListener("keyup",g)}},[]),e.jsx(ae,{asChild:!0,...i,focusable:!a,active:m,children:e.jsx(G,{disabled:a,required:s.required,checked:m,...u,...r,name:s.name,ref:f,onCheck:()=>s.onValueChange(r.value),onKeyDown:C(x=>{x.key==="Enter"&&x.preventDefault()}),onFocus:C(r.onFocus,()=>{d.current&&p.current?.click()})})})});U.displayName=$;var Ge="RadioGroupIndicator",H=c.forwardRef((t,n)=>{const{__scopeRadioGroup:o,...l}=t,r=z(o);return e.jsx(F,{...r,...l,ref:n})});H.displayName=Ge;var V=L,K=U,qe=H;const W=c.forwardRef(({className:t,...n},o)=>e.jsx(V,{className:I("grid gap-2",t),...n,ref:o}));W.displayName=V.displayName;const k=c.forwardRef(({className:t,...n},o)=>e.jsx(K,{ref:o,className:I("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(qe,{className:"flex items-center justify-center",children:e.jsx(se,{className:"h-3.5 w-3.5 fill-primary"})})}));k.displayName=K.displayName;const ct=({open:t,onClose:n,item:o,onSave:l})=>{const{data:r,setData:s,processing:a,errors:i,put:u}=X({type:"",batchNumber:"",quantity:"",reason:"",expiry:""});c.useEffect(()=>{o&&(s({type:o?.stocks_movement[0]?.type,quantity:0,reason:o?.stocks_movement[0]?.reason,expiry:o?.stocks_movement?.[o?.stocks_movement?.length-1]?.expiry_date,batchNumber:o?.stocks_movement[0]?.batch_number||""}),console.log("item:",o,o?.stocks_movement[0]?.type))},[o]);const p=d=>{s(d.target.name,d.target.value)},f=d=>{if(d.preventDefault(),r.type==="Outgoing"&&parseInt(r.quantity)>o?.stock[0]?.stocks){alert("Cannot remove more items than current stock");return}u(route("admin.inventory.item.stockmovement.update",{movement:o?.stocks_movement[0]?.id}),{onFinish:()=>{J.reload({only:["flash","inventory","movements_"]})},onSuccess:()=>{n()}})},{user:m}=Y().props.auth;return e.jsx(Z,{open:t,onOpenChange:n,children:e.jsxs(ee,{className:"sm:max-w-[500px]",children:[e.jsx(te,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:e.jsx(R,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(oe,{className:"text-xl font-semibold",children:"Record Stock Movement"}),e.jsx("p",{className:"text-sm mt-1 text-gray-600",children:"Update inventory stock levels"})]})]})}),e.jsx(de,{errors:i}),e.jsxs(ue.form,{onSubmit:f,className:"space-y-6 pt-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(me,{className:"h-5 w-5 text-gray-600"}),e.jsx(y,{className:"text-sm font-medium text-gray-700",children:"Item Details"})]}),e.jsx("p",{className:"font-semibold text-gray-900",children:o?.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Current stock: ",e.jsxs("span",{className:"font-medium text-gray-900",children:[o?.stock[0]?.stocks," ",o?.stock[0]?.stockname,"s"]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{className:"text-sm font-medium flex items-center gap-2 text-gray-700",children:[e.jsx(R,{className:"h-4 w-4 text-gray-500"}),"Movement Type"]}),e.jsxs(W,{value:r.type,onValueChange:d=>s("type",d),className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg transition-colors border-gray-200 hover:bg-green-50 hover:border-green-300",children:[e.jsx(k,{value:"Incoming",id:"Incoming"}),e.jsxs(y,{htmlFor:"Incoming",className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Incoming"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg transition-colors border-gray-200 hover:bg-red-50 hover:border-red-300",children:[e.jsx(k,{value:"Outgoing",id:"Outgoing"}),e.jsxs(y,{htmlFor:"Outgoing",className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(pe,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Outgoing"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4 text-gray-500"}),"Expiry Date"]}),e.jsx(N,{id:"expirationDate",type:"date",name:"expirydate",value:r.expiry,onChange:d=>s("expiry",d.target.value),className:"h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{htmlFor:"quantity",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-gray-500"}),"Quantity"]}),e.jsx(N,{id:"quantity",type:"number",min:"1",max:r.type==="Outgoing"?o?.stock[0]?.stocks:void 0,name:"quantity",value:r.quantity,onChange:p,placeholder:"Enter quantity",className:"h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),r.type==="Outgoing"&&e.jsxs("p",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded-md",children:["Maximum quantity that can be removed: ",o?.stock[0]?.stocks]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{htmlFor:"reason",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-500"}),"Reason ",r.type==="Outgoing"&&"(Required)"]}),e.jsx(le,{id:"reason",name:"reason",value:r.reason,onChange:p,placeholder:r.type==="Incoming"?"Optional - Enter reason for adding stock":"Why is this item being removed from inventory?",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:r.type==="Outgoing"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(y,{htmlFor:"performedBy",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 text-gray-500"}),"Performed By"]}),e.jsx(N,{id:"performedBy",value:`${m?.firstname} ${m?.lastname}`,className:"h-11 border-gray-300 bg-gray-50",disabled:!0})]}),e.jsx(re,{className:"pt-6 border-t border-gray-100",children:e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx(E,{type:"button",variant:"outline",onClick:n,className:"flex-1 h-11 border-gray-300 hover:bg-gray-50",children:"Cancel"}),e.jsx(E,{type:"submit",className:"flex-1 h-11 text-white",style:{backgroundColor:"#2C3E50"},onMouseEnter:d=>d.target.style.backgroundColor="#34495E",onMouseLeave:d=>d.target.style.backgroundColor="#2C3E50",disabled:a,children:a?"Saving...":"Save Changes"})]})})]})]})})};export{ct as default};
