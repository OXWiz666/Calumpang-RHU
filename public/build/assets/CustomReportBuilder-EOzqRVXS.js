import{j as e,H as B,b as D}from"./app-DbEHk-Y1.js";import{r as u}from"./vendor-DkBadjUr.js";import{A as M}from"./AdminLayout-Dn1LAAmD.js";import{C as q}from"./chevron-down-CEiCHn75.js";import{C as W}from"./chevron-right-B3qqnx4D.js";import{A as H}from"./index-SmYPfogB.js";import{m as R}from"./proxy-BRuk2j5t.js";import{c as U}from"./createLucideIcon-BKWaAi2G.js";import{F as k}from"./file-text-YZXa1D2L.js";import{X as J}from"./x-b8JahagL.js";import{P as K}from"./plus-MavOGQlj.js";import{T as E}from"./trash-2-DJ5zXW8D.js";import{C as z}from"./chart-column-yMaSKbSU.js";import{C as V}from"./chart-pie-D6yKCg1t.js";import{T as F}from"./trending-up-BFbz08q-.js";import{E as Q}from"./eye-mxYijkrE.js";import{S as Y}from"./save-CAdd64LS.js";import{D as A}from"./download-BH8XyxCx.js";import{s as b}from"./toast-CTwn3Qgh.js";import"./pusher-DVtoYAOu.js";import"./index-C-BhOzML.js";import"./button-hTaAscVM.js";import"./card-CuNX9n6Z.js";import"./avatar-C9EXpg1l.js";import"./react-icons.esm-DCEEl_mi.js";import"./separator-KL7v4q6k.js";import"./index-B7VWkaSA.js";import"./index-CeA5MDTz.js";import"./select-DwW4yNtx.js";import"./index-16Tu26i9.js";import"./index-B2NWmDAr.js";import"./tslib.es6-M_FJ09fS.js";import"./index-BZVXTTf6.js";import"./index-CUQ3XI0U.js";import"./index-DqxisvwK.js";import"./index-C1y68Ddx.js";import"./moment-C5S46NFB.js";import"./dialog-CHHHHR8_.js";import"./input-BfkVQ9Hy.js";import"./label-z6rUNhXe.js";import"./calendar-DCrMp8Ot.js";import"./format-Dp3w_Y3x.js";import"./isSameMonth-BOwz-_mK.js";import"./isBefore-Bnl9x5VB.js";import"./TextInput-Dos6RRW0.js";import"./settings-D_MeB5oN.js";import"./house-CSq-WFst.js";import"./calendar-D9APQM2e.js";import"./users-D4PhO1-D.js";import"./pill-DIGxtF-3.js";import"./badge-BjEm-iAn.js";import"./pusher-BR51OpoQ.js";import"./printer-CfgcPaUh.js";import"./package-L7rgkkVO.js";import"./circle-check-big-BQVCuGNJ.js";import"./autoprefixer-BHVjDhrs.js";import"./unit-CopbpOEH.js";import"./Toaster-BjJdaHbU.js";import"./toast-DwOpO9i-.js";import"./use-toast-Dm0PN6fH.js";import"./layers-OK8ayVTK.js";import"./refresh-cw-D3hZ7e_O.js";import"./square-pen-Bb1JtfBr.js";import"./archive-BwGVl8jP.js";import"./info-BVLwYIm5.js";import"./triangle-alert-BslwqqvL.js";import"./circle-x-Cf2XhiVO.js";import"./circle-check-F3PuHnLX.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],T=U("GripVertical",Z),ee=({onSave:o,onPreview:c,onGenerate:i})=>{const[r,s]=u.useState({name:"",description:"",category:"overview",dateRange:{start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},fields:[],filters:[],visualizations:[],grouping:[],sorting:[],format:"pdf"}),[d,j]=u.useState({patients:[{id:"firstname",name:"First Name",type:"text",category:"basic"},{id:"lastname",name:"Last Name",type:"text",category:"basic"},{id:"gender",name:"Gender",type:"select",category:"basic"},{id:"birth",name:"Birth Date",type:"date",category:"basic"},{id:"address",name:"Address",type:"text",category:"contact"},{id:"contactno",name:"Contact Number",type:"text",category:"contact"},{id:"email",name:"Email",type:"email",category:"contact"},{id:"registration_date",name:"Registration Date",type:"date",category:"system"},{id:"last_visit",name:"Last Visit",type:"date",category:"system"},{id:"total_appointments",name:"Total Appointments",type:"number",category:"metrics"},{id:"completed_appointments",name:"Completed Appointments",type:"number",category:"metrics"}],appointments:[{id:"date",name:"Date",type:"date",category:"basic"},{id:"time",name:"Time",type:"time",category:"basic"},{id:"status",name:"Status",type:"select",category:"basic"},{id:"service_name",name:"Service Name",type:"text",category:"service"},{id:"patient_name",name:"Patient Name",type:"text",category:"patient"},{id:"staff_name",name:"Staff Name",type:"text",category:"staff"},{id:"notes",name:"Notes",type:"text",category:"additional"},{id:"duration",name:"Duration (minutes)",type:"number",category:"metrics"},{id:"wait_time",name:"Wait Time (minutes)",type:"number",category:"metrics"}],inventory:[{id:"item_name",name:"Item Name",type:"text",category:"basic"},{id:"generic_name",name:"Generic Name",type:"text",category:"basic"},{id:"category",name:"Category",type:"select",category:"basic"},{id:"current_stock",name:"Current Stock",type:"number",category:"inventory"},{id:"minimum_stock",name:"Minimum Stock",type:"number",category:"inventory"},{id:"expiry_date",name:"Expiry Date",type:"date",category:"inventory"},{id:"days_until_expiry",name:"Days Until Expiry",type:"number",category:"inventory"},{id:"status",name:"Status",type:"select",category:"status"},{id:"priority",name:"Priority",type:"select",category:"status"},{id:"manufacturer",name:"Manufacturer",type:"text",category:"details"},{id:"batch_number",name:"Batch Number",type:"text",category:"details"}],staff:[{id:"firstname",name:"First Name",type:"text",category:"basic"},{id:"lastname",name:"Last Name",type:"text",category:"basic"},{id:"role",name:"Role",type:"select",category:"basic"},{id:"status",name:"Status",type:"select",category:"basic"},{id:"email",name:"Email",type:"email",category:"contact"},{id:"contactno",name:"Contact Number",type:"text",category:"contact"},{id:"hire_date",name:"Hire Date",type:"date",category:"employment"},{id:"total_appointments",name:"Total Appointments",type:"number",category:"metrics"},{id:"completed_appointments",name:"Completed Appointments",type:"number",category:"metrics"},{id:"performance_score",name:"Performance Score",type:"number",category:"metrics"}]}),[y,p]=u.useState(null),[v,x]=u.useState({fields:!0,filters:!1,visualizations:!1,grouping:!1}),m=[{id:"bar",name:"Bar Chart",icon:z,description:"Compare values across categories"},{id:"pie",name:"Pie Chart",icon:V,description:"Show proportions of a whole"},{id:"line",name:"Line Chart",icon:F,description:"Show trends over time"},{id:"table",name:"Data Table",icon:k,description:"Display detailed data in table format"}],n=(t,a)=>{t.dataTransfer.setData("application/json",JSON.stringify(a))},f=t=>{t.preventDefault();const a=JSON.parse(t.dataTransfer.getData("application/json"));r.fields.find(l=>l.id===a.id)||s(l=>({...l,fields:[...l.fields,{...a,order:l.fields.length}]})),p(null)},N=t=>{t.preventDefault(),p(!0)},g=t=>{t.preventDefault(),p(!1)},h=t=>{s(a=>({...a,fields:a.fields.filter(l=>l.id!==t)}))},C=()=>{s(t=>({...t,filters:[...t.filters,{id:Date.now(),field:"",operator:"equals",value:"",type:"text"}]}))},S=(t,a)=>{s(l=>({...l,filters:l.filters.map(w=>w.id===t?{...w,...a}:w)}))},$=t=>{s(a=>({...a,filters:a.filters.filter(l=>l.id!==t)}))},L=t=>{s(a=>({...a,visualizations:[...a.visualizations,{id:Date.now(),type:t,title:`${t.name} Visualization`,fields:[],config:{}}]}))},O=t=>{s(a=>({...a,visualizations:a.visualizations.filter(l=>l.id!==t)}))},G=t=>{x(a=>({...a,[t]:!a[t]}))},_=()=>d[r.category]||[],I=()=>_().reduce((a,l)=>(a[l.category]||(a[l.category]=[]),a[l.category].push(l),a),{});return e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Custom Report Builder"}),e.jsx("p",{className:"text-gray-600",children:"Create powerful, customized reports with drag-and-drop simplicity"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4 sticky top-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Available Fields"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Category"}),e.jsxs("select",{value:r.category,onChange:t=>s(a=>({...a,category:t.target.value,fields:[]})),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"patients",children:"Patients"}),e.jsx("option",{value:"appointments",children:"Appointments"}),e.jsx("option",{value:"inventory",children:"Inventory"}),e.jsx("option",{value:"staff",children:"Staff"})]})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(I()).map(([t,a])=>e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>G(t),className:"flex items-center justify-between w-full text-left p-2 hover:bg-gray-50 rounded",children:[e.jsx("span",{className:"font-medium capitalize",children:t}),v[t]?e.jsx(q,{className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4"})]}),e.jsx(H,{children:v[t]&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"pl-4 space-y-1",children:a.map(l=>e.jsxs("div",{draggable:!0,onDragStart:w=>n(w,l),className:"flex items-center gap-2 p-2 bg-gray-50 rounded cursor-move hover:bg-gray-100",children:[e.jsx(T,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:l.name}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-1 rounded",children:l.type})]},l.id))})})})]},t))})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Report Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Name"}),e.jsx("input",{type:"text",value:r.name,onChange:t=>s(a=>({...a,name:t.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"Enter report name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Output Format"}),e.jsxs("select",{value:r.format,onChange:t=>s(a=>({...a,format:t.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"excel",children:"Excel"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"web",children:"Web View"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>s(a=>({...a,description:t.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:3,placeholder:"Enter report description"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Selected Fields"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[r.fields.length," fields"]})]}),e.jsx("div",{onDrop:f,onDragOver:N,onDragLeave:g,className:`min-h-[100px] border-2 border-dashed rounded-lg p-4 ${y?"border-blue-400 bg-blue-50":"border-gray-300"}`,children:r.fields.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(k,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Drag fields here to add them to your report"})]}):e.jsx("div",{className:"space-y-2",children:r.fields.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:t.name}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-1 rounded",children:t.type})]}),e.jsx("button",{onClick:()=>h(t.id),className:"text-red-500 hover:text-red-700",children:e.jsx(J,{className:"h-4 w-4"})})]},t.id))})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Filters"}),e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(K,{className:"h-4 w-4"}),"Add Filter"]})]}),e.jsx("div",{className:"space-y-3",children:r.filters.map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("select",{value:t.field,onChange:a=>S(t.id,{field:a.target.value}),className:"flex-1 border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"",children:"Select field"}),_().map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsxs("select",{value:t.operator,onChange:a=>S(t.id,{operator:a.target.value}),className:"border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"equals",children:"Equals"}),e.jsx("option",{value:"not_equals",children:"Not Equals"}),e.jsx("option",{value:"contains",children:"Contains"}),e.jsx("option",{value:"starts_with",children:"Starts With"}),e.jsx("option",{value:"ends_with",children:"Ends With"}),e.jsx("option",{value:"greater_than",children:"Greater Than"}),e.jsx("option",{value:"less_than",children:"Less Than"}),e.jsx("option",{value:"between",children:"Between"})]}),e.jsx("input",{type:"text",value:t.value,onChange:a=>S(t.id,{value:a.target.value}),className:"flex-1 border border-gray-300 rounded-md px-3 py-2",placeholder:"Enter value"}),e.jsx("button",{onClick:()=>$(t.id),className:"text-red-500 hover:text-red-700",children:e.jsx(E,{className:"h-4 w-4"})})]},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Visualizations"}),e.jsx("div",{className:"flex gap-2",children:m.map(t=>e.jsxs("button",{onClick:()=>L(t),className:"flex items-center gap-2 px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:[e.jsx(t.icon,{className:"h-4 w-4"}),t.name]},t.id))})]}),e.jsx("div",{className:"space-y-3",children:r.visualizations.map(t=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:t.title}),e.jsx("button",{onClick:()=>O(t.id),className:"text-red-500 hover:text-red-700",children:e.jsx(E,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t.description}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Type: ",t.type," | Fields: ",t.fields.length]})]},t.id))})]})]})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-4",children:[e.jsxs("button",{onClick:()=>c&&c(r),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:[e.jsx(Q,{className:"h-4 w-4"}),"Preview"]}),e.jsxs("button",{onClick:()=>o&&o(r),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(Y,{className:"h-4 w-4"}),"Save Template"]}),e.jsxs("button",{onClick:()=>i&&i(r),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[e.jsx(A,{className:"h-4 w-4"}),"Generate Report"]})]})]})},te=({reportConfig:o,data:c,onClose:i,onGenerate:r})=>{const[s,d]=u.useState(c||[]),[j,y]=u.useState(!1),[p,v]=u.useState("table");u.useEffect(()=>{c||x()},[o]);const x=()=>{const n=[];for(let N=0;N<20;N++){const g={};o.fields.forEach(h=>{switch(h.type){case"text":g[h.id]=`Sample ${h.name} ${N+1}`;break;case"number":g[h.id]=Math.floor(Math.random()*1e3);break;case"date":g[h.id]=new Date(Date.now()-Math.random()*365*24*60*60*1e3).toISOString().split("T")[0];break;case"email":g[h.id]=`user${N+1}@example.com`;break;case"select":const C=["Active","Inactive","Pending","Completed"];g[h.id]=C[Math.floor(Math.random()*C.length)];break;default:g[h.id]=`Sample ${h.name} ${N+1}`}}),n.push(g)}d(n)},m=n=>{switch(n.type){case"bar":return e.jsx(ae,{data:s,fields:n.fields});case"pie":return e.jsx(se,{data:s,fields:n.fields});case"line":return e.jsx(re,{data:s,fields:n.fields});case"table":return e.jsx(P,{data:s,fields:o.fields});default:return e.jsx("div",{className:"text-gray-500",children:"Unsupported visualization type"})}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(R.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl max-w-7xl w-full max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o.name||"Custom Report Preview"}),e.jsx("p",{className:"text-sm text-gray-600",children:o.description||"Preview of your custom report"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:e.jsx(X,{className:"h-6 w-6"})})})]})}),e.jsx("div",{className:"border-b",children:e.jsxs("nav",{className:"flex space-x-8 px-6",children:[e.jsxs("button",{onClick:()=>v("table"),className:`py-4 px-1 border-b-2 font-medium text-sm ${p==="table"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(k,{className:"h-4 w-4 inline mr-2"}),"Data Table"]}),o.visualizations.map((n,f)=>e.jsxs("button",{onClick:()=>v(`viz-${f}`),className:`py-4 px-1 border-b-2 font-medium text-sm ${p===`viz-${f}`?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.type==="bar"&&e.jsx(z,{className:"h-4 w-4 inline mr-2"}),n.type==="pie"&&e.jsx(V,{className:"h-4 w-4 inline mr-2"}),n.type==="line"&&e.jsx(F,{className:"h-4 w-4 inline mr-2"}),n.title]},n.id))]})}),e.jsx("div",{className:"p-6 overflow-auto max-h-[60vh]",children:p==="table"?e.jsx(P,{data:s,fields:o.fields}):o.visualizations.map((n,f)=>p===`viz-${f}`&&e.jsx("div",{children:m(n)},n.id))}),e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",s.length," records â€¢ Generated on ",new Date().toLocaleString()]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:i,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Close"}),e.jsxs("button",{onClick:()=>r&&r(o),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(A,{className:"h-4 w-4"}),"Generate Report"]})]})]})})]})})},P=({data:o,fields:c})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:c.map(i=>e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.name},i.id))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map((i,r)=>e.jsx("tr",{className:r%2===0?"bg-white":"bg-gray-50",children:c.map(s=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.type==="select"&&getStatusIcon(i[s.id]),formatValue(i[s.id],s)]})},s.id))},r))})]})}),ae=({data:o,fields:c})=>{const i=o.slice(0,10);return e.jsx("div",{className:"h-64 flex items-end justify-between space-x-2",children:i.map((r,s)=>{const d=r[c[0]?.id]||0,j=Math.max(...i.map(p=>p[c[0]?.id]||0)),y=d/j*100;return e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:"bg-blue-500 w-full rounded-t",style:{height:`${y}%`}}),e.jsx("div",{className:"text-xs text-gray-600 mt-2 truncate w-full text-center",children:String(r[c[0]?.id]||"").substring(0,10)})]},s)})})},se=({data:o,fields:c})=>{const i=o.slice(0,5),r=i.reduce((s,d)=>s+(d[c[0]?.id]||0),0);return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Total ",c[0]?.name||"Value"]}),e.jsx("div",{className:"mt-4 space-y-1",children:i.map((s,d)=>{const j=s[c[0]?.id]||0,y=r>0?j/r*100:0,p=["bg-blue-500","bg-green-500","bg-yellow-500","bg-red-500","bg-purple-500"];return e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:`w-3 h-3 rounded ${p[d%p.length]}`}),e.jsx("span",{children:String(s[c[0]?.id]||"").substring(0,15)}),e.jsxs("span",{className:"text-gray-500",children:["(",y.toFixed(1),"%)"]})]},d)})})]})})},re=({data:o,fields:c})=>{const i=o.slice(0,10);return e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(F,{className:"h-16 w-16 text-blue-500 mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:"Line Chart Preview"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Data points: ",i.length]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Full line chart will be rendered in the actual report"})]})})},jt=()=>{const[o,c]=u.useState(!1),[i,r]=u.useState(null),[s,d]=u.useState(!1),j=async x=>{try{d(!0);const m=await D.post("/admin/custom-reports/generate",{...x,format:"web"});m.data.success?(r(m.data),c(!0)):b("Error","Failed to generate preview","error")}catch(m){console.error("Error generating preview:",m),b("Error","Failed to generate preview","error")}finally{d(!1)}},y=async x=>{try{d(!0),(await D.post("/admin/custom-reports/save-template",x)).data.success?b("Success","Template saved successfully","success"):b("Error","Failed to save template","error")}catch(m){console.error("Error saving template:",m),b("Error","Failed to save template","error")}finally{d(!1)}},p=async x=>{try{d(!0);const m=await D.post("/admin/custom-reports/generate",{...x,format:x.format});if(m.data.success){if(b("Success","Report generated successfully","success"),x.format!=="web"){const n=document.createElement("a");n.href=m.data.download_url,n.download=m.data.filename,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}else b("Error","Failed to generate report","error")}catch(m){console.error("Error generating report:",m),b("Error","Failed to generate report","error")}finally{d(!1)}},v=()=>{c(!1),r(null)};return e.jsxs(M,{header:"Custom Report Builder",children:[e.jsx(B,{title:"Custom Report Builder"}),e.jsx("div",{className:"py-6",children:e.jsx(ee,{onPreview:j,onSave:y,onGenerate:p})}),o&&i&&e.jsx(te,{reportConfig:i.reportConfig,data:i.data,analytics:i.analytics,onClose:v,onGenerate:p}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-gray-700",children:"Processing..."})]})})]})};export{jt as default};
