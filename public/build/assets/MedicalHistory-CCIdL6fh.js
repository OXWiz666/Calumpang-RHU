import{u as E,j as e}from"./app-CpcWMaCr.js";import{r as c}from"./vendor-DkBadjUr.js";import{n as h}from"./index-WHihrx3k.js";import{B as u}from"./button-83KshekS.js";import{C as b,c as p,a as M,b as H,e as D}from"./card-i_W9PX4F.js";import S from"./add-medical-record-form-vzcuWMi7.js";import{S as F}from"./square-pen-Bb1JtfBr.js";import{P as R}from"./plus-MavOGQlj.js";import{F as j}from"./file-text-YZXa1D2L.js";import{H as A}from"./heart-CDAohmX9.js";import{S as U}from"./stethoscope-QcN9KdKi.js";import{C as I}from"./calendar-D9APQM2e.js";import{U as O}from"./user-3RJR1iCA.js";import"./pusher-DVtoYAOu.js";import"./index-D-5lYtqK.js";import"./input-FXb9p87Q.js";import"./label-Ci5QeB7S.js";import"./react-icons.esm-9ndgmCxB.js";import"./textarea-DWWi065D.js";import"./moment-C5S46NFB.js";import"./select-B2DawXAC.js";import"./index-cyM4JHm5.js";import"./index-DcuBkBaW.js";import"./index-BWKolfP-.js";import"./tslib.es6-M_FJ09fS.js";import"./index-Su2r44Ky.js";import"./index-DqxisvwK.js";import"./index-Bkpbp3ld.js";import"./radio-group-6prAR6KW.js";import"./index-XkFAycwM.js";import"./index-BuhaAKb_.js";import"./checkbox-kqr4RhZ1.js";import"./PrintErrors-Cx9Dl8hd.js";import"./dialog-CDdyR0jn.js";import"./save-CAdd64LS.js";import"./createLucideIcon-BKWaAi2G.js";function ve({patient:a,doctors:f,onAddRecord:T}){const[N,d]=c.useState(!1),[g,m]=c.useState(!1),[i,x]=c.useState(null),[o,y]=c.useState(a?.medical_records||[]),{data:n,setData:_,post:C,put:P,processing:k,recentlySuccessful:B,errors:w,clearErrors:$,reset:v}=E({});return c.useEffect(()=>{console.log("MedicalHistory - Patient data received:",a),console.log("MedicalHistory - Medical records:",a?.medical_records),console.log("MedicalHistory - Medical records length:",a?.medical_records?.length),a?.medical_records&&Array.isArray(a.medical_records)?(y(a.medical_records),console.log("MedicalHistory - Medical records set to state:",a.medical_records)):(console.log("MedicalHistory - No medical records found in patient data"),y([]))},[a?.medical_records]),c.useEffect(()=>{if(n&&Object.keys(n).length>0){if(console.log("Medical History - Form data received:",n),console.log("Medical History - Patient object:",a),console.log("Medical History - Patient ID:",a?.id),g&&m(!1),N&&d(!1),!a?.id){console.error("Medical History - No patient ID found!");return}const s=g&&i&&i.id,l=s?"admin.patients.medical-records.update":"admin.patients.medical-records.store";console.log("Medical History - Using route:",l),console.log("Medical History - Is update:",s),console.log("Medical History - Patient ID:",a?.id),console.log("Medical History - Patient ID (patient_id):",a?.patient_id),console.log("Medical History - Patient object:",a),console.log("Medical History - Editing record:",i);let t;try{s?t=route(l,{patient:a?.patient_id||a?.id,medicalRecord:i.id}):t=route(l,{patient:a?.patient_id||a?.id}),console.log("Medical History - Route URL:",t),console.log("Medical History - Patient ID used:",a?.patient_id||a?.id)}catch(r){console.error("Medical History - Route generation error:",r);return}s?P(t,{...n},{preserveScroll:!1,preserveState:!0,onSuccess:()=>{console.log("Medical History - Update Success!"),h.success("Medical record updated successfully!"),d(!1),m(!1),x(null),v()},onError:r=>{console.error("Medical History - Error updating record:",r),h.error("Failed to update medical record. Please try again."),console.log("Medical History - Update errors:",r)},onFinish:()=>{console.log("Medical History - Update request finished"),setTimeout(()=>{d(!1),m(!1),x(null)},50)}}):C(t,{...n},{preserveScroll:!1,preserveState:!0,onSuccess:()=>{console.log("Medical History - Create Success!"),h.success("Medical record created successfully!"),d(!1),v()},onError:r=>{console.error("Medical History - Error adding record:",r),h.error("Failed to create medical record. Please try again."),console.log("Medical History - Create errors:",r)},onFinish:()=>{console.log("Medical History - Create request finished"),setTimeout(()=>{d(!1)},50)}})}},[n]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Medical History"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Complete medical record history for ",a?.firstname," ",a?.lastname]})]}),o&&o.length>0?e.jsxs(u,{onClick:()=>{x(o[0]),m(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Edit Medical Record"]}):e.jsxs(u,{onClick:()=>d(!0),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(R,{className:"h-5 w-5 mr-2"}),"Add Medical Record"]})]}),e.jsx(b,{children:e.jsx(p,{className:"p-6",children:o&&o.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b-2 border-blue-600 pb-4 mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-blue-800 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(j,{className:"h-6 w-6 text-blue-600"})}),"Medical Records History"]}),e.jsx("p",{className:"text-base text-gray-700 mt-2 font-medium",children:"Comprehensive medical documentation and patient health records"})]}),o.map(s=>e.jsxs(b,{className:"border-l-4 border-l-blue-600 bg-gradient-to-r from-blue-50 to-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(M,{className:"pb-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-lg",children:e.jsx(A,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx(H,{className:"text-xl font-bold text-white",children:"Medical Record Entry"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:"text-base text-blue-100 font-medium",children:s.appointment_service||"Medical Record"}),e.jsx("span",{className:"text-base text-blue-100",children:s.appointment_date}),e.jsx("span",{className:"px-3 py-1 bg-white bg-opacity-20 text-white text-sm font-semibold rounded-full border border-white border-opacity-30",children:s.record_type})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-base text-white font-semibold",children:["Dr. ",s.doctor_name]}),e.jsx("p",{className:"text-sm text-blue-100",children:s.created_at})]})]})}),e.jsx(p,{className:"pt-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.admin_data&&e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg border border-green-200",children:[e.jsxs("h4",{className:"text-lg font-bold text-green-800 mb-3 flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Vital Signs & Measurements"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[s.admin_data.weight&&e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-green-100",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"Weight:"}),e.jsxs("span",{className:"text-base font-bold text-gray-800 ml-2",children:[s.admin_data.weight," kg"]})]}),s.admin_data.height&&e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-green-100",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"Height:"}),e.jsxs("span",{className:"text-base font-bold text-gray-800 ml-2",children:[s.admin_data.height," cm"]})]}),s.admin_data.temperature&&e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-green-100",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"Temperature:"}),e.jsxs("span",{className:"text-base font-bold text-gray-800 ml-2",children:[s.admin_data.temperature,"°C"]})]}),s.admin_data.rr&&e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-green-100",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"RR:"}),e.jsxs("span",{className:"text-base font-bold text-gray-800 ml-2",children:[s.admin_data.rr," bpm"]})]}),s.admin_data.pr&&e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-green-100",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"PR:"}),e.jsxs("span",{className:"text-base font-bold text-gray-800 ml-2",children:[s.admin_data.pr," bpm"]})]}),s.admin_data.bp&&e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-green-100",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"BP:"}),e.jsx("span",{className:"text-base font-bold text-gray-800 ml-2",children:s.admin_data.bp})]}),s.admin_data.bmi&&e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-green-100",children:[e.jsx("span",{className:"text-sm font-semibold text-green-700",children:"BMI:"}),e.jsx("span",{className:"text-base font-bold text-gray-800 ml-2",children:s.admin_data.bmi})]})]})]})}),s.follow_up_date&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Follow-up Date"}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:s.follow_up_date})]}),s.admin_data?.past_medical_history&&e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 p-4 rounded-lg border border-orange-200",children:[e.jsxs("h4",{className:"text-lg font-bold text-orange-800 mb-3 flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5"}),"Past Medical History"]}),e.jsxs("div",{className:"space-y-2",children:[Object.entries(s.admin_data.past_medical_history).map(([l,t])=>l==="others"?t?e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-orange-100",children:[e.jsx("span",{className:"text-sm font-semibold text-orange-700",children:"Others:"}),e.jsx("span",{className:"text-base font-medium text-gray-800 ml-2",children:t})]},l):null:typeof t=="object"&&t.checked?e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-orange-100 flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold text-lg",children:"✓"}),e.jsx("span",{className:"text-base font-semibold text-gray-800",children:l.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())}),t.specify&&e.jsxs("span",{className:"text-sm text-gray-600",children:["- ",t.specify]}),t.specify_organ&&e.jsxs("span",{className:"text-sm text-gray-600",children:["- ",t.specify_organ]}),t.category&&e.jsxs("span",{className:"text-sm text-gray-600",children:["- ",t.category]}),t.specify_type&&e.jsxs("span",{className:"text-sm text-gray-600",children:["- ",t.specify_type]}),t.highest_bp&&e.jsxs("span",{className:"text-sm text-gray-600",children:["- ",t.highest_bp]})]},l):null),Object.entries(s.admin_data.past_medical_history).every(([l,t])=>l==="others"?!t:!(typeof t=="object"&&t.checked))&&e.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-orange-100 text-center",children:e.jsx("span",{className:"text-base text-gray-500 italic",children:"No past medical conditions recorded"})})]})]})}),s.admin_data?.past_surgical_history&&e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 p-4 rounded-lg border border-purple-200",children:[e.jsxs("h4",{className:"text-lg font-bold text-purple-800 mb-3 flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"Past Surgical History"]}),e.jsxs("div",{className:"space-y-2",children:[s.admin_data.past_surgical_history.map((l,t)=>l.operation||l.date?e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-purple-700",children:"Operation:"}),e.jsx("span",{className:"text-base font-bold text-gray-800",children:l.operation||"Not specified"})]}),l.date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-purple-700",children:"Date:"}),e.jsx("span",{className:"text-base font-medium text-gray-700",children:l.date})]})]},t):null),s.admin_data.past_surgical_history.every(l=>!l.operation&&!l.date)&&e.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-purple-100 text-center",children:e.jsx("span",{className:"text-base text-gray-500 italic",children:"No past surgical procedures recorded"})})]})]})}),s.admin_data&&e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 p-4 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"text-lg font-bold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Patient Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Name:"}),e.jsx("span",{className:"text-base font-bold text-gray-800 ml-2",children:s.admin_data.name})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Sex:"}),e.jsx("span",{className:"text-base font-bold text-gray-800 ml-2 capitalize",children:s.admin_data.sex})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Address:"}),e.jsx("span",{className:"text-base font-medium text-gray-800 ml-2",children:s.admin_data.address})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Mother:"}),e.jsx("span",{className:"text-base font-medium text-gray-800 ml-2",children:s.admin_data.name_of_mother})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Contact:"}),e.jsx("span",{className:"text-base font-medium text-gray-800 ml-2",children:s.admin_data.contact_no})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Age:"}),e.jsxs("span",{className:"text-base font-bold text-gray-800 ml-2",children:[s.admin_data.age," years old"]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Birthdate:"}),e.jsx("span",{className:"text-base font-medium text-gray-800 ml-2",children:s.admin_data.birthdate})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"Father:"}),e.jsx("span",{className:"text-base font-medium text-gray-800 ml-2",children:s.admin_data.name_of_father})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm border border-blue-100",children:[e.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"NHTS Status:"}),e.jsx("span",{className:"text-base font-medium text-gray-800 ml-2",children:s.admin_data.nhts_status==="nhts"?"Yes":s.admin_data.nhts_status==="non_nhts"?"No":"Not specified"})]})]})]})]})})]})})]},s.id))]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(j,{className:"h-12 w-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Medical Records Found"}),e.jsx("p",{className:"text-base text-gray-500 mb-6",children:"This patient has no medical records documented yet."}),e.jsxs("div",{className:"text-sm text-gray-400 bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6",children:[e.jsx("p",{className:"font-medium mb-2",children:"Medical records typically include:"}),e.jsxs("ul",{className:"text-left space-y-1",children:[e.jsx("li",{children:"• Vital signs and measurements"}),e.jsx("li",{children:"• Past medical history"}),e.jsx("li",{children:"• Past surgical procedures"}),e.jsx("li",{children:"• Patient demographic information"})]})]}),e.jsxs(u,{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 text-base font-semibold",children:[e.jsx(R,{className:"h-5 w-5 mr-2"}),"Add First Medical Record"]})]})})}),a?.medical_histories&&a.medical_histories.length>0&&e.jsxs(b,{children:[e.jsxs(M,{children:[e.jsx(H,{className:"text-lg font-semibold text-gray-600",children:"Legacy Medical Records"}),e.jsx(D,{children:"Older medical history records"})]}),e.jsx(p,{children:e.jsx("div",{className:"space-y-4",children:a.medical_histories.map(s=>e.jsx(b,{className:"border-l-4 border-l-gray-400",children:e.jsx(p,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),e.jsx("p",{children:new Date(s.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Doctor"}),e.jsxs("p",{children:[s?.doctor?.user?.firstname," ",s?.doctor?.user?.lastname]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Diagnosis"}),e.jsx("p",{children:s.diagnosis})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Treatment"}),e.jsx("p",{children:s.treatment})]}),s.clinic_notes&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),e.jsx("p",{children:s.clinic_notes})]}),s.followup_inst&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Follow-up"}),e.jsx("p",{children:s.followup_inst})]})]})})},s.id))})})]}),e.jsx(S,{patientName:`${a.firstname} ${a.lastname}`,onSubmit:s=>_(s),onCancel:()=>d(!1),doctors:f,patient:a,errors:w,isOpen:N}),e.jsx(S,{patientName:`${a.firstname} ${a.lastname}`,onSubmit:s=>_(s),onCancel:()=>{m(!1),x(null)},doctors:f,patient:a,errors:w,editingRecord:i,isEditing:!0,isOpen:g&&i!==null})]})}export{ve as default};
