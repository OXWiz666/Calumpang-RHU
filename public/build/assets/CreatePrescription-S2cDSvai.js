import{r as v,u as L,j as e,H as V,L as w}from"./app-BYek28t3.js";import{A as B}from"./AdminLayout-Dyu_a3Tf.js";import{B as m}from"./button-CFU6UcKA.js";import{I as h}from"./input-B0M3oF_m.js";import{L as l}from"./label-CDKTbEDO.js";import{T as q}from"./textarea-BYzEf3mT.js";import{S as g,a as y,b as f,c as N,d as r}from"./select-C5_NUKah.js";import{C,a as _,b,c as S}from"./card-DC3m0m2Q.js";import{A as H}from"./arrow-left-YQvGqRxb.js";import{U as O}from"./user-jpraIQK4.js";import{P as A}from"./pill-COPI9s1H.js";import{P as z}from"./plus-gxag1FSO.js";import{T as U}from"./trash-2-DhHB7lAu.js";import"./Subservices-hmtw6ece.js";import"./utils-RNxviqOY.js";import"./avatar-C_4TQ5Yo.js";import"./index-Cq2dcEjx.js";import"./separator-Dea6m5MS.js";import"./index-C_AcOWpb.js";import"./index-B8mBpvNl.js";import"./moment-C5S46NFB.js";import"./dialog-B8nFG98e.js";import"./Combination-2tzW629K.js";import"./popover-DhIjPLo6.js";import"./format-Dp3w_Y3x.js";import"./isBefore-COsor6RJ.js";import"./isSameMonth-BOwz-_mK.js";import"./index-Bgv3a4mK.js";import"./index-DsxiASPK.js";import"./TextInput-CNHhKKz2.js";import"./createLucideIcon-Iodx7ABU.js";import"./x-DPKTEG6E.js";import"./settings-D3DbHyWx.js";import"./house-BDFhcRnP.js";import"./calendar-BrZsuCFt.js";import"./users-DsTP5XtR.js";import"./badge-zbI-jXEX.js";import"./pusher-D6WSJpxN.js";import"./printer-B6zykAlQ.js";import"./file-text-B0tnsgmg.js";import"./package-Cp0Bf08w.js";import"./circle-check-big-Ou30A1K0.js";import"./bell-CCnrKINf.js";import"./index-DU8KxlJ_.js";import"./proxy-ZNVcD8-b.js";import"./autoprefixer-CqoIqzrW.js";import"./Toaster-WULlhlN-.js";import"./toast-pmq-0a25.js";import"./index-OLHtNq9T.js";import"./index-DZIW3V9d.js";import"./layers-BoC40BlJ.js";import"./chart-column-WDIuOrtD.js";import"./index-oebGMNB2.js";function Ue({patients:P,medicines:a}){const[c,x]=v.useState([]),[u,E]=v.useState([]);v.useEffect(()=>{console.log("CreatePrescription - Medicines prop received:",a),console.log("CreatePrescription - Medicines type:",typeof a),console.log("CreatePrescription - Medicines length:",a?a.length:"undefined"),a&&Array.isArray(a)?(E(a),console.log("CreatePrescription - Available medicines set:",a)):console.log("CreatePrescription - No medicines prop received or not an array")},[a]);const{data:j,setData:p,post:T,processing:M,errors:o}=L({patient_id:"",prescription_date:new Date().toISOString().split("T")[0],case_id:"",medicines:[],notes:""}),D=()=>{const s={id:Date.now(),medicine_id:"",dosage:"",frequency:"",duration:"",quantity:"",instructions:""};x([...c,s])},I=s=>{x(c.filter(n=>n.id!==s))},d=(s,n,i)=>{x(c.map(t=>t.id===s?{...t,[n]:i}:t))},k=s=>{s.preventDefault();const n=c.filter(i=>i.medicine_id&&i.dosage&&i.frequency&&i.duration&&i.quantity).map(i=>({medicine_id:i.medicine_id,dosage:i.dosage,frequency:i.frequency,duration:i.duration,quantity:parseInt(i.quantity),instructions:i.instructions}));p("medicines",n),T(route("doctor.prescriptions.store"),{onSuccess:()=>{x([])}})},F=s=>u.find(n=>n.id==s);return e.jsxs(B,{header:"Create Prescription",children:[e.jsx(V,{title:"Create Prescription"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{href:route("doctor.prescriptions"),children:e.jsxs(m,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"Back"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create Prescription"}),e.jsx("p",{className:"text-gray-600",children:"Create a new prescription for a patient"})]})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs(C,{children:[e.jsx(_,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Patient Information"]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"patient_id",children:"Select Patient *"}),e.jsxs(g,{value:j.patient_id,onValueChange:s=>p("patient_id",s),children:[e.jsx(y,{className:"mt-1",children:e.jsx(f,{placeholder:"Choose a patient"})}),e.jsx(N,{children:P.map(s=>e.jsxs(r,{value:String(s.id),children:[s.id," - ",s.name]},s.id))})]}),o.patient_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.patient_id})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"prescription_date",children:"Prescription Date *"}),e.jsx(h,{id:"prescription_date",type:"date",value:j.prescription_date,onChange:s=>p("prescription_date",s.target.value),className:"mt-1"}),o.prescription_date&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.prescription_date})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"case_id",children:"Case ID *"}),e.jsx(h,{id:"case_id",type:"text",value:j.case_id,onChange:s=>p("case_id",s.target.value),placeholder:"e.g., CASE-001, MED-2025-001, etc.",className:"mt-1"}),o.case_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.case_id})]})]})]}),e.jsxs(C,{children:[e.jsx(_,{children:e.jsxs(b,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Medicines"]}),e.jsxs(m,{type:"button",onClick:D,className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Add Medicine"]})]})}),e.jsx(S,{children:c.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No medicines added yet"}),e.jsx("p",{className:"text-sm",children:'Click "Add Medicine" to start adding medicines to this prescription'})]}):e.jsx("div",{className:"space-y-4",children:c.map((s,n)=>{const i=F(s.medicine_id);return e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Medicine ",n+1]}),e.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:()=>I(s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Medicine *"}),e.jsxs(g,{value:s.medicine_id,onValueChange:t=>d(s.id,"medicine_id",t),children:[e.jsx(y,{className:"mt-1",children:e.jsx(f,{placeholder:"Select medicine"})}),e.jsx(N,{children:u&&u.length>0?u.map(t=>e.jsxs(r,{value:String(t.id),children:[t.name," (",t.generic_name,") - Stock: ",t.available_quantity," ",t.unit]},t.id)):e.jsx(r,{value:"no-medicines",disabled:!0,children:"No medicines available"})})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Quantity *"}),e.jsx(h,{type:"number",min:"1",value:s.quantity,onChange:t=>d(s.id,"quantity",t.target.value),placeholder:"Enter quantity",className:"mt-1"}),i&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Available: ",i.available_quantity," ",i.unit]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Dosage *"}),e.jsx(h,{value:s.dosage,onChange:t=>d(s.id,"dosage",t.target.value),placeholder:"e.g., 500mg, 1 tablet",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Frequency *"}),e.jsxs(g,{value:s.frequency,onValueChange:t=>d(s.id,"frequency",t),children:[e.jsx(y,{className:"mt-1",children:e.jsx(f,{placeholder:"Select frequency"})}),e.jsxs(N,{children:[e.jsx(r,{value:"Once daily",children:"Once daily"}),e.jsx(r,{value:"Twice daily",children:"Twice daily"}),e.jsx(r,{value:"Three times daily",children:"Three times daily"}),e.jsx(r,{value:"Four times daily",children:"Four times daily"}),e.jsx(r,{value:"Every 6 hours",children:"Every 6 hours"}),e.jsx(r,{value:"Every 8 hours",children:"Every 8 hours"}),e.jsx(r,{value:"Every 12 hours",children:"Every 12 hours"}),e.jsx(r,{value:"As needed",children:"As needed"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Duration *"}),e.jsx(h,{value:s.duration,onChange:t=>d(s.id,"duration",t.target.value),placeholder:"e.g., 7 days, 2 weeks",className:"mt-1"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{children:"Instructions"}),e.jsx(q,{value:s.instructions,onChange:t=>d(s.id,"instructions",t.target.value),placeholder:"Additional instructions for the patient",className:"mt-1",rows:2})]})]})]},s.id)})})})]}),e.jsxs(C,{children:[e.jsx(_,{children:e.jsx(b,{children:"Additional Notes"})}),e.jsx(S,{children:e.jsx(q,{value:j.notes,onChange:s=>p("notes",s.target.value),placeholder:"Any additional notes or instructions for this prescription",rows:4})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(w,{href:route("doctor.prescriptions"),children:e.jsx(m,{type:"button",variant:"outline",children:"Cancel"})}),e.jsx(m,{type:"submit",disabled:M||c.length===0,children:M?"Creating...":"Create Prescription"})]})]})]})]})}export{Ue as default};
