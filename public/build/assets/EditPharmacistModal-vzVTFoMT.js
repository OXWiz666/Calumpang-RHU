import{j as s,r as w}from"./app-Jdp7iNzl.js";import{r as p}from"./vendor-DkBadjUr.js";import{B as N}from"./button-bex_LU9I.js";import{I as l}from"./input-NCJ_n0W_.js";import{L as n}from"./label-CGwfsoC9.js";import"./textarea-hvcYZMC6.js";import{C as b,a as y,b as S,e as C,c as _}from"./card-DAZqRTBe.js";import{S as E,a as F,b as I,c as L,d as f}from"./select-CspDrWdj.js";import{D as k,a as M,b as q,c as A}from"./dialog-Dbk7O2i8.js";import{P as B}from"./pill-DIGxtF-3.js";import{m as O}from"./proxy-FTaFPFFz.js";import{S as U}from"./save-CAdd64LS.js";import"./pusher-DVtoYAOu.js";import"./index-C03ciVM9.js";import"./react-icons.esm-DopY43hH.js";import"./index-B2TPyuzg.js";import"./index-CQJFG6sX.js";import"./index-CnT-AOMH.js";import"./tslib.es6-M_FJ09fS.js";import"./index-BhA1pP3R.js";import"./index-at3TdkEY.js";import"./index-DqxisvwK.js";import"./index-BuhCV9Ak.js";import"./index-lVX1eI0n.js";import"./createLucideIcon-BKWaAi2G.js";function ms({pharmacist:r,isOpen:D,onClose:x,onSuccess:j}){const g=e=>({1:"active",2:"inactive",3:"suspended"})[e]||"active",[a,v]=p.useState({firstname:r?.firstname||"",lastname:r?.lastname||"",email:r?.email||"",contactno:r?.contactno||"",status:g(r?.status),role_id:r?.role_id||3,password:"",password_confirmation:""}),[u,c]=p.useState(!1),[i,m]=p.useState({});p.useEffect(()=>{r&&v({firstname:r.firstname||"",lastname:r.lastname||"",email:r.email||"",contactno:r.contactno||"",status:g(r.status),role_id:r.roleID||6,password:"",password_confirmation:""})},[r]);const o=(e,t)=>{v(h=>({...h,[e]:t}))},P=e=>{e.preventDefault(),c(!0),m({});const t={};if(a.password&&!a.password_confirmation&&(t.password_confirmation="Please confirm your new password."),a.password&&a.password_confirmation&&a.password!==a.password_confirmation&&(t.password_confirmation="Passwords do not match."),a.password&&a.password.length<8&&(t.password="Password must be at least 8 characters."),Object.keys(t).length>0){m(t),c(!1);return}const h={...a,contactno:String(a.contactno)};w.put(`/admin/staff/pharmacists/${r.id}`,h,{onSuccess:d=>{console.log("Update successful:",d),m({}),d.props.flash?.success,j&&j(a),w.reload({only:["pharmacists"]}),x(),c(!1)},onError:d=>{console.error("Update failed:",d),m(d),c(!1)}})};return s.jsx(k,{open:D,onOpenChange:x,children:s.jsxs(M,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[s.jsx(q,{children:s.jsxs(A,{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(B,{className:"h-5 w-5 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Edit Pharmacist Account"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Update pharmacist information and credentials"})]})]})}),s.jsxs(O.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[Object.keys(i).length>0&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md mb-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Please correct the following errors:"}),s.jsx("ul",{className:"mt-2 text-sm text-red-700 list-disc list-inside",children:Object.entries(i).map(([e,t])=>s.jsx("li",{children:t},e))})]})]})}),s.jsxs("form",{onSubmit:P,className:"space-y-4",children:[s.jsxs(b,{children:[s.jsxs(y,{className:"pb-3",children:[s.jsx(S,{className:"text-lg",children:"Personal Information"}),s.jsx(C,{children:"Basic pharmacist account details"})]}),s.jsxs(_,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"firstname",children:"First Name *"}),s.jsx(l,{id:"firstname",value:a.firstname,onChange:e=>o("firstname",e.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"lastname",children:"Last Name *"}),s.jsx(l,{id:"lastname",value:a.lastname,onChange:e=>o("lastname",e.target.value),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"email",children:"Email Address *"}),s.jsx(l,{id:"email",type:"email",value:a.email,onChange:e=>o("email",e.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"contactno",children:"Contact Number *"}),s.jsx(l,{id:"contactno",value:a.contactno,onChange:e=>o("contactno",e.target.value),required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"status",children:"Account Status"}),s.jsxs(E,{value:a.status,onValueChange:e=>o("status",e),children:[s.jsx(F,{children:s.jsx(I,{placeholder:"Select status"})}),s.jsxs(L,{children:[s.jsx(f,{value:"active",children:"Active"}),s.jsx(f,{value:"inactive",children:"Inactive"}),s.jsx(f,{value:"suspended",children:"Suspended"})]})]})]})]})]}),s.jsxs(b,{children:[s.jsxs(y,{className:"pb-3",children:[s.jsx(S,{className:"text-lg",children:"Security Settings"}),s.jsx(C,{children:"Update account password"})]}),s.jsx(_,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"password",children:"New Password"}),s.jsx(l,{id:"password",type:"password",value:a.password,onChange:e=>o("password",e.target.value),placeholder:"Leave blank to keep current password",className:i.password?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),i.password&&s.jsx("p",{className:"text-sm text-red-600",children:i.password})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"password_confirmation",children:"Confirm New Password"}),s.jsx(l,{id:"password_confirmation",type:"password",value:a.password_confirmation,onChange:e=>o("password_confirmation",e.target.value),placeholder:"Confirm new password",className:i.password_confirmation?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),i.password_confirmation&&s.jsx("p",{className:"text-sm text-red-600",children:i.password_confirmation})]})]})})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(N,{type:"button",variant:"outline",onClick:x,disabled:u,children:"Cancel"}),s.jsx(N,{type:"submit",disabled:u,className:"min-w-[120px]",children:u?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(U,{className:"h-4 w-4"}),"Save Changes"]})})]})]})]})]})})}export{ms as default};
