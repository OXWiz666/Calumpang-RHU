import{r as n,P as ee,j as e,a as $}from"./app-CYGHG-I-.js";import{A as se}from"./AdminLayout-Dfv_fV3m.js";import{I as x}from"./InputError-l34fcRZ4.js";import{B as y}from"./button-h7Q_hHVe.js";import{I as j}from"./input-DiP7wBEE.js";import"./avatar-ziRuotOs.js";import{T as te,a as re,b as S,c as h,d as ie,e as a}from"./table-dcdv2jGK.js";import{S as B,a as E,b as M,c as H,d as o}from"./select-BGITQuBa.js";import{D as ae,a as le,b as ne,c as oe,d as ce,e as de,f as me}from"./dialog-hDqB2Xu5.js";import"./card-CYRL8SV6.js";import"./separator-CXvTdokG.js";import"./index-Dcc6SfZ0.js";import"./index-1gMiWyxy.js";import"./index-CSwpX4v-.js";import"./index-BRB8htFt.js";import"./moment-C5S46NFB.js";import"./label-DU48g5Dl.js";import"./popover-F1QVCTKU.js";import"./react-icons.esm-w8JYQYKa.js";import"./format-BtYX0kVO.js";import"./isBefore-CNJkrGzj.js";import"./isSameMonth-CLqEvLGB.js";import"./Combination-C3E93Tmq.js";import"./index-BI4Mum8f.js";import"./TextInput-DWv5HYwX.js";import"./createLucideIcon-CsTPi_PJ.js";import"./x-qiv3dzMc.js";import"./settings-IGwliCKm.js";import"./calendar-BVcfjxpo.js";import"./users-DJJ1pSFZ.js";import"./badge-Ba9wLprY.js";import"./bell-CZPeXRDd.js";import"./pusher-Ccn-pyrQ.js";import"./search-CuaPY0cJ.js";import"./layers-CL8FlTVq.js";import"./chart-column-Cz5CfWLB.js";import"./index-DienCGkc.js";const L=({title:g,value:T,icon:t,change:p,bgColor:v="bg-white"})=>e.jsx("div",{className:`${v} rounded-lg shadow-sm hover:shadow-md transition-shadow border-l-4 border-l-primary p-4`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:g}),e.jsx("h3",{className:"text-2xl font-bold mt-1",children:T}),p&&e.jsxs("div",{className:"flex items-center mt-2",children:[p.isPositive?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 text-green-500 mr-1",children:[e.jsx("path",{d:"m5 12 7-7 7 7"}),e.jsx("path",{d:"M12 19V5"})]}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 text-red-500 mr-1",children:[e.jsx("path",{d:"m5 12 7 7 7-7"}),e.jsx("path",{d:"M12 5v14"})]}),e.jsxs("span",{className:`text-xs font-medium ${p.isPositive?"text-green-500":"text-red-500"}`,children:[p.value," total"]})]})]}),e.jsx("div",{className:"p-3 rounded-full bg-accent",children:t})]})}),Qe=({programs:g=[],doctors:T=[],flash:t,activePrograms:p=0,archivedPrograms:v=0,todayAppointments:W=0,totalParticipants:V=0})=>{const[q,w]=n.useState(g),[b,_]=n.useState(""),[A,G]=n.useState("all"),[l,J]=n.useState({key:"name",direction:"ascending"}),[K,F]=n.useState(!1),[I,C]=n.useState((t==null?void 0:t.success)||""),[z,k]=n.useState((t==null?void 0:t.error)||""),[P,N]=n.useState(!1);n.useEffect(()=>{g&&Array.isArray(g)&&(console.log("Programs updated from props:",g),w(g))},[g]),n.useEffect(()=>{if(t!=null&&t.success){C(t.success);const s=setTimeout(()=>C(""),5e3);return()=>clearTimeout(s)}if(t!=null&&t.error){k(t.error);const s=setTimeout(()=>k(""),5e3);return()=>clearTimeout(s)}t!=null&&t.programs&&Array.isArray(t.programs)&&(console.log("Programs updated from flash:",t.programs),w(t.programs))},[t]);const O=[...q.filter(s=>{const i=s.name.toLowerCase().includes(b.toLowerCase())||s.description.toLowerCase().includes(b.toLowerCase())||s.coordinator&&s.coordinator.toLowerCase().includes(b.toLowerCase()),u=A==="all"||s.status===A;return i&&u})].sort((s,i)=>s[l.key]<i[l.key]?l.direction==="ascending"?-1:1:s[l.key]>i[l.key]?l.direction==="ascending"?1:-1:0),Q=s=>{let i="ascending";l.key===s&&l.direction==="ascending"&&(i="descending"),J({key:s,direction:i})},U=async(s,i)=>{var u,f;N(!0);try{const m=i?"/admin/programs/unarchive":"/admin/programs/archive",D=await $.post(m,{program_id:s});D.data.programs&&(w(D.data.programs),C(D.data.message),setTimeout(()=>C(""),3e3))}catch(m){console.error("Error archiving/unarchiving program:",m),k(((f=(u=m.response)==null?void 0:u.data)==null?void 0:f.message)||"An error occurred while updating the program"),setTimeout(()=>k(""),3e3)}finally{N(!1)}},{data:c,setData:d,post:X,processing:R,errors:r,reset:Y}=ee({programname:"",description:"",date:"",starttime:"",endtime:"",location:"",slots:"",coordinatorid:"",status:"Available"}),Z=s=>{s.preventDefault(),N(!0),X(route("admin.programs.create"),{preserveScroll:!0,onSuccess:i=>{var u,f;Y(),F(!1),N(!1),(f=(u=i==null?void 0:i.props)==null?void 0:u.flash)!=null&&f.programs?w(i.props.flash.programs):$.get(route("admin.programs.fetch")).then(m=>{m.data.programs&&w(m.data.programs)}).catch(m=>console.error("Error fetching programs:",m))},onError:()=>{N(!1)}})};return e.jsx(se,{children:e.jsxs("div",{className:"px-4 md:px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(L,{title:"Today's Appointments",value:W,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-primary",children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),e.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),change:{value:W,isPositive:!0}}),e.jsx(L,{title:"Active Health Programs",value:p,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-primary",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})}),change:{value:p,isPositive:!0}}),e.jsx(L,{title:"Archived Programs",value:v,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-primary",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M10 12h4"})]}),change:{value:v,isPositive:!1},bgColor:v>0?"bg-amber-50":"bg-white"}),e.jsx(L,{title:"Total Participants",value:V,icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-primary",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),change:{value:V,isPositive:!0}})]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Health Programs"}),e.jsxs(ae,{open:K,onOpenChange:F,children:[e.jsx(le,{asChild:!0,children:e.jsxs(y,{className:"px-4 py-2 text-sm shadow-md flex items-center justify-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2 h-4 w-4",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),e.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),e.jsx("span",{children:"Create Program"})]})}),e.jsxs(ne,{className:"sm:max-w-[600px] max-h-[80vh] overflow-y-auto",children:[e.jsxs(oe,{className:"",children:[e.jsx(ce,{children:"Create New Health Program"}),e.jsx(de,{children:"Fill in the details to create a new health program."})]}),e.jsxs("form",{onSubmit:Z,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Program Name"}),e.jsx(j,{placeholder:"Enter program name",value:c.programname,onChange:s=>d("programname",s.target.value)}),r.programname&&e.jsx(x,{message:r.programname})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(j,{placeholder:"Enter program description",value:c.description,onChange:s=>d("description",s.target.value)}),r.description&&e.jsx(x,{message:r.description})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Date"}),e.jsx(j,{type:"date",value:c.date,onChange:s=>d("date",s.target.value)}),r.date&&e.jsx(x,{message:r.date})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Time"}),e.jsx(j,{type:"time",value:c.starttime,onChange:s=>d("starttime",s.target.value)}),r.starttime&&e.jsx(x,{message:r.starttime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"End Time"}),e.jsx(j,{type:"time",value:c.endtime,onChange:s=>d("endtime",s.target.value)}),r.endtime&&e.jsx(x,{message:r.endtime})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Location"}),e.jsx(j,{placeholder:"Enter program location",value:c.location,onChange:s=>d("location",s.target.value)}),r.location&&e.jsx(x,{message:r.location})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Available Slots"}),e.jsx(j,{type:"number",placeholder:"Enter number of slots",value:c.slots,onChange:s=>d("slots",s.target.value)}),r.slots&&e.jsx(x,{message:r.slots})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Coordinator"}),e.jsxs(B,{value:c.coordinatorid,onValueChange:s=>d("coordinatorid",s),children:[e.jsx(E,{children:e.jsx(M,{placeholder:"Select coordinator"})}),e.jsx(H,{children:T.map(s=>e.jsxs(o,{value:s.id.toString(),children:["Dr. ",s.lastname]},s.id))})]}),r.coordinatorid&&e.jsx(x,{message:r.coordinatorid})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(B,{value:c.status,onValueChange:s=>d("status",s),children:[e.jsx(E,{children:e.jsx(M,{placeholder:"Select status"})}),e.jsxs(H,{children:[e.jsx(o,{value:"Available",children:"Available"}),e.jsx(o,{value:"Full",children:"Full"}),e.jsx(o,{value:"Cancelled",children:"Cancelled"})]})]}),r.status&&e.jsx(x,{message:r.status})]})]}),e.jsx(me,{className:"sticky bottom-0 bg-transparent pt-4",children:e.jsx(y,{type:"submit",disabled:R||P,className:"px-4 py-2 text-sm shadow-md flex items-center justify-center",children:R||P?"Creating...":"Create Program"})})]})]})]})]}),I&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4",children:e.jsx("span",{className:"block sm:inline",children:I})}),z&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:e.jsx("span",{className:"block sm:inline",children:z})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-400",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),e.jsx(j,{type:"text",placeholder:"Search programs...",className:"pl-10",value:b,onChange:s=>_(s.target.value)})]}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs(B,{value:A,onValueChange:G,children:[e.jsx(E,{children:e.jsx(M,{placeholder:"Filter by status"})}),e.jsxs(H,{children:[e.jsx(o,{value:"all",children:"All Statuses"}),e.jsx(o,{value:"Active",children:"Active"}),e.jsx(o,{value:"Available",children:"Available"}),e.jsx(o,{value:"Completed",children:"Completed"}),e.jsx(o,{value:"Upcoming",children:"Upcoming"}),e.jsx(o,{value:"Cancelled",children:"Cancelled"})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs(S,{children:[e.jsx(h,{className:"cursor-pointer w-1/6",onClick:()=>Q("name"),children:e.jsxs("div",{className:"flex items-center",children:["Program Name",l.key==="name"&&e.jsx("span",{className:"ml-1",children:l.direction==="ascending"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"18 15 12 9 6 15"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"6 9 12 15 18 9"})})})]})}),e.jsx(h,{className:"w-1/6",children:"Description"}),e.jsx(h,{className:"w-1/12",children:"Date"}),e.jsx(h,{className:"w-1/12",children:"Time"}),e.jsx(h,{className:"w-1/12",children:"Location"}),e.jsx(h,{className:"w-1/12",children:"Slots"}),e.jsx(h,{className:"w-1/12",children:"Coordinator"}),e.jsx(h,{className:"w-1/12",children:"Status"}),e.jsx(h,{className:"w-1/12",children:"Actions"})]})}),e.jsx(ie,{children:P?e.jsx(S,{children:e.jsx(a,{colSpan:9,className:"text-center py-8",children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 mr-3 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading programs..."]})})}):O.length===0?e.jsx(S,{children:e.jsx(a,{colSpan:9,className:"text-center py-8",children:"No health programs found."})}):O.map(s=>e.jsxs(S,{children:[e.jsx(a,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-gray-100 rounded-full text-gray-500",children:e.jsx("span",{children:s.name.charAt(0)})}),e.jsx("div",{children:e.jsx("div",{className:"font-medium",children:s.name})})]})}),e.jsx(a,{children:e.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:s.description})}),e.jsx(a,{children:e.jsx("div",{className:"text-sm",children:s.date})}),e.jsx(a,{children:e.jsxs("div",{className:"text-sm",children:[s.startTime," -"," ",s.endTime]})}),e.jsx(a,{children:e.jsx("div",{className:"text-sm",children:s.location})}),e.jsx(a,{children:e.jsxs("div",{className:"text-sm",children:[s.availableSlots,"/",s.totalSlots]})}),e.jsx(a,{children:e.jsx("div",{className:"text-sm",children:s.coordinator})}),e.jsx(a,{children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:s.status})}),e.jsx(a,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(y,{variant:"ghost",size:"sm",className:"text-sm px-3 py-1 shadow-sm flex items-center justify-center",children:e.jsx("span",{children:"View"})}),s.status==="Archived"?e.jsx(y,{variant:"outline",size:"sm",className:"text-sm px-3 py-1 shadow-sm flex items-center justify-center text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>U(s.id,!0),children:e.jsx("span",{children:"Unarchive"})}):e.jsx(y,{variant:"outline",size:"sm",className:"text-sm px-3 py-1 shadow-sm flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>U(s.id,!1),children:e.jsx("span",{children:"Archive"})})]})})]},s.id))})]})})]})})};export{Qe as default};
