import{r as l,j as o,P as W,q as Q,b as X}from"./app-CrmOXkV3.js";import{D as Y,b as J,c as Z,d as ee,f as oe}from"./dialog-DA-L6G9g.js";import{u as _,c as E,B as S}from"./button-BCFPYhF6.js";import{I as R}from"./input-B3DV-ViL.js";import{L as g}from"./label-tIyCpPJP.js";import{a as re}from"./react-icons.esm-CiFVLb4j.js";import{a as ae,c as j}from"./index-eTDgADzU.js";import{c as D}from"./index-DpmVXhiL.js";import{P as k}from"./index-DdZNoNZU.js";import{c as G,R as se,I as te}from"./index-lgj00NZ2.js";import{u as ne}from"./index-BlbX6A03.js";import{a as ce}from"./Combination-h7GQLXQZ.js";import{u as ie}from"./index-B5u2EOKF.js";import{P as de}from"./index-P-Oj2T25.js";import{T as le}from"./textarea-FRJG1SkJ.js";import{P as ue}from"./PrintErrors-BSG9_T6B.js";var N="Radio",[pe,q]=D(N),[me,fe]=pe(N),A=l.forwardRef((a,n)=>{const{__scopeRadio:e,name:u,checked:r=!1,required:s,disabled:i,value:h="on",onCheck:p,form:m,...y}=a,[c,f]=l.useState(null),d=_(n,x=>f(x)),t=l.useRef(!1),v=c?m||!!c.closest("form"):!0;return o.jsxs(me,{scope:e,checked:r,disabled:i,children:[o.jsx(k.button,{type:"button",role:"radio","aria-checked":r,"data-state":M(r),"data-disabled":i?"":void 0,disabled:i,value:h,...y,ref:d,onClick:j(a.onClick,x=>{r||p==null||p(),v&&(t.current=x.isPropagationStopped(),t.current||x.stopPropagation())})}),v&&o.jsx(ve,{control:c,bubbles:!t.current,name:u,value:h,checked:r,required:s,disabled:i,form:m,style:{transform:"translateX(-100%)"}})]})});A.displayName=N;var F="RadioIndicator",O=l.forwardRef((a,n)=>{const{__scopeRadio:e,forceMount:u,...r}=a,s=fe(F,e);return o.jsx(de,{present:u||s.checked,children:o.jsx(k.span,{"data-state":M(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:n})})});O.displayName=F;var ve=a=>{const{control:n,checked:e,bubbles:u=!0,...r}=a,s=l.useRef(null),i=ie(e),h=ce(n);return l.useEffect(()=>{const p=s.current,m=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(m,"checked").set;if(i!==e&&c){const f=new Event("click",{bubbles:u});c.call(p,e),p.dispatchEvent(f)}},[i,e,u]),o.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:e,...r,tabIndex:-1,ref:s,style:{...a.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function M(a){return a?"checked":"unchecked"}var he=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],C="RadioGroup",[xe,Me]=D(C,[G,q]),L=G(),T=q(),[ye,ge]=xe(C),B=l.forwardRef((a,n)=>{const{__scopeRadioGroup:e,name:u,defaultValue:r,value:s,required:i=!1,disabled:h=!1,orientation:p,dir:m,loop:y=!0,onValueChange:c,...f}=a,d=L(e),t=ne(m),[v,x]=ae({prop:s,defaultProp:r,onChange:c});return o.jsx(ye,{scope:e,name:u,required:i,disabled:h,value:v,onValueChange:x,children:o.jsx(se,{asChild:!0,...d,orientation:p,dir:t,loop:y,children:o.jsx(k.div,{role:"radiogroup","aria-required":i,"aria-orientation":p,"data-disabled":h?"":void 0,dir:t,...f,ref:n})})})});B.displayName=C;var V="RadioGroupItem",K=l.forwardRef((a,n)=>{const{__scopeRadioGroup:e,disabled:u,...r}=a,s=ge(V,e),i=s.disabled||u,h=L(e),p=T(e),m=l.useRef(null),y=_(n,m),c=s.value===r.value,f=l.useRef(!1);return l.useEffect(()=>{const d=v=>{he.includes(v.key)&&(f.current=!0)},t=()=>f.current=!1;return document.addEventListener("keydown",d),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",d),document.removeEventListener("keyup",t)}},[]),o.jsx(te,{asChild:!0,...h,focusable:!i,active:c,children:o.jsx(A,{disabled:i,required:s.required,checked:c,...p,...r,name:s.name,ref:y,onCheck:()=>s.onValueChange(r.value),onKeyDown:j(d=>{d.key==="Enter"&&d.preventDefault()}),onFocus:j(r.onFocus,()=>{var d;f.current&&((d=m.current)==null||d.click())})})})});K.displayName=V;var Re="RadioGroupIndicator",$=l.forwardRef((a,n)=>{const{__scopeRadioGroup:e,...u}=a,r=T(e);return o.jsx(O,{...r,...u,ref:n})});$.displayName=Re;var H=B,U=K,je=$;const z=l.forwardRef(({className:a,...n},e)=>o.jsx(H,{className:E("grid gap-2",a),...n,ref:e}));z.displayName=H.displayName;const b=l.forwardRef(({className:a,...n},e)=>o.jsx(U,{ref:e,className:E("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),...n,children:o.jsx(je,{className:"flex items-center justify-center",children:o.jsx(re,{className:"h-3.5 w-3.5 fill-primary"})})}));b.displayName=U.displayName;const Le=({open:a,onClose:n,item:e,onSave:u})=>{var f,d;const{data:r,setData:s,processing:i,errors:h,put:p}=W({type:"",quantity:"",reason:"",expiry:""});l.useEffect(()=>{var t,v,x,I,P,w;e&&(s({type:(t=e==null?void 0:e.stocks_movement[0])==null?void 0:t.type,quantity:0,reason:(v=e==null?void 0:e.stocks_movement[0])==null?void 0:v.reason,expiry:(P=(I=e==null?void 0:e.stocks_movement)==null?void 0:I[((x=e==null?void 0:e.stocks_movement)==null?void 0:x.length)-1])==null?void 0:P.expiry_date}),console.log("item:",e,(w=e==null?void 0:e.stocks_movement[0])==null?void 0:w.type))},[e]);const m=t=>{s(t.target.name,t.target.value)},y=t=>{var v;t.preventDefault(),p(route("admin.inventory.item.stockmovement.update",{movement:(v=e==null?void 0:e.stocks_movement[0])==null?void 0:v.id}),{onFinish:()=>{X.reload({only:["flash","inventory","movements_"]})},onSuccess:()=>{n()}})},{user:c}=Q().props.auth;return o.jsx(Y,{open:a,onOpenChange:n,children:o.jsxs(J,{className:"sm:max-w-[425px]",children:[o.jsx(Z,{children:o.jsx(ee,{children:"Record Stock Movement"})}),o.jsx(ue,{errors:h}),o.jsxs("form",{onSubmit:y,className:"space-y-4 pt-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{children:"Item"}),o.jsx("p",{className:"font-medium",children:e==null?void 0:e.name}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:["Current stock: ",(f=e==null?void 0:e.stock[0])==null?void 0:f.stocks," ",(d=e==null?void 0:e.stock[0])==null?void 0:d.stockname,"s"]})]}),o.jsx("div",{className:"space-y-2",children:o.jsxs("div",{className:"grid grid-cols-2",children:[o.jsxs("div",{children:[o.jsx(g,{children:"Movement Type"}),o.jsxs(z,{value:r.type,onValueChange:t=>s("type",t),className:"flex items-center space-x-2",children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(b,{value:"Incoming",id:"Incoming"}),o.jsx(g,{htmlFor:"Incoming",children:"Incoming"})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(b,{value:"Outgoing",id:"Outgoing"}),o.jsx(g,{htmlFor:"outgoing",children:"Outgoing"})]})]})]}),o.jsxs("div",{children:[o.jsx(g,{children:"Expiry Date"}),o.jsx(R,{id:"expirationDate",type:"date",name:"expirydate",value:r.expiry,onChange:t=>s("expiry",t.target.value)})]})]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"quantity",children:"Quantity"}),o.jsx(R,{id:"quantity",type:"number",...r.type=="Incoming"?{min:"0"}:{max:"0"},name:"quantity",value:r.quantity,onChange:m,required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(g,{htmlFor:"reason",children:["Reason ",r.type==="Outgoing"&&"(Required)"]}),o.jsx(le,{id:"reason",name:"reason",value:r.reason,onChange:m,placeholder:r.type==="Incoming"?"Optional":"Why is this item being removed from inventory?",required:r.type==="Outgoing"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"performedBy",children:"Performed By"}),o.jsx(R,{id:"performedBy",value:`${c==null?void 0:c.firstname} ${c==null?void 0:c.lastname}`,placeholder:"Name of staff member",required:!0})]}),o.jsxs(oe,{className:"pt-4",children:[o.jsx(S,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),o.jsx(S,{type:"submit",className:"bg-primary hover:bg-primary/90",disabled:i,children:"Save Changes"})]})]})]})})};export{Le as default};
