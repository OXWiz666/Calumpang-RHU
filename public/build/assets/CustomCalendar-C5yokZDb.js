import{j as t}from"./app-cg6HAvqA.js";import{R as I,r as y}from"./vendor-C8lGyBmx.js";import{C as U}from"./chevron-left-Cs27DwGq.js";import{C as X}from"./chevron-right-yKj4-WN0.js";import{a as q,i as z}from"./isBefore-COsor6RJ.js";import{C as w}from"./circle-check-big-DhFJ8pYG.js";import{C as h}from"./circle-alert-D5A-RZmA.js";import{C as D}from"./circle-x-Ciat7cPK.js";import{f as i}from"./format-Dp3w_Y3x.js";import{i as G,a as H,s as g,e as b,b as J}from"./isSameMonth-BOwz-_mK.js";import{i as K,e as Q,s as V}from"./subMonths-B67T7BWk.js";import"./pusher-88Z950oj.js";import"./createLucideIcon-CxhiR5tx.js";function Y(u,p,f){return q(u,-1,f)}const he=({selectedDate:u,onDateSelect:p,hasPrograms:f=[],serviceId:m=null,subserviceId:M=null})=>{const[n,v]=I.useState(new Date),[C,E]=y.useState({}),[Z,j]=y.useState(!1),S=async()=>{if(m){j(!0);try{const e=g(n),s=b(n),l=await(await fetch(`/patient/get-date-availability?start_date=${i(e,"yyyy-MM-dd")}&end_date=${i(s,"yyyy-MM-dd")}&service_id=${m}`)).json();if(l.availability){const r={};l.availability.forEach(o=>{r[o.date]=o}),E(r)}}catch(e){console.error("Error fetching date availability:",e)}finally{j(!1)}}};y.useEffect(()=>{S()},[n,m,M]);const A=()=>{const e=g(n),s=b(n);return Q({start:e,end:s})},$=()=>{const e=g(n),s=e.getDay();if(s===0)return[];const a=new Date(e);a.setDate(0);const l=s,r=[];for(let o=0;o<l;o++){const c=new Date(a);c.setDate(a.getDate()-o),r.unshift(c)}return r},k=()=>{const e=b(n),s=e.getDay();if(s===6)return[];const a=6-s,l=[];for(let r=1;r<=a;r++){const o=new Date(e);o.setDate(e.getDate()+r),l.push(o)}return l},O=e=>{e.preventDefault(),v(V(n))},_=e=>{e.preventDefault(),v(J(n,1))},L=(e,s=[])=>{const a=i(e,"EEEE");return s.includes(a)},x=e=>{const s=i(e,"yyyy-MM-dd"),a=C[s];return a?a.appointment_count>=20?"full":a.appointment_count>=15?"limited":a.appointment_count>=10?"moderate":"available":"unknown"},P=e=>{switch(x(e)){case"available":return t.jsx(w,{className:"h-3 w-3 text-green-500"});case"moderate":return t.jsx(h,{className:"h-3 w-3 text-yellow-500"});case"limited":return t.jsx(h,{className:"h-3 w-3 text-orange-500"});case"full":return t.jsx(D,{className:"h-3 w-3 text-red-500"});default:return null}},R=e=>{switch(x(e)){case"available":return"bg-green-100 border-green-300";case"moderate":return"bg-yellow-100 border-yellow-300";case"limited":return"bg-orange-100 border-orange-300";case"full":return"bg-red-100 border-red-300";default:return""}},T=[...$(),...A(),...k()],B=["Su","Mo","Tu","We","Th","Fr","Sa"];return t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("button",{onClick:O,className:"p-1 rounded-full hover:bg-gray-100","aria-label":"Previous month",children:t.jsx(U,{className:"h-5 w-5"})}),t.jsx("h2",{className:"text-base font-medium",children:i(n,"MMMM yyyy")}),t.jsx("button",{onClick:_,className:"p-1 rounded-full hover:bg-gray-100","aria-label":"Next month",children:t.jsx(X,{className:"h-5 w-5"})})]}),t.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[B.map(e=>t.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-1",children:e},e)),T.map((e,s)=>{const a=G(e,n),l=u&&H(e,u),r=L(e,f),o=K(e);i(e,"EEEE");const c=z(Y(new Date),e),d=x(e),N=P(e),W=R(e);return t.jsxs("button",{onClick:F=>{F.preventDefault(),p(e)},disabled:!c||!r||d==="full",className:`
                h-9 w-9 mx-auto flex flex-col items-center justify-center rounded-full text-sm relative
                ${a?"":"text-gray-400"}
                ${l?"bg-blue-500 text-white":""}
                ${r&&!l&&c?`bg-blue-100 ${W}`:""}
                ${o&&!l?"border border-blue-500":""}
                ${d==="full"?"opacity-50 cursor-not-allowed":""}
                hover:bg-gray-100
              `,title:d!=="unknown"?`${d.charAt(0).toUpperCase()+d.slice(1)} slots`:"No data available",children:[t.jsx("span",{className:"text-xs",children:i(e,"d")}),N&&t.jsx("div",{className:"absolute -top-1 -right-1",children:N})]},s)})]}),m&&t.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Slot Availability Legend:"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(w,{className:"h-3 w-3 text-green-500"}),t.jsx("span",{children:"Available (0-9 slots)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(h,{className:"h-3 w-3 text-yellow-500"}),t.jsx("span",{children:"Moderate (10-14 slots)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(h,{className:"h-3 w-3 text-orange-500"}),t.jsx("span",{children:"Limited (15-19 slots)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(D,{className:"h-3 w-3 text-red-500"}),t.jsx("span",{children:"Full (20+ slots)"})]})]})]})]})};export{he as default};
