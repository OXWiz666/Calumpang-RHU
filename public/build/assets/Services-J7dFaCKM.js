import{r as i,P as F,j as e,a as Y,R as He}from"./app-UqCpiIdu.js";import{C as Z}from"./react-icons.esm-ClOhj1e1.js";import{B as l}from"./button-Dc7u8QDw.js";import{I as P}from"./input-nH8cgwep.js";import"./avatar-ONeLcBIA.js";import{B as h}from"./badge-B7RRfMqe.js";import{S as Le,T as ee,a as se,b as j,c as o,d as re,e as d}from"./table2-YyHaV1Ae.js";import{S as ze,a as Fe,b as Pe,c as _e,d as _}from"./select-zZFs7G37.js";import{D as w,b as C,c as D,d as A,e as T,f as k,a as B}from"./dialog-BvsLsSlP.js";import{L as v}from"./label-BZTosVXq.js";import"./textarea-IBhXjCiU.js";import Be from"./Sidebar-DWWlBYso.js";import Re from"./ServicesLayout-Z0p_TOmH.js";import{h as ae}from"./moment-C5S46NFB.js";import{F as Ve}from"./filter-Cl8MAikY.js";import{C as Ue}from"./chevron-up-CcUnRYy-.js";import{C as Ke}from"./chevron-down-ChalODg1.js";import{S as ie}from"./square-pen-BOk4O3dw.js";import{T as te}from"./trash-2-DCZwsM8H.js";import"./utils-BIt4jM2L.js";import"./index-Jl_-19Lz.js";import"./index-CJ2_gmve.js";import"./createLucideIcon-C-dqTopi.js";import"./arrow-up-DiPSyg50.js";import"./index-ButbMP_r.js";import"./index-DLskqj0c.js";import"./floating-ui.react-dom-Bfh-1F6-.js";import"./Combination-DClnaD2M.js";import"./index-DMPZiVDP.js";import"./card-4qkd8LXk.js";import"./alert-CyRZug9g.js";import"./separator-BKUk800T.js";import"./square-kanban-B0ePcIPT.js";import"./layers-B6sjy-5s.js";import"./CustomModal-C9r3OEUS.js";import"./AdminLayout-Bejlh3wB.js";import"./popover-DBUS5Ycd.js";import"./format-BtYX0kVO.js";import"./isBefore-CNJkrGzj.js";import"./isSameMonth-CLqEvLGB.js";import"./TextInput-BfxfzgLR.js";import"./x-BRhaHkdB.js";import"./settings-UUHVa541.js";import"./calendar-2Qud1qOZ.js";import"./users-CjpBR3SU.js";import"./bell-NYWenmIq.js";import"./pusher-C0d9aCvm.js";import"./autoprefixer-D4hvIyLA.js";import"./search-NdGQvtQY.js";import"./chart-column-DSijlenk.js";import"./InputLabel-DpH7HOvt.js";import"./circle-plus-BZpMdstC.js";const Js=({services_:g})=>{const[R,M]=i.useState(g),[ce,We]=i.useState(""),[E,ne]=i.useState("all"),[O,S]=i.useState(!1),[x,$e]=i.useState({key:"servicename",direction:"ascending"}),[qe,le]=i.useState(!1),de=(r=!1)=>{le(r)};i.useEffect(()=>{M(g),console.log("services: ",g)},[g]);const[V,b]=i.useState(!1),[I,oe]=i.useState(null),[H,U]=i.useState(!1),[f,K]=i.useState({servicename:"",status:"Active"}),[me,Ge]=i.useState({name:"",description:"",duration:30,price:0,recurrenceDates:[]});[...R.filter(r=>{const s=r.servicename.toLowerCase().includes(ce.toLowerCase()),t=E==="all"||r.status===E;return s&&t})].sort((r,s)=>r[x.key]<s[x.key]?x.direction==="ascending"?-1:1:r[x.key]>s[x.key]?x.direction==="ascending"?1:-1:0);const[he,W]=i.useState(null),xe=r=>{H===r?(U(null),W(null)):(U(r),W(r))},ue=r=>{z(s=>({...s,days:s.days.includes(r)?s.days.filter(t=>t!==r):[...s.days,r]}))},pe=()=>{ge(route("admin.services.subservice.create"),{preserveScroll:!0,preserveState:!0,only:["services_"],onSuccess:()=>{b(!1),alert_toast("Success","Sub-Service added successfully!")}})},$=async(r,s)=>{var t,p;S(!0);try{const a=s?"/admin/services/unarchive":"/admin/services/archive",c=await Y.post(a,{service_id:r});c.data.services&&(M(c.data.services),alert_toast("Success",c.data.message))}catch(a){console.error("Error archiving/unarchiving service:",a),alert_toast("Error",((p=(t=a.response)==null?void 0:t.data)==null?void 0:p.message)||"An error occurred while updating the service")}finally{S(!1)}},je=r=>{switch(r){case 1:return e.jsx(h,{className:"bg-green-500",children:"Active"});case 0:return e.jsx(h,{className:"bg-gray-500",children:"Inactive"});default:return e.jsx(h,{children:r})}},{data:q,setData:L,processing:ve,post:ge}=F({serviceid:"",subservicename:""}),[Se,G]=i.useState(!1),{data:be,setData:z,post:fe,processing:ye,errors:J}=F({days:me.recurrenceDates,serviceid:he}),Ne=()=>{fe(route("admin.services.days.update"),{preserveScroll:!0,preserveState:!0,replace:!0,only:["services_"],onSuccess:()=>{G(!1),alert_toast("Success!","Successfully Updated!","success")}})},we=["09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","01:00 PM","01:30 PM","02:00 PM","02:30 PM","03:00 PM","03:30 PM","04:00 PM"],[Ce,Qe]=i.useState([]),[De,Ae]=i.useState({}),[Te,Q]=i.useState(!1),{data:y,setData:u,processing:ke,post:Me,errors:X}=F({times:Ce,subservice_id:De,subservicename:""}),Ee=r=>{u(s=>({...s,times:s.times.includes(r)?s.times.filter(t=>t!==r):[...s.times,r]}))},Oe=r=>{Me(route("admin.services.time.update"),{preserveScroll:!0,onSuccess:()=>{Q(!1),alert_toast("Success!","Successfully Updated!","success")}})},Ie=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return i.useEffect(()=>{console.log("datatime; ",y)},[y]),e.jsxs(Re,{children:[e.jsxs("div",{className:" mb-5",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Services"}),e.jsx("p",{className:"text-gray-600",children:"These are the services to be used in the Appointment Schedules."}),e.jsx("p",{className:"text-muted-foreground"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx(Be,{activeTab:"services"}),e.jsxs("div",{className:"bg-accent/20 rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-primary",children:"All Services"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{open:V,onOpenChange:r=>{b(r),r||K({servicename:"",status:"Active"})},children:e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(A,{children:"Add New Service"}),e.jsx(T,{children:"Create a new service for appointments."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{htmlFor:"servicename",className:"text-right",children:"Service Name"}),e.jsx(P,{id:"servicename",name:"servicename",className:"col-span-3",value:f.servicename,onChange:r=>K({...f,servicename:r.target.value})})]})}),e.jsx(k,{children:e.jsx(l,{type:"submit",onClick:async()=>{var r,s;try{S(!0);const t=await Y.post("/admin/services/create",f);t.data.services&&(M(t.data.services),b(!1),alert_toast("Success","Service added successfully!"))}catch(t){console.error("Error creating service:",t),alert_toast("Error",((s=(r=t.response)==null?void 0:r.data)==null?void 0:s.message)||"An error occurred while creating the service")}finally{S(!1)}},disabled:!f.servicename||O,children:"Save Service"})})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Filter by:"})]}),e.jsxs(ze,{value:E,onValueChange:ne,children:[e.jsx(Fe,{className:"w-[180px]",children:e.jsx(Pe,{placeholder:"Status"})}),e.jsxs(_e,{children:[e.jsx(_,{value:"all",children:"All Statuses"}),e.jsx(_,{value:"Active",children:"Active"}),e.jsx(_,{value:"Inactive",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsx(Le,{data:R,defaultSort:{key:"servicename",direction:"asc"},children:({sortedData:r})=>e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(j,{children:[e.jsx(o,{}),e.jsx(o,{sortKey:"servicename",sortable:!0,children:"Service Name"}),e.jsx(o,{sortKey:"status",sortable:!0,children:"Status"}),e.jsx(o,{children:"Available Days"}),e.jsx(o,{sortKey:"servicename",sortable:!0,children:"Sub Services"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(re,{children:r.map((s,t)=>{var p;return e.jsxs(He.Fragment,{children:[e.jsxs(j,{children:[e.jsx(d,{children:e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>xe(s.id),children:H===s.id?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Ke,{className:"h-4 w-4"})})}),e.jsx(d,{children:s.servicename}),e.jsx(d,{children:je(s.status)}),e.jsx(d,{className:" grid gap-1",children:(p=s==null?void 0:s.servicedays)==null?void 0:p.map((a,c)=>e.jsx(h,{className:"bg-primary",children:a.day},c))}),e.jsx(d,{children:(s==null?void 0:s.subservices.length)<=0?e.jsx("div",{children:"No Sub Services"}):e.jsxs("div",{children:[s==null?void 0:s.subservices.length," Service",(s==null?void 0:s.subservices.length)>1?"s":""]})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[s.status===0?e.jsxs(l,{variant:"outline",size:"sm",className:"text-green-600 hover:text-green-700 hover:bg-green-50 flex items-center gap-1",onClick:()=>$(s.id,!0),disabled:O,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M12 12v7"}),e.jsx("path",{d:"M8 12l4-4 4 4"})]}),"Unarchive"]}):e.jsxs(l,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-1",onClick:()=>$(s.id,!1),disabled:O,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M12 19V12"}),e.jsx("path",{d:"M8 15l4 4 4-4"})]}),"Archive"]}),e.jsxs(w,{open:V,onOpenChange:a=>{b(a),a&&L("serviceid",s.id)},children:[e.jsx(B,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",children:"Add Sub-service"})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Add Sub-service to ",s.servicename]}),e.jsx(T,{children:"Create a new sub-service for this service category."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{htmlFor:"subName",className:"text-right",children:"Sub Service"}),e.jsx(P,{id:"subName",name:"name",value:q.subservicename,onChange:a=>{L("subservicename",a.target.value)},className:"col-span-3"})]})}),e.jsx(k,{children:e.jsx(l,{type:"submit",onClick:pe,disabled:!q.subservicename||ve,children:"Save Sub-service"})})]})]}),e.jsxs(w,{open:Se,onOpenChange:a=>{var c;G(a),a&&(z("days",((c=s==null?void 0:s.servicedays)==null?void 0:c.map(N=>N.day))||[]),z("serviceid",s.id))},children:[e.jsx(B,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{oe(s)},children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Edit Days to"," ",I==null?void 0:I.servicename]}),e.jsx(T,{children:"Edit days for this service category."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{className:"text-right",children:"Available Days"}),Ie.map(a=>e.jsx(h,{className:`cursor-pointer ${be.days.includes(a)?"bg-primary":"bg-muted text-red-500"}`,onClick:()=>ue(a),children:a},a))]}),Object.keys(J).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("ul",{className:"text-sm text-red-600",children:Object.entries(J).map(([a,c])=>e.jsx("li",{children:c},a))})})]})})]}),e.jsx(k,{children:e.jsx(l,{onClick:a=>{Ne()},disabled:ye,children:"Save Days"})})]})]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{de(!0),L("subservicename",s.servicename)},children:e.jsx(te,{className:"h-4 w-4 text-red-500"})})]})})]}),H===s.id&&e.jsx(j,{children:e.jsx(d,{colSpan:6,className:"p-0",children:e.jsxs("div",{className:"bg-muted/20 p-4",children:[e.jsxs("h3",{className:"font-medium mb-2",children:["Sub-services for ",s.servicename]}),s.subservices.length>0?e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(j,{children:[e.jsx(o,{children:"Sub Service"}),e.jsx(o,{children:"Available Time"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(re,{children:s==null?void 0:s.subservices.map((a,c)=>{var N;return e.jsxs(j,{children:[e.jsx(d,{children:a.subservicename}),e.jsx(d,{children:(N=a==null?void 0:a.times)==null?void 0:N.map((n,m)=>e.jsx(h,{className:"cursor-pointer bg-primary",children:ae(n.time,"HH:mm:ss").format("hh:mm A")},m))}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsxs(w,{open:Te,onOpenChange:n=>{Q(n),n&&(console.log("selected: ",a.subservicename),u("subservice_id",a.id),Ae(a),u("subservicename",a.subservicename),u("times",a==null?void 0:a.times.map(m=>ae(m.time,"HH:mm:ss").format("hh:mm A"))))},children:[e.jsx(B,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Edit Time to"," ",s==null?void 0:s.name]}),e.jsx(T,{children:"Edit days for this sub service category"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx(v,{children:"Sub-Service:"}),e.jsx(P,{className:" w-full",value:y.subservicename,onChange:n=>{u("subservicename",n.target.value)}}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{className:" text-right",children:"Available Time:"}),we.map((n,m)=>e.jsx(h,{className:`cursor-pointer ${y.times.includes(n)?"bg-primary":"bg-muted text-red-500"}`,onClick:()=>Ee(n),children:n},m))]})]}),e.jsxs(k,{children:[Object.keys(X).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("ul",{className:"text-sm text-red-600",children:Object.entries(X).map(([n,m])=>e.jsx("li",{children:m},n))})})]})}),e.jsx(l,{onClick:Oe,disabled:ke,children:"Save Time"})]})]})]}),e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(te,{className:"h-4 w-4 text-red-500"})})]})})]},c)})})]}):e.jsx("p",{className:"text-muted-foreground",children:"No sub-services found for this service."})]})})})]},t)})})]})})})]})]})]})};export{Js as default};
