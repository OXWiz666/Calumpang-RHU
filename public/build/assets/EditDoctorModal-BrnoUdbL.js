import{j as e,r as v}from"./app-4lbu88kA.js";import{r as u}from"./vendor-DkBadjUr.js";import{B as w}from"./button-BXpDG3fF.js";import{I as o}from"./input-N5zOrGrX.js";import{L as l}from"./label-xH30sM7L.js";import"./textarea-CpaS5p9M.js";import{C as N,a as S,b as _,e as y,c as C}from"./card-luqOxrG8.js";import{S as E,a as L,b as I,c as k,d as f}from"./select-C-0693IG.js";import{D as P,a as M,b as O,c as R}from"./dialog-vlGViv4z.js";import{S as A}from"./stethoscope-QcN9KdKi.js";import{m as B}from"./proxy-Dc_Gbux2.js";import{S as U}from"./save-CAdd64LS.js";import"./pusher-DVtoYAOu.js";import"./index-BzPzP57-.js";import"./react-icons.esm-CCKgqiWC.js";import"./index-DyRdtInp.js";import"./index-DO3t3vkD.js";import"./index-KF1t5bS2.js";import"./tslib.es6-M_FJ09fS.js";import"./index-Dyxvh50g.js";import"./index-BHGKAdXF.js";import"./index-DqxisvwK.js";import"./index-BWRETVzy.js";import"./index-MO574hLd.js";import"./createLucideIcon-BKWaAi2G.js";function me({doctor:t,isOpen:D,onClose:p,onSuccess:j}){const g=a=>({1:"active",2:"inactive",3:"suspended"})[a]||"active",[r,b]=u.useState({firstname:t?.firstname||"",lastname:t?.lastname||"",email:t?.email||"",contactno:t?.contactno||"",license_number:t?.license_number||"",status:g(t?.status),role_id:t?.role_id||2,password:"",password_confirmation:""}),[x,d]=u.useState(!1),[s,m]=u.useState({});u.useEffect(()=>{t&&b({firstname:t.user?.firstname||"",lastname:t.user?.lastname||"",email:t.user?.email||"",contactno:t.user?.contactno||"",license_number:t.user?.license_number||"",status:g(t.status),role_id:t.role_id||2,password:"",password_confirmation:""})},[t]);const n=(a,i)=>{b(h=>({...h,[a]:i}))},F=a=>{a.preventDefault(),d(!0),m({});const i={};if(r.password&&!r.password_confirmation&&(i.password_confirmation="Please confirm your new password."),r.password&&r.password_confirmation&&r.password!==r.password_confirmation&&(i.password_confirmation="Passwords do not match."),r.password&&r.password.length<8&&(i.password="Password must be at least 8 characters."),Object.keys(i).length>0){m(i),d(!1);return}console.log("Submitting doctor update:",{route:route("doctor.update",t.user?.id),formData:r,doctorId:t.user?.id});const h={...r,contactno:String(r.contactno)};v.put(route("doctor.update",t.user?.id),h,{onSuccess:c=>{console.log("Update successful:",c),m({}),c.props.flash?.success,console.log("Calling onSuccess callback with:",r),j&&j(r),v.reload({only:["doctorsitems","doctors"]}),p(),d(!1)},onError:c=>{console.error("Update failed:",c),console.error("Error details:",JSON.stringify(c,null,2)),console.error("Form data being sent:",r),console.error("Route being used:",route("doctor.update",t.user?.id)),m(c),d(!1)},onFinish:()=>{console.log("Request finished")}})};return e.jsx(P,{open:D,onOpenChange:p,children:e.jsxs(M,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(O,{children:e.jsxs(R,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(A,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Edit Doctor Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update doctor information and medical credentials"})]})]})}),e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[Object.keys(s).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Please correct the following errors:"}),e.jsx("ul",{className:"mt-2 text-sm text-red-700 list-disc list-inside",children:Object.entries(s).map(([a,i])=>e.jsx("li",{children:i},a))})]})]})}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs(N,{children:[e.jsxs(S,{className:"pb-3",children:[e.jsx(_,{className:"text-lg",children:"Personal Information"}),e.jsx(y,{children:"Basic doctor account details"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"firstname",children:"First Name "}),e.jsx(o,{id:"firstname",value:r.firstname,onChange:a=>n("firstname",a.target.value),className:s.firstname?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),s.firstname&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.firstname})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"lastname",children:"Last Name "}),e.jsx(o,{id:"lastname",value:r.lastname,onChange:a=>n("lastname",a.target.value),className:s.lastname?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),s.lastname&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.lastname})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email Address "}),e.jsx(o,{id:"email",type:"email",value:r.email,onChange:a=>n("email",a.target.value),className:s.email?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),s.email&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"contactno",children:"Contact Number "}),e.jsx(o,{id:"contactno",value:r.contactno,onChange:a=>n("contactno",a.target.value),className:s.contactno?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),s.contactno&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.contactno})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"license_number",children:"Medical License Number "}),e.jsx(o,{id:"license_number",value:r.license_number,onChange:a=>n("license_number",a.target.value),placeholder:"Enter medical license number",className:s.license_number?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),s.license_number&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.license_number})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"status",children:"Account Status"}),e.jsxs(E,{value:r.status,onValueChange:a=>n("status",a),children:[e.jsx(L,{children:e.jsx(I,{placeholder:"Select status"})}),e.jsxs(k,{children:[e.jsx(f,{value:"active",children:"Active"}),e.jsx(f,{value:"inactive",children:"Inactive"}),e.jsx(f,{value:"suspended",children:"Suspended"})]})]})]})]})]}),e.jsxs(N,{children:[e.jsxs(S,{className:"pb-3",children:[e.jsx(_,{className:"text-lg",children:"Security Settings"}),e.jsx(y,{children:"Update account password"})]}),e.jsx(C,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:"New Password"}),e.jsx(o,{id:"password",type:"password",value:r.password,onChange:a=>n("password",a.target.value),placeholder:"Leave blank to keep current password",className:s.password?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),s.password&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password_confirmation",children:"Confirm New Password"}),e.jsx(o,{id:"password_confirmation",type:"password",value:r.password_confirmation,onChange:a=>n("password_confirmation",a.target.value),placeholder:"Confirm new password",className:s.password_confirmation?"border-red-500 focus:border-red-500 focus:ring-red-500":""}),s.password_confirmation&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.password_confirmation})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(w,{type:"button",variant:"outline",onClick:p,disabled:x,children:"Cancel"}),e.jsx(w,{type:"submit",disabled:x,className:"min-w-[120px]",children:x?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Save Changes"]})})]})]})]})]})})}export{me as default};
