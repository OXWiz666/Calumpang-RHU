import{j as e,a as u}from"./app-Ci6FsPEI.js";import{r as N}from"./vendor-DkBadjUr.js";import{D as b,a as f,b as y,c as v}from"./dialog-NMjAdLkI.js";import{B as x}from"./button-CNgURIMK.js";import{B as w}from"./badge-B0i2gCu5.js";import{P as D}from"./printer-CfgcPaUh.js";import{F as P}from"./file-text-YZXa1D2L.js";import{P as _}from"./package-L7rgkkVO.js";import{C as I}from"./circle-check-big-BQVCuGNJ.js";import{P as C}from"./pill-DIGxtF-3.js";const q=({isOpen:c,onClose:n,notification:s})=>{if(!s)return null;const t=(a=>{const r={prescriptionId:"",patientName:"",pharmacistName:"",medicines:[],timestamp:s.created_at},d=a.match(/RX-(\d+)/);d&&(r.prescriptionId=`RX-${d[1]}`);const m=a.match(/to\s+([^,]+)/);m&&(r.patientName=m[1].trim());const o=a.match(/by\s+([^(]+)/);o&&(r.pharmacistName=o[1].trim());const p=a.match(/•\s+([^-]+)\s+-\s+(\d+)\s+(\w+)/g);return p&&(r.medicines=p.map(j=>{const l=j.match(/•\s+([^-]+)\s+-\s+(\d+)\s+(\w+)/);return{name:l[1].trim(),quantity:parseInt(l[2]),unit:l[3]}})),r})(s.data.message),h=a=>{switch(a){case"prescription_dispensed":case"admin_dispense_activity":return e.jsx(I,{className:"h-6 w-6 text-green-600"});case"prescription_ready":return e.jsx(_,{className:"h-6 w-6 text-blue-600"});default:return e.jsx(P,{className:"h-6 w-6 text-gray-600"})}},g=a=>{switch(a){case"prescription_dispensed":case"admin_dispense_activity":return"bg-green-50 border-green-200";case"prescription_ready":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return e.jsx(b,{open:c,onOpenChange:n,children:e.jsxs(f,{className:"max-w-lg",children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${g(s.data.type)}`,children:h(s.data.type)}),e.jsxs("div",{children:[e.jsx(v,{className:"text-2xl font-bold text-gray-800",children:s.data.title}),e.jsx("p",{className:"text-gray-600",children:"Notification Details"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-base mb-2 text-gray-800",children:"Notification Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx(w,{variant:s.read_at?"secondary":"default",className:"text-base px-3 py-1",children:s.read_at?"Read":"Unread"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Time:"}),e.jsx("p",{className:"font-semibold",children:new Date(s.created_at).toLocaleString()})]})]})]}),t.prescriptionId&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-base mb-2 text-blue-800",children:"Prescription Information"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-blue-600",children:"Prescription ID:"}),e.jsx("p",{className:"font-semibold",children:t.prescriptionId})]})})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-base mb-2 text-purple-800",children:"Patient Information"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-purple-600",children:"Patient Name:"}),e.jsx("p",{className:"font-semibold",children:t.patientName})]})})]})]}),t.medicines.length>0&&e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-base mb-2 text-green-800",children:"Dispensed Medicines"}),e.jsx("div",{className:"space-y-2",children:t.medicines.map((a,r)=>e.jsx("div",{className:"bg-white p-2 rounded-lg border border-green-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",a.quantity," ",a.unit]})]})]})})},r))})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-base mb-2 text-gray-800",children:"Staff Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Dispensing Pharmacist:"}),e.jsx("p",{className:"font-semibold",children:t.pharmacistName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Dispense Time:"}),e.jsx("p",{className:"font-semibold",children:new Date(s.created_at).toLocaleString()})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-base mb-2 text-gray-800",children:"Full Message"}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:s.data.message})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(x,{type:"button",variant:"outline",onClick:n,children:"Close"}),e.jsxs(x,{type:"button",onClick:()=>{window.print()},className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Print Summary"]})]})]})})};function X({channelName:c="notification",eventName:n="notification-event",onEvent:s=i=>{}}){const{auth:i}=u().props;return N.useEffect(()=>{if(!i.user?.id)return;const t=window.Echo.private(`${c}.${i.user.id}`);return t.listen(`.${n}`,s),()=>{window.Echo.leave(`${c}.${i.user.id}`),t.stopListening(`.${n}`)}},[i.user?.id]),null}export{q as N,X as P};
