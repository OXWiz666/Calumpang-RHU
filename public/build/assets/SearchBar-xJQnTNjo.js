import{r as u,j as c}from"./app-G8iqleJv.js";import{I as y}from"./input-DFrqRW5G.js";import{B as g}from"./button-B_LnOuxf.js";import{S}from"./search-DqXpTf7V.js";import"./utils-k0UhslF6.js";import"./createLucideIcon-CtVvwcl8.js";const D=({items:l,onSearch:d})=>{const[n,h]=u.useState(""),[i,w]=u.useState([]),[C,m]=u.useState(!1);u.useEffect(()=>{if(n.length>1){const e=l.map(t=>t.name),r=[...new Set(l.map(t=>t.category.name))],o=l.map(t=>{var b,x;return(x=(b=t.stocks_movement)==null?void 0:b[0])==null?void 0:x.batch_number}).filter(Boolean),s=e.filter(t=>t.toLowerCase().includes(n.toLowerCase())),a=r.filter(t=>t.toLowerCase().includes(n.toLowerCase())),v=o.filter(t=>t.toLowerCase().includes(n.toLowerCase()));w([...s,...a,...v]),m(!0)}else w([]),m(!1)},[n,l]);const f=()=>{const e=l.filter(r=>{var o,s,a;return r.name.toLowerCase().includes(n.toLowerCase())||r.category.name.toLowerCase().includes(n.toLowerCase())||((a=(s=(o=r.stocks_movement)==null?void 0:o[0])==null?void 0:s.batch_number)==null?void 0:a.toLowerCase().includes(n.toLowerCase()))});d(e),m(!1)},p=e=>{e.key==="Enter"&&f()},L=e=>{h(e),m(!1);const r=l.filter(o=>{var s,a;return o.name===e||o.category.name===e||((a=(s=o.stocks_movement)==null?void 0:s[0])==null?void 0:a.batch_number)===e});d(r.length>0?r:l.filter(o=>{var s,a;return o.name.toLowerCase().includes(e.toLowerCase())||o.category.name.toLowerCase().includes(e.toLowerCase())||((a=(s=o.stocks_movement)==null?void 0:s[0])==null?void 0:a.batch_number.toLowerCase().includes(e.toLowerCase()))}))};return c.jsxs("div",{className:"relative w-full max-w-2xl mx-auto mb-6",children:[c.jsxs("div",{className:"flex",children:[c.jsx(y,{type:"text",placeholder:"Search by medicine name, batch number or category...",value:n,onChange:e=>h(e.target.value),onKeyDown:p,className:"flex-grow rounded-r-none focus-visible:ring-2 focus-visible:ring-primary"}),c.jsxs(g,{onClick:f,className:"rounded-l-none",children:[c.jsx(S,{className:"h-4 w-4 mr-2"}),"Search"]})]}),C&&i.length>0&&c.jsx("div",{className:"absolute z-10 w-full bg-white border border-gray-200 rounded-md shadow-lg mt-1 max-h-60 overflow-y-auto",children:i.map((e,r)=>c.jsxs("div",{className:"px-4 py-2 hover:bg-muted cursor-pointer",onClick:()=>L(e),children:[c.jsx("span",{children:e}),l.some(o=>{var s,a;return((a=(s=o.stocks_movement)==null?void 0:s[0])==null?void 0:a.batch_number)===e})&&c.jsx("span",{className:"text-xs text-muted-foreground",children:"Batch Number"})]},r))})]})};export{D as default};
