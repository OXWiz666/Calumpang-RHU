import{u as V,j as e,r as A}from"./app-CGmst3US.js";import{r as _}from"./vendor-DkBadjUr.js";import{D as B,a as T,b as L,c as O,d as P}from"./dialog-Co4q8fL2.js";import{B as k}from"./button-DtZ_znIb.js";import{I as u}from"./input-BuECbsc9.js";import{L as n}from"./label-0pL2i4V4.js";import{T as Q}from"./textarea-CUIAzkg5.js";import{z as h}from"./index-WHihrx3k.js";import{S as w,a as I,b as q,c as S,d as C}from"./select-ejg9VjWT.js";import{U as $}from"./unitOptions-DzV97WAR.js";import{P as H}from"./plus-MavOGQlj.js";import{B as z}from"./building-2-DmPcAwng.js";import{M as U}from"./map-pin-Dkn0BYKY.js";import{H as R}from"./hash-AgYeaIxt.js";import{C as X}from"./calendar-D9APQM2e.js";import"./pusher-DVtoYAOu.js";import"./react-icons.esm-BcXWgb92.js";import"./index-B_PSVOSg.js";import"./index-Cjp041Hy.js";import"./tslib.es6-M_FJ09fS.js";import"./index-2wpBnRWd.js";import"./index-LtWw14r9.js";import"./index-BKpF1J_r.js";import"./index-CpVr_lH3.js";import"./index-D9Xmp41c.js";import"./index-DqxisvwK.js";import"./index-BjixZ4b8.js";import"./createLucideIcon-BKWaAi2G.js";const _e=({open:f,onClose:y,categories:E=[]})=>{const[c,x]=_.useState({}),{data:t,setData:j,post:F,processing:N,errors:s,clearErrors:D}=V({itemname:"",categoryid:"",manufacturer:"",description:"",quantity:0,unit_type:"",minimum_stock:0,maximum_stock:0,storage_location:"",batch_number:"",expiry_date:""});_.useEffect(()=>{f&&(D(),x({}))},[f]);const d=a=>{const{name:m,value:r,type:p,checked:g}=a.target;if(j(m,p==="checkbox"?g:r),p==="number"&&(m==="minimum_stock"||m==="maximum_stock")){const o=parseInt(r)||0,i={...c};if(delete i.minimum_stock,delete i.maximum_stock,o<0)i[m]=`${m==="minimum_stock"?"Minimum":"Maximum"} stock level cannot be negative.`;else{const l=m==="minimum_stock"?o:parseInt(t.minimum_stock)||0,b=m==="maximum_stock"?o:parseInt(t.maximum_stock)||0;l>0&&b>0&&l>=b&&(m==="minimum_stock"?i.minimum_stock="Minimum stock level must be less than maximum stock level.":i.maximum_stock="Maximum stock level must be greater than minimum stock level.")}x(i)}if(p==="number"&&m==="quantity"){const o=parseInt(r)||0,i=parseInt(t.maximum_stock)||0,l={...c};delete l.quantity,o<0?l.quantity="Quantity cannot be negative.":i>0&&o>i&&(l.quantity=`Quantity cannot exceed maximum stock level of ${i}`),x(l)}if(p==="number"&&m==="maximum_stock"){const o=parseInt(r)||0,i=parseInt(t.quantity)||0,l={...c};o>0&&i>o?l.quantity=`Quantity cannot exceed maximum stock level of ${o}`:delete l.quantity,x(l)}},v=(a,m)=>{j(a,m)},M=a=>{if(a.preventDefault(),!t.itemname.trim()||!t.categoryid||!t.unit_type||t.quantity<=0||!t.batch_number.trim()||!t.expiry_date||new Date(t.expiry_date)<=new Date)return;if(Object.keys(c).length>0){h.error("Please fix the validation errors before submitting.");return}const m=parseInt(t.minimum_stock)||0,r=parseInt(t.maximum_stock)||0,p=parseInt(t.quantity)||0;if(m>0&&r>0&&m>r){x({minimum_stock:"Minimum stock level cannot be greater than maximum stock level."}),h.error("Minimum stock level cannot be greater than maximum stock level.");return}if(r>0&&p>r){x({quantity:`Quantity cannot exceed maximum stock level of ${r}`}),h.error(`Quantity cannot exceed maximum stock level of ${r}`);return}F(route("pharmacist.inventory.item.add"),{onSuccess:()=>{console.log("Item added successfully"),h.success("Item added successfully!"),y(),A.visit(window.location.pathname,{method:"get"})},onError:g=>{console.error("Validation errors:",g),g.itemname?h.error(g.itemname):h.error("Failed to add item. Please check all fields.")}})};return e.jsx(B,{open:f,onOpenChange:y,children:e.jsxs(T,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsx(L,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:e.jsx(H,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(O,{className:"text-xl font-semibold",children:"Add New Inventory Item"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Enter the details for the new inventory item. All required fields must be completed."})]})]})}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"itemname",className:"text-sm font-medium",children:"Item Name *"}),e.jsx(u,{id:"itemname",name:"itemname",value:t.itemname,onChange:d,placeholder:"e.g., Amoxicillin 500mg",className:"w-full",required:!0}),s.itemname&&e.jsx("p",{className:"text-sm text-red-600",children:s.itemname})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"categoryid",className:"text-sm font-medium",children:"Category *"}),e.jsxs(w,{value:t.categoryid,onValueChange:a=>v("categoryid",a),children:[e.jsx(I,{children:e.jsx(q,{placeholder:"Select category"})}),e.jsx(S,{children:E.map(a=>e.jsx(C,{value:a.id.toString(),children:a.name},a.id))})]}),s.categoryid&&e.jsx("p",{className:"text-sm text-red-600",children:s.categoryid})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"manufacturer",className:"text-sm font-medium",children:"Manufacturer"}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(u,{id:"manufacturer",name:"manufacturer",value:t.manufacturer,onChange:d,placeholder:"e.g., City Health Office",className:"w-full pl-10"})]}),s.manufacturer&&e.jsx("p",{className:"text-sm text-red-600",children:s.manufacturer})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx(Q,{id:"description",name:"description",value:t.description,onChange:d,placeholder:"Enter item description, usage instructions, or notes",className:"w-full min-h-[80px] resize-none"}),s.description&&e.jsx("p",{className:"text-sm text-red-600",children:s.description})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Stock Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"quantity",className:"text-sm font-medium",children:"Current Quantity *"}),e.jsx(u,{id:"quantity",name:"quantity",type:"number",value:t.quantity,onChange:d,placeholder:"0",className:"w-full",required:!0}),s.quantity&&e.jsx("p",{className:"text-sm text-red-600",children:s.quantity}),c.quantity&&e.jsx("p",{className:"text-sm text-red-600",children:c.quantity})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"unit_type",className:"text-sm font-medium",children:"Unit of Measure *"}),e.jsxs(w,{value:t.unit_type,onValueChange:a=>v("unit_type",a),children:[e.jsx(I,{children:e.jsx(q,{placeholder:"Select unit"})}),e.jsx(S,{children:$.map(a=>e.jsx(C,{value:a.value,children:a.label},a.value))})]}),s.unit_type&&e.jsx("p",{className:"text-sm text-red-600",children:s.unit_type})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"storage_location",className:"text-sm font-medium",children:"Storage Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(u,{id:"storage_location",name:"storage_location",value:t.storage_location,onChange:d,placeholder:"e.g., A-1-01",className:"w-full pl-10"})]}),s.storage_location&&e.jsx("p",{className:"text-sm text-red-600",children:s.storage_location})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"minimum_stock",className:"text-sm font-medium",children:"Minimum Stock Level"}),e.jsx(u,{id:"minimum_stock",name:"minimum_stock",type:"number",value:t.minimum_stock,onChange:d,placeholder:"0",className:"w-full"}),s.minimum_stock&&e.jsx("p",{className:"text-sm text-red-600",children:s.minimum_stock}),c.minimum_stock&&e.jsx("p",{className:"text-sm text-red-600",children:c.minimum_stock})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"maximum_stock",className:"text-sm font-medium",children:"Maximum Stock Level"}),e.jsx(u,{id:"maximum_stock",name:"maximum_stock",type:"number",value:t.maximum_stock,onChange:d,placeholder:"0",className:"w-full"}),s.maximum_stock&&e.jsx("p",{className:"text-sm text-red-600",children:s.maximum_stock}),c.maximum_stock&&e.jsx("p",{className:"text-sm text-red-600",children:c.maximum_stock})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Batch & Expiry Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"batch_number",className:"text-sm font-medium",children:"Batch/Lot Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(u,{id:"batch_number",name:"batch_number",value:t.batch_number,onChange:d,placeholder:"e.g., RX12001121",className:"w-full pl-10"})]}),s.batch_number&&e.jsx("p",{className:"text-sm text-red-600",children:s.batch_number})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"expiry_date",className:"text-sm font-medium",children:"Expiry Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(u,{id:"expiry_date",name:"expiry_date",type:"date",value:t.expiry_date,onChange:d,className:"w-full pl-10",min:new Date().toISOString().split("T")[0]})]}),s.expiry_date&&e.jsx("p",{className:"text-sm text-red-600",children:s.expiry_date})]})]})]}),e.jsxs(P,{className:"flex gap-3 pt-6",children:[e.jsx(k,{type:"button",variant:"outline",onClick:y,className:"flex-1",children:"Cancel"}),e.jsx(k,{type:"submit",disabled:N,className:"flex-1",style:{backgroundColor:"#2C3E50"},children:N?"Adding...":"Add Item"})]})]})]})})};export{_e as default};
