import{j as e,r as L}from"./app-Ci6FsPEI.js";import{r as i}from"./vendor-DkBadjUr.js";import"./pusher-DVtoYAOu.js";import{A as ts}from"./AdminLayout-DvrTmQBr.js";import as from"./AddItemForm-DWBAspH_.js";import rs from"./AddCategoryForm-D8tS9P1y.js";import{E as be,C as ns}from"./CategoryManagement-BpZm_QPA.js";import is from"./ViewItemModal-Dh5q21Q1.js";import os from"./EditItemModal-qHLu02sf.js";import cs from"./AddBatchModal-DHLO7RPQ.js";import ls from"./UpdateStocksModal-CVWQnsfN.js";import ds from"./SuccessModal-BJuAEuVA.js";import xs from"./DispenseStockModal-BWyQLVzu.js";import ms from"./BatchDisposalModal-Bi1LnbiU.js";import{C as j,c as y,a as hs,b as us}from"./card-aZhT47Dl.js";import{B as l}from"./button-CNgURIMK.js";import{B as ke}from"./badge-B0i2gCu5.js";import{I as ps}from"./input-CCqrrlXQ.js";import{S as X,a as J,b as K,c as W,d as c}from"./select-Bs3uVyOJ.js";import{D as Ce,a as De,b as Ae,e as x}from"./dropdown-menu-1qrkHUIu.js";import{m as f}from"./proxy-bGmOedB6.js";import{T as Ie}from"./tag-DwpkVkgc.js";import{P as gs}from"./plus-MavOGQlj.js";import{P as Y}from"./package-L7rgkkVO.js";import{T as z}from"./trending-up-BFbz08q-.js";import{T as js}from"./triangle-alert-BslwqqvL.js";import{T as ys}from"./trending-down-DADUT3dQ.js";import{C as fs}from"./clock-D6yUBuGv.js";import{S as Ns}from"./search-Cye_TdpF.js";import{c as re}from"./createLucideIcon-BKWaAi2G.js";import{A as vs}from"./index-BAO1aZYw.js";import{E as ee}from"./eye-mxYijkrE.js";import{A as Me,a as _e}from"./archive-BwGVl8jP.js";import{S as se}from"./square-pen-Bb1JtfBr.js";import{T as te}from"./trash-2-DJ5zXW8D.js";import{S as ws}from"./star-sc8DcFnL.js";import{H as Ss}from"./house-CSq-WFst.js";import{U as bs}from"./users-D4PhO1-D.js";import{A as ks}from"./activity-C-sjEU5t.js";import{Z as Cs}from"./zap-BCMzj8QL.js";import{S as Ds}from"./shield-B7gr9OVN.js";import{H as As}from"./heart-CDAohmX9.js";import{F as Is}from"./flask-conical-30tS4pFx.js";import{S as Ms}from"./stethoscope-QcN9KdKi.js";import{S as _s}from"./syringe-CKDJ4xso.js";import{P as Es}from"./pill-DIGxtF-3.js";import"./index-BpVWxWkG.js";import"./avatar-CDwiAaCj.js";import"./react-icons.esm-Cg1Z9ZGK.js";import"./separator-XmNd4rCi.js";import"./index-PUx0SOs8.js";import"./index-D0_reY7q.js";import"./moment-C5S46NFB.js";import"./dialog-NMjAdLkI.js";import"./index-BYyo8n0W.js";import"./tslib.es6-M_FJ09fS.js";import"./label-Bsu9V-2p.js";import"./calendar-C_O0gbX6.js";import"./index-DbZPFhJ9.js";import"./index-CuaviD7G.js";import"./format-Dp3w_Y3x.js";import"./isBefore-COsor6RJ.js";import"./isSameMonth-BOwz-_mK.js";import"./TextInput-ZPi1BB0P.js";import"./x-b8JahagL.js";import"./settings-D_MeB5oN.js";import"./calendar-D9APQM2e.js";import"./pusher-AxtNKRPu.js";import"./printer-CfgcPaUh.js";import"./file-text-YZXa1D2L.js";import"./circle-check-big-BQVCuGNJ.js";import"./bell-HhCf5F9O.js";import"./autoprefixer-uFe7yxdA.js";import"./unit-CopbpOEH.js";import"./Toaster-DfG7JimY.js";import"./toast-CfLCVPii.js";import"./index-B6i_t9H1.js";import"./index-MVKj6Ku2.js";import"./layers-OK8ayVTK.js";import"./chart-column-yMaSKbSU.js";import"./textarea-CmmM-UAe.js";import"./building-2-DmPcAwng.js";import"./map-pin-Dkn0BYKY.js";import"./hash-AgYeaIxt.js";import"./index-DqxisvwK.js";import"./circle-x-Cf2XhiVO.js";import"./circle-alert-D8zT41fC.js";import"./jspdf.es.min-fDRRQfhL.js";import"./index-D4ivUix3.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Us=re("Grid3x3",Ts);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Fs=re("List",Bs);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],ae=re("ShoppingCart",Ls);function fa({categories:S=[],allCategories:Ee=[],inventoryItems:I=[],expiringSoonCount:ne=0}){const[P,ie]=i.useState("list"),[p,Te]=i.useState("name"),[$,Ue]=i.useState("asc"),[b,oe]=i.useState(""),[M,ce]=i.useState("all"),[k,le]=i.useState("all"),[_,E]=i.useState(1),[T]=i.useState(10),[Be,de]=i.useState(!1),[Fe,xe]=i.useState(!1),[Le,me]=i.useState(!1),[ze,he]=i.useState(!1),[Pe,U]=i.useState(!1),[$e,V]=i.useState(!1),[Ve,C]=i.useState(!1),[N,v]=i.useState(null),[qe,B]=i.useState(""),[He,ue]=i.useState(!1),[Oe,pe]=i.useState(!1),[Qe,Ze]=i.useState("single"),[Re,ge]=i.useState(!1),Ge=(s,a,t=null)=>{const r=s.reduce((o,h)=>o+h.quantity,0);if(r===0)return"out_of_stock";if(r<=a)return"low_stock";const n=s.some(o=>g(o.expiryDate));return!n&&t&&g(t)||n?"expiring_soon":"in_stock"},Xe=s=>{const a=s.stock?.stocks||0,t=s.minimum_stock||10;return a===0?"out_of_stock":a<=t?"low_stock":"in_stock"},F=s=>s?new Date(s)<new Date:!1,g=s=>{if(!s||s==="N/A")return!1;try{const a=new Date(s);if(isNaN(a.getTime()))return!1;const r=Math.ceil((a-new Date)/(1e3*60*60*24));return r<=30&&r>0}catch{return console.warn("Invalid expiry date:",s),!1}},Je=s=>{const a=s?.icon||"Package",t=Ke(a);switch(a){case"Pill":return e.jsx(Es,{className:`h-5 w-5 ${t}`});case"Syringe":return e.jsx(_s,{className:`h-5 w-5 ${t}`});case"Stethoscope":return e.jsx(Ms,{className:`h-5 w-5 ${t}`});case"FlaskConical":return e.jsx(Is,{className:`h-5 w-5 ${t}`});case"Heart":return e.jsx(As,{className:`h-5 w-5 ${t}`});case"Shield":return e.jsx(Ds,{className:`h-5 w-5 ${t}`});case"Zap":return e.jsx(Cs,{className:`h-5 w-5 ${t}`});case"Activity":return e.jsx(ks,{className:`h-5 w-5 ${t}`});case"Users":return e.jsx(bs,{className:`h-5 w-5 ${t}`});case"Home":return e.jsx(Ss,{className:`h-5 w-5 ${t}`});case"Star":return e.jsx(ws,{className:`h-5 w-5 ${t}`});default:return e.jsx(Y,{className:`h-5 w-5 ${t}`})}},Ke=s=>{switch(s){case"Pill":return"text-blue-600";case"Syringe":return"text-green-600";case"Stethoscope":return"text-purple-600";case"FlaskConical":return"text-orange-600";case"Heart":return"text-red-600";case"Shield":return"text-indigo-600";case"Zap":return"text-yellow-600";case"Activity":return"text-cyan-600";case"Users":return"text-pink-600";case"Home":return"text-emerald-600";case"Star":return"text-amber-600";default:return"text-gray-600"}},D=s=>{v(s),he(!0)},q=s=>{v(s),U(!0)},We=s=>{v(s),V(!0)},Ye=()=>{V(!1),U(!1),L.reload()},je=s=>{const a="Item archived successfully!",t="Failed to archive item!";L.put(route("pharmacist.inventory.item.archive",s.id),{},{onSuccess:()=>{B(a),C(!0),window.location.reload()},onError:()=>{B(t),C(!0)}})},ye=s=>{const a="Item unarchived successfully!",t="Failed to unarchive item!";L.put(route("pharmacist.inventory.item.unarchive",s.id),{},{onSuccess:()=>{B(a),C(!0),window.location.reload()},onError:()=>{B(t),C(!0)}})},H=s=>{v(s),ue(!0)},O=(s,a="single")=>{v(s),Ze(a),pe(!0)},Q=(s,a=null)=>{const t=a?{...s,id:a.id,batch_number:a.batchNumber,expiry_date:a.expiryDate,quantity:a.quantity,stock:{stocks:a.quantity}}:s;v(t),ge(!0)},es=s=>{if(!s||s.length===0)return[];const a=s.reduce((t,r)=>{const n=r.name;t[n]||(t[n]={id:r.id,name:n,category:r.category||null,categoryIcon:Je(r.category),categoryId:r.category_id,manufacturer:r.manufacturer||"N/A",description:r.description||"",unit:r.unit_type||"pieces",minimumStock:r.minimum_stock||10,maximumStock:r.maximum_stock||100,isArchived:r.status===0,lastUpdated:r.updated_at||"N/A",expiryDate:r.expiry_date,batches:[]});const o=r.batch_number&&r.batch_number!=="new_batch"&&r.batch_number!=="N/A"?r.batch_number:"N/A";return t[n].batches.push({id:r.id,batchNumber:o,quantity:r.stock?.stocks||0,expiryDate:r.expiry_date||"N/A",storageLocation:r.storage_location||"",status:Xe(r),lastUpdated:r.updated_at||"N/A"}),t},{});return Object.values(a).map(t=>{const r=t.batches.filter(d=>d.batchNumber&&d.batchNumber!=="N/A"&&d.batchNumber!=="new_batch"),n=r.reduce((d,m)=>d+m.quantity,0),o=r[0]?.expiryDate||t.expiryDate,h=Ge(r,t.minimumStock,o);return{...t,batches:r,totalQuantity:n,status:h,batchCount:r.length}})},u=I&&I.length>0?es(I):[],[fe,ss]=i.useState(u);i.useEffect(()=>{let s=u.filter(a=>{const t=a.name.toLowerCase().includes(b.toLowerCase())||(a.category?.name||"Uncategorized").toLowerCase().includes(b.toLowerCase())||a.batches.some(o=>o.batchNumber.toLowerCase().includes(b.toLowerCase())),r=M==="all"||(a.category?.name||"Uncategorized")===M;let n=!1;return k==="all"?n=!0:k==="archived"?n=a.isArchived:n=a.status===k&&!a.isArchived,t&&r&&n});s.sort((a,t)=>{let r=a[p],n=t[p];if(p==="name"||p==="category")r=r.toLowerCase(),n=n.toLowerCase();else if(p==="quantity")r=a.totalQuantity||0,n=t.totalQuantity||0;else if(p==="expiryDate"){const o=Math.min(...a.batches.map(d=>{if(d.expiryDate==="N/A")return new Date("2099-12-31").getTime();try{const m=new Date(d.expiryDate);return isNaN(m.getTime())?new Date("2099-12-31").getTime():m.getTime()}catch{return new Date("2099-12-31").getTime()}})),h=Math.min(...t.batches.map(d=>{if(d.expiryDate==="N/A")return new Date("2099-12-31").getTime();try{const m=new Date(d.expiryDate);return isNaN(m.getTime())?new Date("2099-12-31").getTime():m.getTime()}catch{return new Date("2099-12-31").getTime()}}));r=o,n=h}else p==="isArchived"&&(r=r?1:0,n=n?1:0);return $==="asc"?r>n?1:-1:r<n?1:-1}),ss(s),E(1)},[b,M,k,p,$]);const A=fe.length,Z=Math.ceil(A/T),R=(_-1)*T,Ne=R+T,ve=fe.slice(R,Ne),we=(s,a=!1)=>{if(a)return"bg-gray-100 text-gray-600 border-gray-300";switch(s){case"in_stock":return"bg-green-100 text-green-800 border-green-200";case"low_stock":return"bg-amber-100 text-amber-800 border-amber-200";case"out_of_stock":return"bg-red-100 text-red-800 border-red-200";case"expiring_soon":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Se=(s,a=!1)=>{if(a)return"Archived";switch(s){case"in_stock":return"In Stock";case"low_stock":return"Low Stock";case"out_of_stock":return"Out of Stock Items";case"expiring_soon":return"Expiring Soon Items";default:return"Unknown"}},G=u.filter(s=>s.status==="expiring_soon"&&!s.isArchived).length,w={total:u.filter(s=>!s.isArchived).length,inStock:u.filter(s=>s.status==="in_stock"&&!s.isArchived).length,lowStock:u.filter(s=>s.status==="low_stock"&&!s.isArchived).length,outOfStock:u.filter(s=>s.status==="out_of_stock"&&!s.isArchived).length,expiringSoon:G>0?G:ne};return console.log("Inventory Stats Debug:",{totalItems:u.length,frontendExpiringSoon:G,backendExpiringSoonCount:ne,finalExpiringSoon:w.expiringSoon,expiringSoonItems:u.filter(s=>s.status==="expiring_soon"&&!s.isArchived),allItemStatuses:u.map(s=>({name:s.name,status:s.status,expiryDate:s.expiryDate,isItemExpiringSoon:g(s.expiryDate),batches:s.batches?.map(a=>({expiryDate:a.expiryDate,isExpiringSoon:g(a.expiryDate)}))}))}),i.useEffect(()=>{if(!window.Echo)return;const s=window.Echo.channel("inventory"),a=()=>{L.reload({only:["inventoryItems","categories","allCategories"]})};return s.listen(".InventoryUpdated",a),()=>{try{s.stopListening(".InventoryUpdated",a)}catch{}}},[]),e.jsx(ts,{header:"Inventory Management",children:e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your pharmacy inventory efficiently"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(l,{variant:"outline",className:"flex items-center gap-2",onClick:()=>xe(!0),children:[e.jsx(Ie,{className:"h-4 w-4"}),"Add Category"]}),e.jsxs(l,{variant:"outline",className:"flex items-center gap-2",onClick:()=>me(!0),children:[e.jsx(Ie,{className:"h-4 w-4"}),"Manage Categories"]}),e.jsxs(l,{className:"flex items-center gap-2",style:{backgroundColor:"#2C3E50"},onClick:()=>de(!0),children:[e.jsx(gs,{className:"h-4 w-4"}),"Add Item"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(j,{className:"hover:shadow-md transition-all duration-300",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Items"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.total})]}),e.jsx(Y,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(j,{className:"hover:shadow-md transition-all duration-300",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"In Stock"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:w.inStock})]}),e.jsx(z,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(j,{className:"hover:shadow-md transition-all duration-300",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Low Stock"}),e.jsx("p",{className:"text-2xl font-bold text-amber-600",children:w.lowStock})]}),e.jsx(js,{className:"h-8 w-8 text-amber-600"})]})})}),e.jsx(j,{className:"hover:shadow-md transition-all duration-300",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Out of Stock Items"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:w.outOfStock})]}),e.jsx(ys,{className:"h-8 w-8 text-red-600"})]})})}),e.jsx(j,{className:"hover:shadow-md transition-all duration-300",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Expiring Soon Items"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:w.expiringSoon})]}),e.jsx(fs,{className:"h-8 w-8 text-orange-600"})]})})})]}),e.jsx(j,{children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ns,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(ps,{placeholder:"Search items, batch numbers, or categories...",value:b,onChange:s=>oe(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(X,{value:M,onValueChange:ce,children:[e.jsx(J,{className:"w-40",children:e.jsx(K,{placeholder:"Category"})}),e.jsxs(W,{children:[e.jsx(c,{value:"all",children:"All Categories"}),S&&S.map(s=>e.jsx(c,{value:s.name,children:s.name},s.id))]})]}),e.jsxs(X,{value:k,onValueChange:le,children:[e.jsx(J,{className:"w-40",children:e.jsx(K,{placeholder:"Status"})}),e.jsxs(W,{children:[e.jsx(c,{value:"all",children:"All Status"}),e.jsx(c,{value:"in_stock",children:"In Stock"}),e.jsx(c,{value:"low_stock",children:"Low Stock"}),e.jsx(c,{value:"out_of_stock",children:"Out of Stock Items"}),e.jsx(c,{value:"expiring_soon",children:"Expiring Soon Items"}),e.jsx(c,{value:"archived",children:"Archived"})]})]}),e.jsxs(X,{value:`${p}-${$}`,onValueChange:s=>{const[a,t]=s.split("-");Te(a),Ue(t)},children:[e.jsx(J,{className:"w-40",children:e.jsx(K,{placeholder:"Sort by"})}),e.jsxs(W,{children:[e.jsx(c,{value:"name-asc",children:"Name (A-Z)"}),e.jsx(c,{value:"name-desc",children:"Name (Z-A)"}),e.jsx(c,{value:"category-asc",children:"Category (A-Z)"}),e.jsx(c,{value:"category-desc",children:"Category (Z-A)"}),e.jsx(c,{value:"quantity-asc",children:"Quantity (Low-High)"}),e.jsx(c,{value:"quantity-desc",children:"Quantity (High-Low)"}),e.jsx(c,{value:"expiryDate-asc",children:"Expiry (Soon-Later)"}),e.jsx(c,{value:"expiryDate-desc",children:"Expiry (Later-Soon)"}),e.jsx(c,{value:"isArchived-asc",children:"Status (Active-Archived)"}),e.jsx(c,{value:"isArchived-desc",children:"Status (Archived-Active)"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 border rounded-lg",children:[e.jsx(l,{variant:P==="list"?"default":"ghost",size:"sm",onClick:()=>ie("list"),children:e.jsx(Fs,{className:"h-4 w-4"})}),e.jsx(l,{variant:P==="grid"?"default":"ghost",size:"sm",onClick:()=>ie("grid"),children:e.jsx(Us,{className:"h-4 w-4"})})]})]})]})})}),e.jsx(vs,{mode:"wait",children:P==="grid"?e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:ve.map((s,a)=>e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:a*.1},children:e.jsxs(j,{className:"hover:shadow-lg transition-all duration-300 group",children:[e.jsx(hs,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl cursor-pointer hover:scale-110 transition-transform",onClick:()=>D(s),title:"View Details",children:s.categoryIcon}),e.jsxs("div",{className:"flex-1",children:[e.jsx(us,{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.category?.name||"Uncategorized"})]})]}),e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(be,{className:"h-4 w-4"})})}),e.jsxs(Ae,{align:"end",children:[e.jsxs(x,{onClick:()=>D(s),children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"View Details"]}),s.isArchived?e.jsxs(x,{className:"text-green-600",onClick:()=>ye(s),children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Unarchive"]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{onClick:()=>q(s),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Edit Item"]}),e.jsxs(x,{onClick:()=>H(s),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Dispense Stock"]}),e.jsxs(x,{onClick:()=>Q(s),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Update Stocks"]}),s.batches.some(t=>F(t.expiryDate)||g(t.expiryDate))&&e.jsxs(x,{onClick:()=>O(s),children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Dispose Batch"]}),e.jsxs(x,{className:"text-orange-600",onClick:()=>je(s),children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Archive"]})]})]})]})]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Quantity"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[s.totalQuantity," ",s.unit]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Batches"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[s.batchCount," batch",s.batchCount!==1?"es":""]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Batch Details:"}),e.jsx("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:s.batches.map((t,r)=>e.jsxs("div",{className:"text-xs bg-gray-50 p-2 rounded",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-mono",children:t.batchNumber}),e.jsx("span",{className:"font-semibold",children:t.quantity})]}),e.jsxs("div",{className:"text-gray-500",children:["Exp: ",(()=>{try{if(!t.expiryDate||t.expiryDate==="N/A")return"N/A";const n=new Date(t.expiryDate);return isNaN(n.getTime())?"Invalid Date":n.toLocaleDateString()}catch{return"Invalid Date"}})()]})]},t.id))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Manufacturer"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.manufacturer})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ke,{className:we(s.status,s.isArchived),children:Se(s.status,s.isArchived)})})})]})]})},s.id))},"grid"):e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(j,{children:e.jsx(y,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Item Details"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Category"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Total Quantity"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Batches"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Earliest Expiry"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{children:ve.map((s,a)=>e.jsxs(f.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:a*.05},className:"border-b hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-xl cursor-pointer hover:scale-110 transition-transform",onClick:()=>D(s),title:"View Details",children:s.categoryIcon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.manufacturer," â€¢ ",s.unit]})]})]})}),e.jsx("td",{className:"py-4 px-4 text-gray-600",children:s.category?.name||"Uncategorized"}),e.jsxs("td",{className:"py-4 px-4",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.totalQuantity}),e.jsx("span",{className:"text-sm text-gray-500 ml-1",children:s.unit})]}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.batchCount," batch",s.batchCount!==1?"es":""]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.batches.slice(0,2).map(t=>t.batchNumber).join(", "),s.batchCount>2&&` +${s.batchCount-2} more`]})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"flex items-center gap-2",children:(()=>{const t=s.batches.reduce((o,h)=>{if(!o||h.expiryDate==="N/A"||o.expiryDate==="N/A")return h;try{const d=new Date(h.expiryDate),m=new Date(o.expiryDate);return isNaN(d.getTime())||isNaN(m.getTime())?o:d<m?h:o}catch{return o}},null);if(!t||t.expiryDate==="N/A")return e.jsx("span",{className:"text-sm text-gray-500",children:"N/A"});const r=F(t.expiryDate),n=g(t.expiryDate);return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`text-sm ${r?"text-red-600 font-semibold":n?"text-amber-600 font-semibold":"text-gray-600"}`,children:(()=>{try{const o=new Date(t.expiryDate);return isNaN(o.getTime())?"Invalid Date":o.toLocaleDateString()}catch{return"Invalid Date"}})()}),r&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"EXPIRED"}),n&&!r&&e.jsx("span",{className:"text-xs bg-amber-100 text-amber-800 px-2 py-1 rounded-full",children:"EXPIRING SOON"})]})})()})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ke,{className:we(s.status,s.isArchived),children:Se(s.status,s.isArchived)})})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>D(s),title:"View Details",children:e.jsx(ee,{className:"h-4 w-4"})}),!s.isArchived&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>q(s),title:"Edit Item",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>H(s),title:"Dispense Stock",className:"text-green-600 hover:text-green-700 border-green-200 hover:border-green-300",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>Q(s),title:"Update Stocks",className:"text-blue-600 hover:text-blue-700 border-blue-200 hover:border-blue-300",children:e.jsx(z,{className:"h-4 w-4"})}),s.batches.some(t=>F(t.expiryDate)||g(t.expiryDate))&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>O(s),title:"Dispose Batch",className:"text-red-600 hover:text-red-700 border-red-200 hover:border-red-300",children:e.jsx(te,{className:"h-4 w-4"})})]}),e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(be,{className:"h-4 w-4"})})}),e.jsxs(Ae,{align:"end",children:[e.jsxs(x,{onClick:()=>D(s),children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"View Details"]}),s.isArchived?e.jsxs(x,{className:"text-green-600",onClick:()=>ye(s),children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Unarchive"]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{onClick:()=>q(s),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Edit Item"]}),e.jsxs(x,{onClick:()=>H(s),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Dispense Stock"]}),e.jsxs(x,{onClick:()=>Q(s),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Update Stocks"]}),s.batches.some(t=>F(t.expiryDate)||g(t.expiryDate))&&e.jsxs(x,{onClick:()=>O(s),children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Dispose Batch"]}),e.jsxs(x,{className:"text-orange-600",onClick:()=>je(s),children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Archive"]})]})]})]})]})})]},s.id))})]})})})})},"list")}),A>T&&e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",R+1," to ",Math.min(Ne,A)," of ",A," items"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>E(s=>Math.max(s-1,1)),disabled:_===1,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Z},(s,a)=>a+1).map(s=>e.jsx(l,{variant:_===s?"default":"outline",size:"sm",onClick:()=>E(s),className:"w-8 h-8 p-0",children:s},s))}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>E(s=>Math.min(s+1,Z)),disabled:_===Z,children:"Next"})]})]}),A===0&&e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(Y,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No items found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Try adjusting your search or filter criteria"}),e.jsx(l,{onClick:()=>{oe(""),ce("all"),le("all")},children:"Clear Filters"})]}),e.jsx(as,{open:Be,onClose:()=>de(!1),categories:S||[]}),e.jsx(rs,{open:Fe,onClose:()=>xe(!1)}),e.jsx(ns,{open:Le,onClose:()=>me(!1),categories:Ee}),e.jsx(is,{open:ze,onClose:()=>he(!1),item:N}),e.jsx(os,{open:Pe,onClose:()=>U(!1),item:N,categories:S||[],onAddBatch:We}),e.jsx(cs,{open:$e,onClose:()=>V(!1),item:N,categories:S||[],onBatchAdded:Ye,onCloseEditModal:()=>U(!1)}),e.jsx(ds,{open:Ve,onClose:()=>C(!1),message:qe}),e.jsx(xs,{open:He,onClose:()=>ue(!1),item:N}),e.jsx(ms,{open:Oe,onClose:()=>pe(!1),item:N,multi:Qe==="multi",itemsForMulti:I}),e.jsx(ls,{open:Re,onClose:()=>ge(!1),item:N})]})})}export{fa as default};
