import{r as i,P as Q,j as s,b as U}from"./app-G8iqleJv.js";import{c as R,d as G,a as J,e as K,C as X}from"./card-cIg_B_IG.js";import{B as m}from"./badge-BLwlscqv.js";import{B as r}from"./button-B_LnOuxf.js";import{C as B}from"./CustomModal-B9j4gIjG.js";import{I as Y}from"./InputLabel-BKeIIhOb.js";import"./label-tl9XpKj-.js";import{I as Z}from"./input-DFrqRW5G.js";import{f as L}from"./dialog-D79V5GE4.js";import{T as ee}from"./triangle-alert-Cp-EFFMw.js";import{C as se}from"./clock--denLSlA.js";import{C as ae}from"./chevron-up-DhNhWxCa.js";import{C as re}from"./chevron-down-m_6d1Po1.js";import{f as F}from"./format-BtYX0kVO.js";import"./utils-k0UhslF6.js";import"./select-BtrVkcdI.js";import"./react-icons.esm-BGTDVcWI.js";import"./index-3LKL4iwc.js";import"./index-DdMWTZ3t.js";import"./index-CE5llJVL.js";import"./index-DHagqIMV.js";import"./index-B2jg9BR7.js";import"./floating-ui.react-dom-B6MwqTU1.js";import"./index-nEL1Ci1r.js";import"./Combination-BkR281CS.js";import"./index-BHXf0KTI.js";import"./createLucideIcon-CtVvwcl8.js";const Me=({item:e,onUpdateClick:T})=>{var x,u,h,g,j,f,v,y,b,N,C,k,_,w,D,I,S,E,M;const[n,$]=i.useState(!1),o=((x=e==null?void 0:e.stock[0])==null?void 0:x.stocks)<=5,l=((g=(h=e==null?void 0:e.stocks_movement)==null?void 0:h[((u=e==null?void 0:e.stocks_movement)==null?void 0:u.length)-1])==null?void 0:g.expiry_date)&&new Date((v=(f=e==null?void 0:e.stocks_movement)==null?void 0:f[((j=e==null?void 0:e.stocks_movement)==null?void 0:j.length)-1])==null?void 0:v.expiry_date).getTime()-new Date().getTime()<30*24*60*60*1e3,z=a=>{switch(a){case"Medicine":return"bg-blue-100 text-blue-800";case"Vaccine":return"bg-green-100 text-green-800";case"Supply":return"bg-purple-100 text-purple-800";case"Equipment":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},{data:c,setData:A,processing:p,put:O,delete:P}=Q({itemname:e==null?void 0:e.name,categoryid:e==null?void 0:e.category_id}),[V,d]=i.useState(!1),[W,t]=i.useState(!1),q=a=>{a.preventDefault(),O(route("admin.inventory.item.update",{inventory:e.id}),{onFinish:()=>{U.reload({only:["flash","inventory"]})},onSuccess:()=>{t(!1)}})},H=a=>{a.preventDefault(),P(route("admin.inventory.item.delete",{inventory:e.id}),{onFinish:()=>{U.reload({only:["flash","inventory"]})},onSuccess:()=>{t(!1)}})};return s.jsxs(R,{className:`mb-4 ${o?"border-red-300":l?"border-amber-300":"border-gray-200"}`,children:[s.jsx(G,{className:"pb-2",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs(J,{className:"text-lg font-medium",children:[e.name,((b=(y=e==null?void 0:e.stocks_movement)==null?void 0:y[0])==null?void 0:b.batch_number)&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Batch Number:"}),s.jsx("p",{className:"font-medium",children:(C=(N=e==null?void 0:e.stocks_movement)==null?void 0:N[0])==null?void 0:C.batch_number})]})]}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[s.jsx(m,{className:z(e.category.name),children:e.category.name}),o&&s.jsxs(m,{variant:"destructive",className:"flex items-center gap-1",children:[s.jsx(ee,{className:"h-3 w-3"}),"Low Stock"]}),l&&e.expirationDate&&s.jsxs(m,{variant:"outline",className:"bg-amber-100 text-amber-800 flex items-center gap-1",children:[s.jsx(se,{className:"h-3 w-3"}),"Expiring Soon"]})]})]}),s.jsx(r,{variant:"ghost",size:"sm",onClick:()=>$(!n),className:"h-8 w-8 p-0",children:n?s.jsx(ae,{className:"h-4 w-4"}):s.jsx(re,{className:"h-4 w-4"})})]})}),s.jsxs(K,{className:"pb-3",children:[s.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Quantity"}),s.jsxs("p",{className:`font-medium ${o?"text-red-600":""}`,children:[(k=e.stock[0])==null?void 0:k.stocks," ",(_=e.stock[0])==null?void 0:_.stockname,"s"]})]})}),s.jsxs("div",{children:[s.jsx(r,{variant:"outline",size:"sm",className:"w-1/2 mt-2 hover:bg-secondary/80 transition-colors font-medium",onClick:()=>{t(!0)},children:"Edit Item"}),s.jsxs(B,{isOpen:W,onClose:a=>{t(!1)},title:"Updating an Item",description:`Update ${e==null?void 0:e.name} item here.`,maxWidth:"md",children:[s.jsxs("div",{children:[s.jsx(Y,{value:"Item Name*"}),s.jsx(Z,{value:c==null?void 0:c.itemname,onChange:a=>A("itemname",a.target.value)})]}),s.jsxs(L,{className:"pt-4",children:[s.jsx(r,{type:"button",variant:"outline",onClick:a=>{t(!1)},children:"Cancel"}),s.jsx(r,{className:"bg-primary hover:bg-primary/90",disabled:p,onClick:q,children:"Update Item"})]})]}),s.jsx(r,{variant:"outline",size:"sm",className:"w-1/2",onClick:a=>{d(!0)},children:"Delete Item"}),s.jsx(B,{isOpen:V,onClose:a=>{d(!1)},title:"Deleting an Item.",description:`Are you sure you want to delete this item ${e==null?void 0:e.name}?`,maxWidth:"md",children:s.jsxs(L,{className:"pt-4",children:[s.jsx(r,{type:"button",variant:"outline",onClick:a=>{d(!1)},children:"Cancel"}),s.jsx(r,{type:"submit",className:"bg-primary hover:bg-primary/90",disabled:p,onClick:H,children:"Delete Item"})]})})]}),n&&s.jsx("div",{className:"mt-4 border-t pt-3",children:s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[((D=(w=e==null?void 0:e.stocks_movement)==null?void 0:w[0])==null?void 0:D.expiry_date)&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Expiration Date"}),s.jsx("p",{className:`font-medium ${l?"text-amber-600":""}`,children:F(new Date((E=(S=e==null?void 0:e.stocks_movement)==null?void 0:S[((I=e==null?void 0:e.stocks_movement)==null?void 0:I.length)-1])==null?void 0:E.expiry_date),"MMM dd, yyyy")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Last Updated"}),s.jsx("p",{className:"font-medium",children:F(new Date((M=e.stocks_movement[0])==null?void 0:M.updated_at),"MMM dd, yyyy")})]}),e.isVaccine&&s.jsxs(s.Fragment,{children:[e.lotNumber&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Lot Number"}),s.jsx("p",{className:"font-medium",children:e.lotNumber})]}),e.location&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Storage Location"}),s.jsx("p",{className:"font-medium",children:e.location})]})]})]})})]}),n&&s.jsx(X,{className:"pt-0",children:s.jsx(r,{variant:"outline",size:"sm",className:"w-full hover:bg-secondary/80 transition-colors font-medium",onClick:()=>T(e),children:"Update Stock"})})]})};export{Me as default};
