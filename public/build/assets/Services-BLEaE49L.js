import{r as i,P as F,j as e,d as Y,R as Ee}from"./app-9IFjvyjq.js";import{C as Z}from"./react-icons.esm-CBUbwQJY.js";import{B as l}from"./button-BWLYpXz0.js";import{I as P}from"./input-fLU5VnAr.js";import"./avatar-eTivO2nx.js";import{B as h}from"./badge-Da4cSqJP.js";import{S as Oe,T as ee,a as se,b as j,c as o,d as re,e as d}from"./table2-D0uN2hlO.js";import{S as Ie,a as He,b as Le,c as Fe,d as _}from"./select-p8YEwkY-.js";import{D as w,a as C,b as D,c as A,e as T,d as k,f as z}from"./dialog-BlSttdnZ.js";import{L as v}from"./label-C2QZitaL.js";import"./textarea-COBWyWer.js";import Pe from"./Sidebar-DuuNYW_i.js";import _e from"./ServicesLayout-BJMQ_vY9.js";import{h as ae}from"./moment-C5S46NFB.js";import{F as ze}from"./filter-ppKoOxkI.js";import{C as Be}from"./chevron-up-92Sj5s40.js";import{C as Re}from"./chevron-down-C4FOIhdo.js";import{S as ie}from"./square-pen-Dnx_Ff5r.js";import"./utils-Dqxj4mrw.js";import"./index-C6jRhQFj.js";import"./index-DMLVHKle.js";import"./createLucideIcon-DsPw26Nq.js";import"./arrow-up-BuTJVTCc.js";import"./index-5FqUdhJW.js";import"./Combination-BD7y2hDp.js";import"./index-ZSsit5F4.js";import"./index-D1R9fGnO.js";import"./index-Bhu2lbiL.js";import"./index-iJsz53jB.js";import"./card-BZqhk5Ws.js";import"./alert-767SHTEN.js";import"./separator-Ck3s5O1g.js";import"./square-kanban-ByUig0jR.js";import"./layers-CYkgeNxD.js";import"./CustomModal-B_1zsoCZ.js";import"./AdminLayout-B1EVrWwj.js";import"./popover-D55FYzXF.js";import"./format-BtYX0kVO.js";import"./isBefore-CNJkrGzj.js";import"./isSameMonth-CLqEvLGB.js";import"./TextInput-VzTatbZ2.js";import"./x-QWiAXd0n.js";import"./settings-RhmjAov2.js";import"./house-3fFlpYPo.js";import"./calendar-DQr9f7aC.js";import"./users-CRZKArp7.js";import"./bell-Oyzr8Ilp.js";import"./index-BkKJZgfk.js";import"./proxy-D62Q3uN7.js";import"./autoprefixer-CLq4rudv.js";import"./pusher-Dk5bIoJZ.js";import"./trending-up-_LM6MF-k.js";import"./file-text-2oyp6bUV.js";import"./chart-column-Bqapy0n2.js";import"./InputLabel-DLivDGoa.js";import"./circle-plus-CgcoCmii.js";const Xs=({services_:g})=>{const[B,M]=i.useState(g),[te,Ve]=i.useState(""),[E,ce]=i.useState("all"),[O,S]=i.useState(!1),[x,Ue]=i.useState({key:"servicename",direction:"ascending"}),[Ke,We]=i.useState(!1);i.useEffect(()=>{M(g),console.log("services: ",g)},[g]);const[R,b]=i.useState(!1),[I,ne]=i.useState(null),[H,V]=i.useState(!1),[f,U]=i.useState({servicename:"",status:"Active"}),[le,$e]=i.useState({name:"",description:"",duration:30,price:0,recurrenceDates:[]});[...B.filter(a=>{const s=a.servicename.toLowerCase().includes(te.toLowerCase()),t=E==="all"||a.status===E;return s&&t})].sort((a,s)=>a[x.key]<s[x.key]?x.direction==="ascending"?-1:1:a[x.key]>s[x.key]?x.direction==="ascending"?1:-1:0);const[de,K]=i.useState(null),oe=a=>{H===a?(V(null),K(null)):(V(a),K(a))},me=a=>{L(s=>({...s,days:s.days.includes(a)?s.days.filter(t=>t!==a):[...s.days,a]}))},he=()=>{pe(route("admin.services.subservice.create"),{preserveScroll:!0,preserveState:!0,only:["services_"],onSuccess:()=>{b(!1),alert_toast("Success","Sub-Service added successfully!")}})},W=async(a,s)=>{var t,p;S(!0);try{const r=s?"/admin/services/unarchive":"/admin/services/archive",c=await Y.post(r,{service_id:a});c.data.services&&(M(c.data.services),alert_toast("Success",c.data.message))}catch(r){console.error("Error archiving/unarchiving service:",r),alert_toast("Error",((p=(t=r.response)==null?void 0:t.data)==null?void 0:p.message)||"An error occurred while updating the service")}finally{S(!1)}},xe=a=>{switch(a){case 1:return e.jsx(h,{className:"bg-green-500",children:"Active"});case 0:return e.jsx(h,{className:"bg-gray-500",children:"Inactive"});default:return e.jsx(h,{children:a})}},{data:$,setData:q,processing:ue,post:pe}=F({serviceid:"",subservicename:""}),[je,G]=i.useState(!1),{data:ve,setData:L,post:ge,processing:Se,errors:J}=F({days:le.recurrenceDates,serviceid:de}),be=()=>{ge(route("admin.services.days.update"),{preserveScroll:!0,preserveState:!0,replace:!0,only:["services_"],onSuccess:()=>{G(!1),alert_toast("Success!","Successfully Updated!","success")}})},fe=["09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","01:00 PM","01:30 PM","02:00 PM","02:30 PM","03:00 PM","03:30 PM","04:00 PM"],[ye,Ge]=i.useState([]),[Ne,we]=i.useState({}),[Ce,Q]=i.useState(!1),{data:y,setData:u,processing:De,post:Ae,errors:X}=F({times:ye,subservice_id:Ne,subservicename:""}),Te=a=>{u(s=>({...s,times:s.times.includes(a)?s.times.filter(t=>t!==a):[...s.times,a]}))},ke=a=>{Ae(route("admin.services.time.update"),{preserveScroll:!0,onSuccess:()=>{Q(!1),alert_toast("Success!","Successfully Updated!","success")}})},Me=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return i.useEffect(()=>{console.log("datatime; ",y)},[y]),e.jsxs(_e,{children:[e.jsxs("div",{className:" mb-5",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Services"}),e.jsx("p",{className:"text-gray-600",children:"These are the services to be used in the Appointment Schedules."}),e.jsx("p",{className:"text-muted-foreground"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx(Pe,{activeTab:"services"}),e.jsxs("div",{className:"bg-accent/20 rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-primary",children:"All Services"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(w,{open:R,onOpenChange:a=>{b(a),a||U({servicename:"",status:"Active"})},children:e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(A,{children:"Add New Service"}),e.jsx(T,{children:"Create a new service for appointments."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{htmlFor:"servicename",className:"text-right",children:"Service Name"}),e.jsx(P,{id:"servicename",name:"servicename",className:"col-span-3",value:f.servicename,onChange:a=>U({...f,servicename:a.target.value})})]})}),e.jsx(k,{children:e.jsx(l,{type:"submit",onClick:async()=>{var a,s;try{S(!0);const t=await Y.post("/admin/services/create",f);t.data.services&&(M(t.data.services),b(!1),alert_toast("Success","Service added successfully!"))}catch(t){console.error("Error creating service:",t),alert_toast("Error",((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||"An error occurred while creating the service")}finally{S(!1)}},disabled:!f.servicename||O,children:"Save Service"})})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Filter by:"})]}),e.jsxs(Ie,{value:E,onValueChange:ce,children:[e.jsx(He,{className:"w-[180px]",children:e.jsx(Le,{placeholder:"Status"})}),e.jsxs(Fe,{children:[e.jsx(_,{value:"all",children:"All Statuses"}),e.jsx(_,{value:"Active",children:"Active"}),e.jsx(_,{value:"Inactive",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsx(Oe,{data:B,defaultSort:{key:"servicename",direction:"asc"},children:({sortedData:a})=>e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(j,{children:[e.jsx(o,{}),e.jsx(o,{sortKey:"servicename",sortable:!0,children:"Service Name"}),e.jsx(o,{sortKey:"status",sortable:!0,children:"Status"}),e.jsx(o,{children:"Available Days"}),e.jsx(o,{sortKey:"servicename",sortable:!0,children:"Sub Services"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(re,{children:a.map((s,t)=>{var p;return e.jsxs(Ee.Fragment,{children:[e.jsxs(j,{children:[e.jsx(d,{children:e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>oe(s.id),children:H===s.id?e.jsx(Be,{className:"h-4 w-4"}):e.jsx(Re,{className:"h-4 w-4"})})}),e.jsx(d,{children:s.servicename}),e.jsx(d,{children:xe(s.status)}),e.jsx(d,{className:" grid gap-1",children:(p=s==null?void 0:s.servicedays)==null?void 0:p.map((r,c)=>e.jsx(h,{className:"bg-primary",children:r.day},c))}),e.jsx(d,{children:(s==null?void 0:s.subservices.length)<=0?e.jsx("div",{children:"No Sub Services"}):e.jsxs("div",{children:[s==null?void 0:s.subservices.length," Service",(s==null?void 0:s.subservices.length)>1?"s":""]})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[s.status===0?e.jsxs(l,{variant:"outline",size:"sm",className:"text-green-600 hover:text-green-700 hover:bg-green-50 flex items-center gap-1",onClick:()=>W(s.id,!0),disabled:O,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M12 12v7"}),e.jsx("path",{d:"M8 12l4-4 4 4"})]}),"Unarchive"]}):e.jsxs(l,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-1",onClick:()=>W(s.id,!1),disabled:O,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8v13H3V8"}),e.jsx("path",{d:"M1 3h22v5H1z"}),e.jsx("path",{d:"M12 19V12"}),e.jsx("path",{d:"M8 15l4 4 4-4"})]}),"Archive"]}),e.jsxs(w,{open:R,onOpenChange:r=>{b(r),r&&q("serviceid",s.id)},children:[e.jsx(z,{asChild:!0,children:e.jsx(l,{variant:"outline",size:"sm",children:"Add Sub-service"})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Add Sub-service to ",s.servicename]}),e.jsx(T,{children:"Create a new sub-service for this service category."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{htmlFor:"subName",className:"text-right",children:"Sub Service"}),e.jsx(P,{id:"subName",name:"name",value:$.subservicename,onChange:r=>{q("subservicename",r.target.value)},className:"col-span-3"})]})}),e.jsx(k,{children:e.jsx(l,{type:"submit",onClick:he,disabled:!$.subservicename||ue,children:"Save Sub-service"})})]})]}),e.jsxs(w,{open:je,onOpenChange:r=>{var c;G(r),r&&(L("days",((c=s==null?void 0:s.servicedays)==null?void 0:c.map(N=>N.day))||[]),L("serviceid",s.id))},children:[e.jsx(z,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{ne(s)},children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Edit Days to"," ",I==null?void 0:I.servicename]}),e.jsx(T,{children:"Edit days for this service category."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{className:"text-right",children:"Available Days"}),Me.map(r=>e.jsx(h,{className:`cursor-pointer ${ve.days.includes(r)?"bg-primary":"bg-muted text-red-500"}`,onClick:()=>me(r),children:r},r))]}),Object.keys(J).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("ul",{className:"text-sm text-red-600",children:Object.entries(J).map(([r,c])=>e.jsx("li",{children:c},r))})})]})})]}),e.jsx(k,{children:e.jsx(l,{onClick:r=>{be()},disabled:Se,children:"Save Days"})})]})]})]})})]}),H===s.id&&e.jsx(j,{children:e.jsx(d,{colSpan:6,className:"p-0",children:e.jsxs("div",{className:"bg-muted/20 p-4",children:[e.jsxs("h3",{className:"font-medium mb-2",children:["Sub-services for ",s.servicename]}),s.subservices.length>0?e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(j,{children:[e.jsx(o,{children:"Sub Service"}),e.jsx(o,{children:"Available Time"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsx(re,{children:s==null?void 0:s.subservices.map((r,c)=>{var N;return e.jsxs(j,{children:[e.jsx(d,{children:r.subservicename}),e.jsx(d,{children:(N=r==null?void 0:r.times)==null?void 0:N.map((n,m)=>e.jsx(h,{className:"cursor-pointer bg-primary",children:ae(n.time,"HH:mm:ss").format("hh:mm A")},m))}),e.jsx(d,{children:e.jsx("div",{children:e.jsxs(w,{open:Ce,onOpenChange:n=>{Q(n),n&&(console.log("selected: ",r.subservicename),u("subservice_id",r.id),we(r),u("subservicename",r.subservicename),u("times",r==null?void 0:r.times.map(m=>ae(m.time,"HH:mm:ss").format("hh:mm A"))))},children:[e.jsx(z,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsxs(A,{children:["Edit Time to"," ",s==null?void 0:s.name]}),e.jsx(T,{children:"Edit days for this sub service category"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx(v,{children:"Sub-Service:"}),e.jsx(P,{className:" w-full",value:y.subservicename,onChange:n=>{u("subservicename",n.target.value)}}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(v,{className:" text-right",children:"Available Time:"}),fe.map((n,m)=>e.jsx(h,{className:`cursor-pointer ${y.times.includes(n)?"bg-primary":"bg-muted text-red-500"}`,onClick:()=>Te(n),children:n},m))]})]}),e.jsxs(k,{children:[Object.keys(X).length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-5 w-5 text-red-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("ul",{className:"text-sm text-red-600",children:Object.entries(X).map(([n,m])=>e.jsx("li",{children:m},n))})})]})}),e.jsx(l,{onClick:ke,disabled:De,children:"Save Time"})]})]})]})})})]},c)})})]}):e.jsx("p",{className:"text-muted-foreground",children:"No sub-services found for this service."})]})})})]},t)})})]})})})]})]})]})};export{Xs as default};
