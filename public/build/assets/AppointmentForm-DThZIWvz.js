import{j as e,q as ee}from"./app-BAN4jDYq.js";import{r as l,R as ie}from"./vendor-C8lGyBmx.js";import{B as q}from"./button-D7s8i7zn.js";import{I as k}from"./input-Z5bDMjre.js";import{I as N}from"./InputError-DJ81PhNN.js";import{L as x}from"./label-DgiB2xp1.js";import{S as F,a as R,b as B,c as H,d as v}from"./select-B_Cs4ml6.js";import pe from"./CustomCalendar-pKW95yYk.js";import{h as W}from"./moment-C5S46NFB.js";import{t as te,P as xe}from"./PhilippinesAddressLookup-B3zF5xoe.js";import{C as ge}from"./clock-BTXNg5UP.js";import"./pusher-88Z950oj.js";import"./utils-Cj4zNyOk.js";import"./index-C5Y1Y0im.js";import"./index-BiOxaqwW.js";import"./Combination-BBw2K79e.js";import"./index-ClaTe4UG.js";import"./index-CpYaqqOj.js";import"./index-CsgXCiuK.js";import"./chevron-left-Cs27DwGq.js";import"./createLucideIcon-CxhiR5tx.js";import"./chevron-right-yKj4-WN0.js";import"./isBefore-COsor6RJ.js";import"./format-Dp3w_Y3x.js";import"./circle-check-big-DhFJ8pYG.js";import"./circle-alert-D5A-RZmA.js";import"./circle-x-Ciat7cPK.js";import"./isSameMonth-BOwz-_mK.js";import"./subMonths-B67T7BWk.js";const fe=({isOpen:_,onClose:n,onConfirm:m,title:h="Confirmation",message:A="Are you sure you want to confirm this appointment?",confirmText:u="Confirm",cancelText:L="Cancel"})=>_?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm",onClick:n}),e.jsx("div",{className:"relative min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md mx-auto border border-gray-100",children:[e.jsx("div",{className:"flex items-center justify-center p-6 border-b border-gray-100",children:e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 19.5c-.77.833.192 2.5 1.732 2.5z"})})})}),e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:h}),e.jsx("p",{className:"text-gray-600 mb-8",children:A}),e.jsxs("div",{className:"flex space-x-4 justify-center",children:[e.jsxs("button",{onClick:n,className:"px-6 py-3 text-sm font-semibold text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:L})]}),e.jsxs("button",{onClick:m,className:"px-6 py-3 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl flex items-center space-x-2 transform hover:scale-105",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:u})]})]})]})]})})]}):null,ve=({isOpen:_,onClose:n,onVerified:m,appointmentData:h,verificationMethod:A})=>{const[u,L]=l.useState(""),[a,O]=l.useState(!1),[T,I]=l.useState(!1),[f,c]=l.useState(""),[j,M]=l.useState(300),[P,y]=l.useState(!1),[E,w]=l.useState("");l.useEffect(()=>{if(P&&j>0){const d=setTimeout(()=>M(j-1),1e3);return()=>clearTimeout(d)}},[P,j]),l.useEffect(()=>{_&&!P&&z()},[_]);const z=async()=>{const d=Math.floor(1e5+Math.random()*9e5).toString();localStorage.setItem("temp_verification_code",d),localStorage.setItem("temp_verification_expiry",(Date.now()+3e5).toString()),console.log("Generated verification code:",d);try{console.log(`Verification code for ${A}: ${d}`),w(d),y(!0),M(300),c("")}catch(b){console.error("Error generating verification code:",b),c("Failed to generate verification code. Please try again.")}},S=async()=>{if(!u.trim()){c("Please enter the verification code");return}O(!0),c("");try{const d=localStorage.getItem("temp_verification_code"),b=localStorage.getItem("temp_verification_expiry");if(!d||!b){c("No verification code found. Please request a new one.");return}if(Date.now()>parseInt(b)){c("Verification code has expired. Please request a new one."),localStorage.removeItem("temp_verification_code"),localStorage.removeItem("temp_verification_expiry");return}u===d?(localStorage.removeItem("temp_verification_code"),localStorage.removeItem("temp_verification_expiry"),m()):c("Invalid verification code. Please try again.")}catch(d){console.error("Error verifying code:",d),c("Failed to verify code. Please try again.")}finally{O(!1)}},$=async()=>{I(!0),c(""),await z(),I(!1)},X=d=>{const b=Math.floor(d/60),Y=d%60;return`${b}:${Y.toString().padStart(2,"0")}`};return _?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:n}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-8 py-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Verify Your Appointment"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Please verify your appointment using the code below"})]})]}),e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full p-2 transition-all duration-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"px-8 py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Appointment Details"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",h.date?new Date(h.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Time:"})," ",h.time||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Service:"})," ",h.servicename||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Patient:"})," ",h.firstname," ",h.lastname]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter Verification Code"}),e.jsx("input",{type:"text",value:u,onChange:d=>L(d.target.value),placeholder:"Enter 6-digit code",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-lg tracking-widest",maxLength:6}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the verification code shown below"}),E&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Your Verification Code:"}),e.jsx("p",{className:"text-lg font-mono text-blue-900",children:E}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Enter this code to verify your appointment"})]})]}),P&&e.jsx("div",{className:"text-center",children:j>0?e.jsxs("p",{className:"text-sm text-gray-600",children:["Code expires in ",e.jsx("span",{className:"font-semibold text-orange-600",children:X(j)})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-red-600",children:"Verification code has expired"}),e.jsx(q,{onClick:$,disabled:T,variant:"outline",size:"sm",className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:T?"Sending...":"Resend Code"})]})}),f&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg flex items-start space-x-3",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"font-medium",children:f})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-8 py-4 flex justify-end space-x-3",children:[e.jsx(q,{onClick:n,variant:"outline",className:"px-6 py-2",children:"Cancel"}),e.jsx(q,{onClick:S,disabled:!u.trim()||a||j===0,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):"Verify Appointment"})]})]})]})}):null},Ke=({onSubmit:_=()=>{},formData:n,setFormData:m,errors:h,processing:A,services:u=[],setIsSubmitted:L})=>{if(console.log("AppointmentForm received formData:",n),console.log("formData type:",typeof n),console.log("formData is object:",typeof n=="object"&&n!==null),console.log("formData keys:",n&&typeof n=="object"?Object.keys(n):"not an object"),typeof n!="object"||n===null)return console.error("formData is not a valid object:",n),e.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Form Error"}),e.jsx("p",{className:"text-red-700",children:"There was an error loading the form data. Please refresh the page."})]});const a=ee().props.auth.user,[O,T]=l.useState(!1),[I,f]=l.useState(""),[c,j]=l.useState(!1),[M,P]=l.useState(!1),[y,E]=l.useState(!1),[w,z]=l.useState(null),[S,$]=l.useState(!1),[X,d]=l.useState(!1),[b,Y]=l.useState(null),[ne,se]=l.useState("email");l.useEffect(()=>{const i=new URLSearchParams(window.location.search).get("mode"),r=localStorage.getItem("rescheduleAppointmentData"),o=localStorage.getItem("existingPatientData"),p=localStorage.getItem("selectedPatientType");if(console.log("AppointmentForm useEffect - Mode Detection:",{mode:i,rescheduleAppointmentData:!!r,existingPatientData:!!o,patientType:p,isRescheduleMode:y,isExistingPatientMode:S}),i==="reschedule"&&r)try{const s=JSON.parse(r);E(!0),z(s),m(C=>({...typeof C=="object"&&C!==null?C:{},firstname:s.firstname||"",middlename:s.middlename||"",lastname:s.lastname||"",email:s.email||"",phone:s.phone||"",gender:s.gender||"",birth:s.date_of_birth||"",civil_status:s.civil_status||"",nationality:s.nationality||"",religion:s.religion||"",country:s.country||"",region:s.region||"",province:s.province||"",city:s.city||"",barangay:s.barangay||"",street:s.street||"",zip_code:s.zip_code||"",profile_picture:s.profile_picture||"",region_id:s.region_id||null,province_id:s.province_id||null,city_id:s.city_id||null,barangay_id:s.barangay_id||null,service:"",servicename:s.last_service||"",subservice:"",subservicename:s.last_subservice||""}))}catch(s){console.error("Error parsing reschedule data:",s)}else if(o&&p==="existing")try{const s=JSON.parse(o);$(!0),m(C=>({...typeof C=="object"&&C!==null?C:{},firstname:s.firstname||"",middlename:s.middlename||"",lastname:s.lastname||"",email:s.email||"",phone:s.phone||"",gender:s.gender||"",birth:s.date_of_birth||"",civil_status:s.civil_status||"",nationality:s.nationality||"",religion:s.religion||"",country:s.country||"",region:s.region||"",province:s.province||"",city:s.city||"",barangay:s.barangay||"",street:s.street||"",zip_code:s.zip_code||"",profile_picture:s.profile_picture||"",region_id:s.region_id||null,province_id:s.province_id||null,city_id:s.city_id||null,barangay_id:s.barangay_id||null,service:"",servicename:"",subservice:"",subservicename:""}))}catch(s){console.error("Error parsing existing patient data:",s)}else E(!1),$(!1),z(null)},[]),l.useEffect(()=>{if(y&&w&&u&&u.length>0){const t=u.find(i=>i.servicename===w.last_service);t&&(m(i=>({...typeof i=="object"&&i!==null?i:{},service:t.id,servicename:t.servicename})),fetch(`/services/get-sub-services/${t.id}`).then(i=>i.json()).then(i=>{Z(i);const r=i.find(o=>o.subservicename===w.last_subservice);if(r&&(m(o=>({...typeof o=="object"&&o!==null?o:{},subservice:r.id,subservicename:r.subservicename})),Q(r.times),w.last_time)){const o=r.times.find(p=>W(p.time,"HH:mm:ss").format("hh:mm A")===w.last_time);o&&m(p=>({...typeof p=="object"&&p!==null?p:{},timeid:o.id,time:W(o.time,"HH:mm:ss").format("hh:mm A")}))}}).catch(i=>{console.error("Error fetching sub-services:",i)}))}},[y,w,u]),l.useEffect(()=>()=>{},[]),l.useEffect(()=>{a&&!n.firstname&&!y&&!S&&(m({...typeof n=="object"&&n!==null?n:{},firstname:a.firstname,middlename:a.middlename??"",lastname:a.lastname,email:a.email,phone:a.contactno??"",servicename:"",service:"",gender:a.gender,birth:a.birth,priorityNumber:"",date_of_birth:a.birth||"",civil_status:a.civil_status||"",nationality:a.nationality||"",religion:a.religion||"",country:a.country||"",region:a.region||"",province:a.province||"",city:a.city||"",barangay:a.barangay||"",street:a.street||"",zip_code:a.zip_code||"",profile_picture:a.profile_picture||"",region_id:a.region_id||null,province_id:a.province_id||null,city_id:a.city_id||null,barangay_id:a.barangay_id||null}),j(!0))},[a]),l.useEffect(()=>{if(!a)if(te.hasValidTokenSession()){const t=te.getPatientData();t&&(m({...typeof n=="object"&&n!==null?n:{},firstname:t.firstname||"",middlename:t.middlename||"",lastname:t.lastname||"",email:t.email||"",phone:t.phone||"",gender:t.sex||"",birth:t.birthdate||"",servicename:"",service:"",priorityNumber:"",date_of_birth:t.birthdate||"",civil_status:t.civilStatus||"",nationality:t.nationality||"",religion:t.religion||"",country:t.country||"",region:t.region||"",province:t.province||"",city:t.city||"",barangay:t.barangay||"",street:t.street||"",zip_code:t.zipCode||"",profile_picture:t.profileImage||"",region_id:t.region_id||null,province_id:t.province_id||null,city_id:t.city_id||null,barangay_id:t.barangay_id||null}),j(!0))}else{const t=localStorage.getItem("patientVerificationData");if(t)try{const i=JSON.parse(t);m({...typeof n=="object"&&n!==null?n:{},firstname:i.firstname||"",middlename:i.middlename||"",lastname:i.lastname||"",email:i.email||"",phone:i.phone||"",gender:i.sex||"",birth:i.birthdate||"",servicename:"",service:"",priorityNumber:"",date_of_birth:i.birthdate||"",civil_status:i.civilStatus||"",nationality:i.nationality||"",religion:i.religion||"",country:i.country||"",region:i.region||"",province:i.province||"",city:i.city||"",barangay:i.barangay||"",street:i.street||"",zip_code:i.zipCode||"",profile_picture:i.profileImage||"",region_id:i.region_id||null,province_id:i.province_id||null,city_id:i.city_id||null,barangay_id:i.barangay_id||null}),localStorage.removeItem("patientVerificationData")}catch{}}},[]);const G=ie.useMemo(()=>!Array.isArray(u)||u.length===0?(console.warn("Services is not a valid array:",u),{}):u.reduce((t,i)=>(i&&i.id&&(t[i.id]=i),t),{}),[u]),[be,je]=l.useState(new Date),re=()=>{T(!1),_(n)},oe=t=>{m(i=>({...typeof i=="object"&&i!==null?i:{},date:t}))},J=t=>{const{name:i,value:r}=t.target;if(i==="phone"){const o=r.replace(/[^0-9+]/g,"");m(p=>({...typeof p=="object"&&p!==null?p:{},[i]:o}))}else m(o=>({...typeof o=="object"&&o!==null?o:{},[i]:r}))},g=(t,i)=>{m(r=>({...typeof r=="object"&&r!==null?r:{},[t]:i??null}))},K=(t,i)=>{m(r=>({...typeof r=="object"&&r!==null?r:{},[t]:i}))},[V,Z]=l.useState([]),[ae,Q]=l.useState([]),D=ie.useMemo(()=>!Array.isArray(V)||V.length===0?{}:V.reduce((t,i)=>(i&&i.id&&(t[i.id]=i),t),{}),[V]),[le,ce]=l.useState([]);l.useEffect(()=>{const t=G[n.service];ce(t?.servicedays?.map(i=>i.day))},[n,G]);const U=()=>y&&!S,de=()=>!1,me=async t=>{const i=t.email&&t.email.trim()!=="",r=t.phone&&t.phone.trim()!=="";if(!i&&!r){f("Please provide either email or phone number for verification"),window.scrollTo({top:0,behavior:"smooth"});return}se(i?"email":"sms"),Y({...t,id:null}),d(!0)},he=async()=>{console.log("Verification successful! Creating appointment..."),console.log("Pending appointment data:",b),d(!1);try{console.log("Sending appointment creation request...");const t=await fetch(route("patient.appoint.create"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(b)});console.log("Response status:",t.status);const i=await t.json();if(console.log("Appointment creation result after verification:",i),console.log("Priority number from result:",i.priority_number),console.log("Priority number from appointment_data:",i.appointment_data?.priority_number),i.success){console.log("Appointment created successfully! Showing confirmation..."),console.log("Current formData before update:",n),console.log("Result appointment_data:",i.appointment_data),L&&L(!0);const r={...n,...i.appointment_data,id:i.appointment_data.id,priorityNumber:i.appointment_data?.priority_number||i.priority_number||n.priorityNumber||"TEST123",referenceNumber:i.appointment_data.reference_number||i.reference_number||n.referenceNumber,firstname:i.appointment_data?.firstname||n.firstname||"",lastname:i.appointment_data?.lastname||n.lastname||"",middlename:i.appointment_data?.middlename||n.middlename||"",email:i.appointment_data?.email||n.email||"",phone:i.appointment_data?.phone||n.phone||"",gender:i.appointment_data?.gender||n.gender||"",date_of_birth:i.appointment_data?.date_of_birth||n.date_of_birth||"",birth:i.appointment_data?.date_of_birth||n.birth||n.date_of_birth||"",servicename:i.appointment_data?.service_name||n.servicename||"",subservicename:i.appointment_data?.subservice_name||n.subservicename||"",date:i.appointment_data?.date||n.date||"",time:i.appointment_data?.time||n.time||"",notes:i.appointment_data?.notes||n.notes||""};console.log("Setting form data with priority number:",r.priorityNumber),console.log("Setting form data with patient data:",{firstname:r.firstname,lastname:r.lastname,email:r.email,phone:r.phone}),console.log("Full new form data:",r),localStorage.setItem("confirmed_appointment_data",JSON.stringify(r)),console.log("Stored appointment data in localStorage:",r),m(r);const o=new URL(window.location);o.searchParams.set("confirmed","true"),window.history.replaceState({},"",o),window.scrollTo({top:0,behavior:"smooth"})}else console.error("Appointment creation failed:",i),f(i.message||"Failed to create appointment after verification"),window.scrollTo({top:0,behavior:"smooth"})}catch(t){console.error("Error creating appointment after verification:",t),f("An error occurred while creating the appointment. Please try again."),window.scrollTo({top:0,behavior:"smooth"})}},ue=()=>{d(!1),Y(null)};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:t=>t.preventDefault(),className:"space-y-6 bg-white p-6 rounded-lg shadow-sm",children:[y&&!S&&e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-900",children:"Reschedule Appointment"}),e.jsx("p",{className:"text-sm text-orange-700",children:"You are rescheduling your appointment. Service type and sub-service are locked, but you can change the date and time."})]})]})}),I&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg flex items-start space-x-3",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"font-medium text-sm",children:I})}),e.jsx("button",{onClick:()=>f(""),className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),c&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-lg flex items-start space-x-3",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:a?"Personal information is locked for authenticated users":"Personal information is locked after verification"}),e.jsx("p",{className:"text-xs mt-1",children:a?"Your account information cannot be modified here":"This information was verified and cannot be changed"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"name",children:"First Name"}),e.jsx(k,{id:"firstname",name:"firstname",value:n.firstname,placeholder:"Your First Name",disabled:c,required:!0}),e.jsx(N,{message:h.firstname})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"middlename",children:"Middle Name"}),e.jsx(k,{id:"middlename",name:"middlename",value:n.middlename,placeholder:"N/A",disabled:c,required:!0}),e.jsx(N,{message:h.middlename})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"lastname",children:"Last Name"}),e.jsx(k,{id:"lastname",name:"lastname",value:n.lastname,placeholder:"Your Last Name",disabled:c,required:!0}),e.jsx(N,{message:h.lastname})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"email",children:"Email Address (Optional)"}),e.jsx(k,{id:"email",name:"email",type:"email",value:n.email,placeholder:"juan@example.com",disabled:c}),e.jsx(N,{message:h.email})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"phone",children:"Phone Number (Optional)"}),e.jsx(k,{id:"phone",name:"phone",type:"tel",value:n.phone,onChange:J,placeholder:"+63 912 345 6789",disabled:c}),e.jsx(N,{message:h.phone})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Additional Patient Information (Optional)"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This information will be automatically stored in your Patient Record for future appointments"})]}),e.jsx("button",{type:"button",onClick:()=>P(!M),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:M?"Hide Details":"Show Details"})]}),M&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"date_of_birth",children:"Date of Birth"}),e.jsx(k,{id:"date_of_birth",name:"date_of_birth",type:"date",value:n.date_of_birth,onChange:J,disabled:c})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"gender",children:"Gender"}),e.jsxs(F,{value:n.gender,onValueChange:t=>K("gender",t),disabled:c,children:[e.jsx(R,{children:e.jsx(B,{placeholder:"Select gender"})}),e.jsxs(H,{children:[e.jsx(v,{value:"Male",children:"Male"}),e.jsx(v,{value:"Female",children:"Female"}),e.jsx(v,{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"civil_status",children:"Civil Status"}),e.jsxs(F,{value:n.civil_status,onValueChange:t=>K("civil_status",t),disabled:c,children:[e.jsx(R,{children:e.jsx(B,{placeholder:"Select status"})}),e.jsxs(H,{children:[e.jsx(v,{value:"Single",children:"Single"}),e.jsx(v,{value:"Married",children:"Married"}),e.jsx(v,{value:"Widowed",children:"Widowed"}),e.jsx(v,{value:"Divorced",children:"Divorced"}),e.jsx(v,{value:"Separated",children:"Separated"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"nationality",children:"Nationality"}),e.jsx(k,{id:"nationality",name:"nationality",value:n.nationality,onChange:J,placeholder:"e.g., Filipino",disabled:c})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"religion",children:"Religion"}),e.jsx(k,{id:"religion",name:"religion",value:n.religion,onChange:J,placeholder:"e.g., Catholic",disabled:c})]})]}),e.jsx(xe,{formData:n,setFormData:m,isDisabled:c,showStreet:!0,showZipCode:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{children:"Service Type"}),e.jsxs(F,{value:n.service?.toString(),onValueChange:t=>{if(U())return;const i=G[t];i&&(g("service",i.id),g("servicename",i.servicename),g("date",null),g("subservice",""),g("subservicename",""),g("timeid",""),g("time","")),fetch(`/services/get-sub-services/${t}`).then(r=>r.json()).then(r=>{Z(r)})},disabled:U(),children:[e.jsx(R,{className:"w-full",children:e.jsx(B,{placeholder:"Select service",children:n.service?(u||[]).find(t=>t.id.toString()===n.service.toString())?.servicename:"Select service"})}),e.jsx(H,{children:(u||[]).map(t=>e.jsx(v,{value:t.id,children:t.servicename},t.id))})]}),e.jsx(N,{message:h.service})]}),e.jsxs("div",{children:[e.jsx(x,{children:"Service Sub Type"}),e.jsxs(F,{value:n.subservice?.toString(),onValueChange:t=>{if(U())return;const i=D[t];Q(i?.times),g("subservice",i.id??null),g("subservicename",i.subservicename??null),g("timeid",""),g("time","")},disabled:U(),children:[e.jsx(R,{className:"w-full",children:e.jsx(B,{placeholder:"Select Sub Service",children:n.subservice?V.find(t=>t.id.toString()===n.subservice.toString())?.subservicename:"Select Sub-Service"})}),e.jsx(H,{children:V?.map((t,i)=>e.jsx(v,{value:t.id,children:t.subservicename},i))})]}),e.jsx(N,{message:h.subservice})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{children:"Appointment Date"}),e.jsx(pe,{selectedDate:n.date,onDateSelect:oe,hasPrograms:le,serviceId:n.service,subserviceId:n.subservice}),e.jsx(N,{message:h.date})]}),e.jsxs("div",{children:[e.jsx(x,{children:"Appointment Time"}),e.jsxs(F,{value:n.timeid,onValueChange:t=>{const i=D[n.subservice];g("timeid",t??null),g("time",W(i?.times?.find(r=>r.id==t)?.time,"HH:mm:ss").format("hh:mm A")??null)},disabled:de(),children:[e.jsx(R,{className:"w-full",children:e.jsx(B,{placeholder:"Select time",children:n.timeid?e.jsxs("div",{className:"flex items-center",children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),W(n.time,"HH:mm:ss").format("h:mm A")]}):"Select time"})}),e.jsx(H,{children:ae.map((t,i)=>e.jsx(v,{value:t.id,children:W(t.time,"HH:mm:ss").format("h:mm A")},t.id))})]}),e.jsx(N,{message:h.time})]})]})]}),e.jsx("div",{className:"space-y-4",children:ee().props.auth.user?e.jsx(q,{onClick:t=>{t.preventDefault(),t.stopPropagation();const r=["firstname","lastname","service","date","time"].filter(o=>!n[o]||n[o].toString().trim()==="");if(r.length>0){const o={firstname:"First Name",lastname:"Last Name",service:"Service Type",date:"Appointment Date",time:"Appointment Time"},p=r.map(s=>o[s]||s);f(`Please fill in the following required fields: ${p.join(", ")}`),window.scrollTo({top:0,behavior:"smooth"});return}f(""),_(n)},disabled:A,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:A?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("svg",{className:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"Processing..."})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{children:y&&!S?"Reschedule Appointment":S?"Book New Appointment":"Schedule Appointment"})]})}):e.jsx("div",{className:"text-center space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Book Your Appointment?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Complete your patient verification to access appointment booking and manage your health records."}),e.jsx(q,{onClick:t=>{t.preventDefault(),t.stopPropagation();const r=["firstname","lastname","service","date","time"].filter(o=>!n[o]||n[o].toString().trim()==="");if(r.length>0){const o={firstname:"First Name",lastname:"Last Name",service:"Service Type",date:"Appointment Date",time:"Appointment Time"},p=r.map(s=>o[s]||s);f(`Please fill in the following required fields: ${p.join(", ")}`),window.scrollTo({top:0,behavior:"smooth"});return}f(""),me(n)},className:"w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Appoint Now!"})]})})]})})})]}),e.jsx(fe,{isOpen:O,onClose:()=>T(!1),onConfirm:re,title:"Confirmation",message:"Are you sure you want to confirm this appointment?",confirmText:"Confirm",cancelText:"Cancel"}),e.jsx(ve,{isOpen:X,onClose:ue,onVerified:he,appointmentData:b,verificationMethod:ne})]})};export{Ke as default};
